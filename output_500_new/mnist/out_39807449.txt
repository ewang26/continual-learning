Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 16, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2403.275, val loss: 154.060, train acc: 0.966, val acc: 0.979
diff inf
epoch 2 train loss: 827.157, val loss: 108.095, train acc: 0.987, val acc: 0.987
diff 45.96538796089992
epoch 3 train loss: 472.804, val loss: 106.825, train acc: 0.993, val acc: 0.988
diff 1.269792898467216
epoch 4 train loss: 330.134, val loss: 119.584, train acc: 0.995, val acc: 0.990
diff 12.759281767329938
epoch 5 train loss: 322.114, val loss: 192.439, train acc: 0.995, val acc: 0.987
diff 72.85436783561522
epoch 6 train loss: 225.396, val loss: 176.934, train acc: 0.997, val acc: 0.992
diff 15.504472106375204
epoch 7 train loss: 178.852, val loss: 179.485, train acc: 0.998, val acc: 0.990
diff 2.5509748826951295
epoch 8 train loss: 193.018, val loss: 218.197, train acc: 0.998, val acc: 0.990
diff 38.71229165277458
epoch 9 train loss: 279.679, val loss: 159.891, train acc: 0.997, val acc: 0.988
diff 58.3059980653112
epoch 10 train loss: 130.940, val loss: 261.116, train acc: 0.998, val acc: 0.984
diff 101.22410689378131
epoch 11 train loss: 178.298, val loss: 310.096, train acc: 0.998, val acc: 0.989
diff 48.980317626489864
epoch 12 train loss: 198.865, val loss: 237.030, train acc: 0.998, val acc: 0.989
diff 73.06536390398335
epoch 13 train loss: 180.534, val loss: 225.075, train acc: 0.998, val acc: 0.988
diff 11.955280819368397
epoch 14 train loss: 188.939, val loss: 162.381, train acc: 0.998, val acc: 0.991
diff 62.69388044458765
epoch 15 train loss: 30.302, val loss: 343.302, train acc: 0.999, val acc: 0.988
diff 180.9211317461833
epoch 16 train loss: 156.766, val loss: 231.982, train acc: 0.999, val acc: 0.990
diff 111.32063464534647
epoch 17 train loss: 195.500, val loss: 297.244, train acc: 0.999, val acc: 0.988
diff 65.26257866572993
epoch 18 train loss: 220.866, val loss: 274.268, train acc: 0.998, val acc: 0.991
diff 22.97643785612655
epoch 19 train loss: 26.373, val loss: 351.382, train acc: 1.000, val acc: 0.991
diff 77.11425166937829
epoch 20 train loss: 177.530, val loss: 433.271, train acc: 0.999, val acc: 0.988
diff 81.8887634138693
epoch 21 train loss: 228.485, val loss: 392.010, train acc: 0.998, val acc: 0.991
diff 41.260946912311965
epoch 22 train loss: 69.204, val loss: 674.542, train acc: 0.999, val acc: 0.987
diff 282.53162868579454
epoch 23 train loss: 223.304, val loss: 284.791, train acc: 0.998, val acc: 0.991
diff 389.75016441912476
epoch 24 train loss: 183.738, val loss: 662.807, train acc: 0.999, val acc: 0.987
diff 378.01540364576135
epoch 25 train loss: 283.078, val loss: 437.210, train acc: 0.999, val acc: 0.990
diff 225.59678927886364
epoch 26 train loss: 98.753, val loss: 562.100, train acc: 0.999, val acc: 0.989
diff 124.89001137068533
epoch 27 train loss: 337.610, val loss: 636.351, train acc: 0.998, val acc: 0.989
diff 74.25079513747517
epoch 28 train loss: 147.728, val loss: 642.139, train acc: 0.999, val acc: 0.989
diff 5.7884920750219635
epoch 29 train loss: 174.129, val loss: 855.894, train acc: 0.999, val acc: 0.987
diff 213.75475509930345
epoch 30 train loss: 256.773, val loss: 665.065, train acc: 0.999, val acc: 0.989
diff 190.8288482054536
Training model M2
epoch 1 train loss: 3975.262, val loss: 201.876, train acc: 0.954, val acc: 0.985
diff inf
epoch 2 train loss: 1369.233, val loss: 237.853, train acc: 0.984, val acc: 0.976
diff 35.97761868989869
epoch 3 train loss: 814.601, val loss: 208.901, train acc: 0.990, val acc: 0.982
diff 28.952291504013033
epoch 4 train loss: 539.258, val loss: 215.951, train acc: 0.994, val acc: 0.986
diff 7.049939648245214
epoch 5 train loss: 499.236, val loss: 148.251, train acc: 0.995, val acc: 0.989
diff 67.69987422209255
epoch 6 train loss: 401.509, val loss: 193.151, train acc: 0.996, val acc: 0.986
diff 44.900201000874915
epoch 7 train loss: 325.092, val loss: 190.422, train acc: 0.997, val acc: 0.986
diff 2.7288781662834936
epoch 8 train loss: 318.109, val loss: 376.583, train acc: 0.997, val acc: 0.983
diff 186.16027432331288
epoch 9 train loss: 330.202, val loss: 284.039, train acc: 0.997, val acc: 0.986
diff 92.54325203737608
epoch 10 train loss: 253.698, val loss: 336.635, train acc: 0.998, val acc: 0.986
diff 52.59553881998875
epoch 11 train loss: 320.321, val loss: 287.076, train acc: 0.998, val acc: 0.987
diff 49.55903339225222
epoch 12 train loss: 289.094, val loss: 367.114, train acc: 0.997, val acc: 0.986
diff 80.03835458516016
epoch 13 train loss: 195.731, val loss: 475.281, train acc: 0.998, val acc: 0.986
diff 108.16686105465493
epoch 14 train loss: 476.892, val loss: 461.716, train acc: 0.996, val acc: 0.988
diff 13.564881220979032
epoch 15 train loss: 248.053, val loss: 582.301, train acc: 0.999, val acc: 0.980
diff 120.58478268048503
epoch 16 train loss: 322.970, val loss: 531.722, train acc: 0.998, val acc: 0.985
diff 50.57953451881997
epoch 17 train loss: 254.738, val loss: 408.781, train acc: 0.998, val acc: 0.986
diff 122.94007712531953
epoch 18 train loss: 284.000, val loss: 486.014, train acc: 0.998, val acc: 0.986
diff 77.23252432587753
epoch 19 train loss: 352.643, val loss: 629.023, train acc: 0.997, val acc: 0.985
diff 143.0094440268462
epoch 20 train loss: 387.232, val loss: 500.439, train acc: 0.998, val acc: 0.988
diff 128.5840681749762
epoch 21 train loss: 117.839, val loss: 496.662, train acc: 0.999, val acc: 0.989
diff 3.777117487881469
epoch 22 train loss: 329.724, val loss: 553.142, train acc: 0.998, val acc: 0.987
diff 56.47980757415769
epoch 23 train loss: 171.698, val loss: 776.810, train acc: 0.999, val acc: 0.984
diff 223.66810094913058
epoch 24 train loss: 235.925, val loss: 702.802, train acc: 0.999, val acc: 0.986
diff 74.00775983306721
epoch 25 train loss: 235.872, val loss: 661.911, train acc: 0.999, val acc: 0.985
diff 40.89189737037657
epoch 26 train loss: 262.827, val loss: 550.893, train acc: 0.999, val acc: 0.988
diff 111.01765929951239
epoch 27 train loss: 267.999, val loss: 733.170, train acc: 0.999, val acc: 0.987
diff 182.2766544078795
epoch 28 train loss: 212.395, val loss: 822.208, train acc: 0.999, val acc: 0.987
diff 89.03840868675945
epoch 29 train loss: 278.732, val loss: 894.161, train acc: 0.999, val acc: 0.990
diff 71.95267321477047
epoch 30 train loss: 385.805, val loss: 872.661, train acc: 0.999, val acc: 0.989
diff 21.499344572206383
Training model M3
epoch 1 train loss: 1910.021, val loss: 444.288, train acc: 0.925, val acc: 0.955
diff inf
epoch 2 train loss: 547.484, val loss: 518.454, train acc: 0.978, val acc: 0.953
diff 74.1659092910943
epoch 3 train loss: 263.092, val loss: 435.188, train acc: 0.988, val acc: 0.960
diff 83.266216992431
epoch 4 train loss: 149.497, val loss: 352.678, train acc: 0.994, val acc: 0.975
diff 82.50929894982124
epoch 5 train loss: 185.224, val loss: 557.727, train acc: 0.991, val acc: 0.959
diff 205.0487025474465
epoch 6 train loss: 122.993, val loss: 702.521, train acc: 0.994, val acc: 0.958
diff 144.79422061594312
epoch 7 train loss: 154.743, val loss: 647.740, train acc: 0.993, val acc: 0.961
diff 54.78126190150681
epoch 8 train loss: 48.604, val loss: 498.935, train acc: 0.998, val acc: 0.970
diff 148.80459924069487
epoch 9 train loss: 59.199, val loss: 716.276, train acc: 0.997, val acc: 0.965
diff 217.34055399512715
epoch 10 train loss: 160.908, val loss: 788.489, train acc: 0.994, val acc: 0.958
diff 72.21304659155373
epoch 11 train loss: 84.632, val loss: 638.885, train acc: 0.997, val acc: 0.963
diff 149.60450502826097
epoch 12 train loss: 25.326, val loss: 626.843, train acc: 0.999, val acc: 0.967
diff 12.041702630323925
epoch 13 train loss: 0.357, val loss: 579.052, train acc: 1.000, val acc: 0.971
diff 47.7911971817407
epoch 14 train loss: 0.076, val loss: 579.684, train acc: 1.000, val acc: 0.971
diff 0.6321806066403042
epoch 15 train loss: 0.051, val loss: 581.670, train acc: 1.000, val acc: 0.972
diff 1.9859294303964816
epoch 16 train loss: 0.036, val loss: 585.338, train acc: 1.000, val acc: 0.973
diff 3.668580579885088
epoch 17 train loss: 0.026, val loss: 589.714, train acc: 1.000, val acc: 0.973
diff 4.375295003556062
epoch 18 train loss: 0.018, val loss: 596.038, train acc: 1.000, val acc: 0.972
diff 6.324369427563852
epoch 19 train loss: 0.012, val loss: 603.234, train acc: 1.000, val acc: 0.972
diff 7.196020105576622
epoch 20 train loss: 0.009, val loss: 610.600, train acc: 1.000, val acc: 0.972
diff 7.365714315356854
epoch 21 train loss: 0.006, val loss: 619.854, train acc: 1.000, val acc: 0.972
diff 9.254676848350755
epoch 22 train loss: 0.004, val loss: 628.970, train acc: 1.000, val acc: 0.973
diff 9.115431062406628
epoch 23 train loss: 0.003, val loss: 641.271, train acc: 1.000, val acc: 0.973
diff 12.301575629125182
epoch 24 train loss: 0.002, val loss: 652.807, train acc: 1.000, val acc: 0.973
diff 11.535445477759367
epoch 25 train loss: 0.001, val loss: 662.707, train acc: 1.000, val acc: 0.973
diff 9.900496049692947
epoch 26 train loss: 0.001, val loss: 675.245, train acc: 1.000, val acc: 0.972
diff 12.537433437949062
epoch 27 train loss: 0.001, val loss: 686.390, train acc: 1.000, val acc: 0.972
diff 11.14502044998892
epoch 28 train loss: 0.000, val loss: 697.459, train acc: 1.000, val acc: 0.972
diff 11.068816216947084
epoch 29 train loss: 0.000, val loss: 711.557, train acc: 1.000, val acc: 0.972
diff 14.098433733835463
epoch 30 train loss: 0.000, val loss: 724.498, train acc: 1.000, val acc: 0.972
diff 12.941175566521338
Training model M3
epoch 1 train loss: 150.788, val loss: 2213.587, train acc: 0.997, val acc: 0.937
diff inf
epoch 2 train loss: 87.484, val loss: 2498.774, train acc: 0.999, val acc: 0.932
diff 285.18701221013
epoch 3 train loss: 0.388, val loss: 1884.120, train acc: 1.000, val acc: 0.945
diff 614.6542605754842
epoch 4 train loss: 0.017, val loss: 1880.586, train acc: 1.000, val acc: 0.945
diff 3.5342566530346176
epoch 5 train loss: 0.001, val loss: 1881.427, train acc: 1.000, val acc: 0.945
diff 0.8418556163160247
epoch 6 train loss: 0.001, val loss: 1880.364, train acc: 1.000, val acc: 0.945
diff 1.0632555630209026
epoch 7 train loss: 0.001, val loss: 1879.149, train acc: 1.000, val acc: 0.945
diff 1.214958431107334
epoch 8 train loss: 0.000, val loss: 1877.505, train acc: 1.000, val acc: 0.945
diff 1.6439394437577448
epoch 9 train loss: 0.000, val loss: 1877.555, train acc: 1.000, val acc: 0.945
diff 0.04989271634190118
Training model M3
epoch 1 train loss: 1184.495, val loss: 187.096, train acc: 0.967, val acc: 0.982
diff inf
epoch 2 train loss: 262.144, val loss: 138.494, train acc: 0.990, val acc: 0.988
diff 48.60176324273772
epoch 3 train loss: 113.308, val loss: 149.679, train acc: 0.996, val acc: 0.989
diff 11.185437182753361
epoch 4 train loss: 55.785, val loss: 248.615, train acc: 0.998, val acc: 0.985
diff 98.93574553569593
epoch 5 train loss: 149.419, val loss: 465.477, train acc: 0.994, val acc: 0.978
diff 216.86205814969813
epoch 6 train loss: 164.814, val loss: 234.325, train acc: 0.994, val acc: 0.979
diff 231.15225908462958
epoch 7 train loss: 49.339, val loss: 285.831, train acc: 0.998, val acc: 0.983
diff 51.505623141335036
epoch 8 train loss: 27.176, val loss: 294.614, train acc: 0.999, val acc: 0.981
diff 8.783470169863108
epoch 9 train loss: 2.692, val loss: 309.600, train acc: 1.000, val acc: 0.982
diff 14.986137225365553
epoch 10 train loss: 0.120, val loss: 310.344, train acc: 1.000, val acc: 0.982
diff 0.7435431414367599
epoch 11 train loss: 0.076, val loss: 310.583, train acc: 1.000, val acc: 0.982
diff 0.23958209040750944
epoch 12 train loss: 0.051, val loss: 311.921, train acc: 1.000, val acc: 0.983
diff 1.337290440216691
epoch 13 train loss: 0.035, val loss: 314.140, train acc: 1.000, val acc: 0.982
diff 2.219869352270848
epoch 14 train loss: 0.024, val loss: 316.228, train acc: 1.000, val acc: 0.982
diff 2.087343822420621
epoch 15 train loss: 0.016, val loss: 320.071, train acc: 1.000, val acc: 0.982
diff 3.8433515655122505
epoch 16 train loss: 0.011, val loss: 323.873, train acc: 1.000, val acc: 0.982
diff 3.801614398627919
epoch 17 train loss: 0.007, val loss: 328.137, train acc: 1.000, val acc: 0.982
diff 4.264680257905184
epoch 18 train loss: 0.005, val loss: 331.384, train acc: 1.000, val acc: 0.982
diff 3.2467159093861824
epoch 19 train loss: 0.003, val loss: 334.247, train acc: 1.000, val acc: 0.982
diff 2.862848611394952
epoch 20 train loss: 0.002, val loss: 339.346, train acc: 1.000, val acc: 0.982
diff 5.098705845424149
epoch 21 train loss: 0.001, val loss: 343.128, train acc: 1.000, val acc: 0.983
diff 3.7827345379266717
epoch 22 train loss: 0.001, val loss: 347.001, train acc: 1.000, val acc: 0.983
diff 3.872492333354387
epoch 23 train loss: 0.001, val loss: 351.362, train acc: 1.000, val acc: 0.983
diff 4.360991981355539
epoch 24 train loss: 0.000, val loss: 356.727, train acc: 1.000, val acc: 0.983
diff 5.365209142398783
epoch 25 train loss: 0.000, val loss: 360.674, train acc: 1.000, val acc: 0.983
diff 3.946591452863345
epoch 26 train loss: 0.000, val loss: 365.165, train acc: 1.000, val acc: 0.983
diff 4.491351878172907
epoch 27 train loss: 0.000, val loss: 369.482, train acc: 1.000, val acc: 0.983
diff 4.317151472784531
epoch 28 train loss: 0.000, val loss: 375.540, train acc: 1.000, val acc: 0.984
diff 6.057765583930632
epoch 29 train loss: 0.000, val loss: 379.355, train acc: 1.000, val acc: 0.984
diff 3.8154340788553895
epoch 30 train loss: 0.000, val loss: 385.871, train acc: 1.000, val acc: 0.984
diff 6.51513011663485
