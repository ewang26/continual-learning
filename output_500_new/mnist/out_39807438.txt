Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 11, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2347.190, val loss: 175.463, train acc: 0.967, val acc: 0.979
diff inf
epoch 2 train loss: 865.988, val loss: 125.663, train acc: 0.987, val acc: 0.985
diff 49.79976564818233
epoch 3 train loss: 450.436, val loss: 118.546, train acc: 0.993, val acc: 0.990
diff 7.117005164379435
epoch 4 train loss: 326.713, val loss: 99.176, train acc: 0.995, val acc: 0.992
diff 19.369822743745942
epoch 5 train loss: 301.525, val loss: 83.002, train acc: 0.995, val acc: 0.993
diff 16.174208327782736
epoch 6 train loss: 205.786, val loss: 103.960, train acc: 0.998, val acc: 0.992
diff 20.957944184271113
epoch 7 train loss: 242.261, val loss: 338.204, train acc: 0.997, val acc: 0.980
diff 234.24440750768974
epoch 8 train loss: 168.533, val loss: 135.424, train acc: 0.998, val acc: 0.992
diff 202.78033344648776
epoch 9 train loss: 163.612, val loss: 229.014, train acc: 0.998, val acc: 0.987
diff 93.59058643307998
epoch 10 train loss: 141.457, val loss: 219.091, train acc: 0.999, val acc: 0.989
diff 9.92346724233758
epoch 11 train loss: 178.620, val loss: 163.245, train acc: 0.998, val acc: 0.990
diff 55.846346001695196
epoch 12 train loss: 136.906, val loss: 244.773, train acc: 0.998, val acc: 0.989
diff 81.52831733970868
epoch 13 train loss: 90.367, val loss: 257.417, train acc: 0.999, val acc: 0.992
diff 12.644083268062218
epoch 14 train loss: 185.585, val loss: 311.573, train acc: 0.998, val acc: 0.988
diff 54.15607370358401
epoch 15 train loss: 157.276, val loss: 311.488, train acc: 0.998, val acc: 0.988
diff 0.08479392235756222
Training model M2
epoch 1 train loss: 3782.071, val loss: 189.054, train acc: 0.956, val acc: 0.981
diff inf
epoch 2 train loss: 1398.504, val loss: 189.995, train acc: 0.984, val acc: 0.983
diff 0.9409922927809191
epoch 3 train loss: 788.041, val loss: 228.616, train acc: 0.991, val acc: 0.980
diff 38.620947063611254
epoch 4 train loss: 564.196, val loss: 146.681, train acc: 0.994, val acc: 0.989
diff 81.93574612857029
epoch 5 train loss: 478.048, val loss: 173.573, train acc: 0.994, val acc: 0.986
diff 26.891931875797752
epoch 6 train loss: 376.377, val loss: 263.096, train acc: 0.995, val acc: 0.985
diff 89.52392266245062
epoch 7 train loss: 324.416, val loss: 256.030, train acc: 0.997, val acc: 0.987
diff 7.066584957634632
epoch 8 train loss: 358.304, val loss: 267.813, train acc: 0.996, val acc: 0.985
diff 11.783094134965722
epoch 9 train loss: 303.536, val loss: 282.045, train acc: 0.997, val acc: 0.986
diff 14.231986563762518
epoch 10 train loss: 305.108, val loss: 345.882, train acc: 0.997, val acc: 0.984
diff 63.836762405260515
epoch 11 train loss: 290.261, val loss: 354.485, train acc: 0.997, val acc: 0.988
diff 8.603310218781871
epoch 12 train loss: 247.814, val loss: 353.631, train acc: 0.998, val acc: 0.986
diff 0.8545151058266356
epoch 13 train loss: 207.047, val loss: 417.148, train acc: 0.998, val acc: 0.987
diff 63.51784985098226
epoch 14 train loss: 250.938, val loss: 364.988, train acc: 0.998, val acc: 0.986
diff 52.16067801003976
epoch 15 train loss: 184.453, val loss: 345.994, train acc: 0.998, val acc: 0.988
diff 18.99407533337552
epoch 16 train loss: 230.092, val loss: 376.641, train acc: 0.998, val acc: 0.988
diff 30.647674007395324
epoch 17 train loss: 282.269, val loss: 506.853, train acc: 0.998, val acc: 0.986
diff 130.21149894073835
epoch 18 train loss: 219.734, val loss: 449.151, train acc: 0.998, val acc: 0.988
diff 57.70217910832207
epoch 19 train loss: 179.564, val loss: 383.250, train acc: 0.999, val acc: 0.988
diff 65.90016949617268
epoch 20 train loss: 311.031, val loss: 438.715, train acc: 0.998, val acc: 0.988
diff 55.4643250065177
epoch 21 train loss: 132.091, val loss: 494.186, train acc: 0.999, val acc: 0.987
diff 55.47098112023161
epoch 22 train loss: 302.575, val loss: 513.028, train acc: 0.998, val acc: 0.987
diff 18.8426252263572
epoch 23 train loss: 293.152, val loss: 696.697, train acc: 0.998, val acc: 0.984
diff 183.66830271548667
epoch 24 train loss: 280.518, val loss: 530.735, train acc: 0.999, val acc: 0.987
diff 165.96146760131603
epoch 25 train loss: 189.539, val loss: 649.737, train acc: 0.999, val acc: 0.987
diff 119.00153636376649
epoch 26 train loss: 233.003, val loss: 748.858, train acc: 0.999, val acc: 0.990
diff 99.12171477619745
epoch 27 train loss: 187.793, val loss: 863.054, train acc: 0.999, val acc: 0.987
diff 114.19549217788938
epoch 28 train loss: 252.234, val loss: 797.689, train acc: 0.999, val acc: 0.986
diff 65.36476854569742
epoch 29 train loss: 337.061, val loss: 699.378, train acc: 0.999, val acc: 0.986
diff 98.31083170791351
epoch 30 train loss: 294.657, val loss: 721.541, train acc: 0.998, val acc: 0.987
diff 22.162316289511864
Training model M3
epoch 1 train loss: 1905.481, val loss: 442.093, train acc: 0.926, val acc: 0.959
diff inf
epoch 2 train loss: 491.639, val loss: 470.453, train acc: 0.982, val acc: 0.958
diff 28.359149901352907
epoch 3 train loss: 231.955, val loss: 710.761, train acc: 0.989, val acc: 0.940
diff 240.3088036061987
epoch 4 train loss: 218.008, val loss: 448.342, train acc: 0.991, val acc: 0.962
diff 262.4192946786447
epoch 5 train loss: 147.029, val loss: 597.901, train acc: 0.994, val acc: 0.954
diff 149.55854653553428
epoch 6 train loss: 164.687, val loss: 548.880, train acc: 0.994, val acc: 0.960
diff 49.021040088485506
epoch 7 train loss: 30.102, val loss: 447.420, train acc: 0.999, val acc: 0.974
diff 101.46003141915287
epoch 8 train loss: 1.439, val loss: 534.191, train acc: 1.000, val acc: 0.971
diff 86.77182007483646
epoch 9 train loss: 0.174, val loss: 528.447, train acc: 1.000, val acc: 0.972
diff 5.744278993251783
epoch 10 train loss: 0.093, val loss: 534.791, train acc: 1.000, val acc: 0.973
diff 6.3441383884496645
epoch 11 train loss: 0.063, val loss: 543.721, train acc: 1.000, val acc: 0.972
diff 8.930257845613824
epoch 12 train loss: 0.043, val loss: 554.640, train acc: 1.000, val acc: 0.972
diff 10.91887755916673
epoch 13 train loss: 0.029, val loss: 565.494, train acc: 1.000, val acc: 0.972
diff 10.854029609322083
epoch 14 train loss: 0.019, val loss: 578.135, train acc: 1.000, val acc: 0.972
diff 12.640344362426504
epoch 15 train loss: 0.013, val loss: 593.917, train acc: 1.000, val acc: 0.972
diff 15.782735725268594
epoch 16 train loss: 0.009, val loss: 606.607, train acc: 1.000, val acc: 0.972
diff 12.690048547467995
epoch 17 train loss: 0.006, val loss: 625.641, train acc: 1.000, val acc: 0.972
diff 19.033501831512694
epoch 18 train loss: 0.004, val loss: 641.124, train acc: 1.000, val acc: 0.972
diff 15.482896107850706
epoch 19 train loss: 0.002, val loss: 655.670, train acc: 1.000, val acc: 0.972
diff 14.546261641903016
epoch 20 train loss: 0.002, val loss: 670.225, train acc: 1.000, val acc: 0.972
diff 14.55500238572506
epoch 21 train loss: 0.001, val loss: 692.030, train acc: 1.000, val acc: 0.970
diff 21.804777303073024
epoch 22 train loss: 0.001, val loss: 700.709, train acc: 1.000, val acc: 0.972
diff 8.679459815180394
epoch 23 train loss: 0.000, val loss: 720.425, train acc: 1.000, val acc: 0.972
diff 19.71559425128237
epoch 24 train loss: 0.000, val loss: 730.845, train acc: 1.000, val acc: 0.971
diff 10.41985135973971
epoch 25 train loss: 0.000, val loss: 746.647, train acc: 1.000, val acc: 0.972
diff 15.80216981272065
epoch 26 train loss: 0.000, val loss: 763.556, train acc: 1.000, val acc: 0.971
diff 16.90911214999653
epoch 27 train loss: 0.000, val loss: 783.434, train acc: 1.000, val acc: 0.972
diff 19.877560739981504
epoch 28 train loss: 0.000, val loss: 795.718, train acc: 1.000, val acc: 0.971
diff 12.284731728201223
epoch 29 train loss: 0.000, val loss: 810.116, train acc: 1.000, val acc: 0.971
diff 14.397197968079468
epoch 30 train loss: 0.000, val loss: 826.872, train acc: 1.000, val acc: 0.971
diff 16.75679596406792
Training model M3
epoch 1 train loss: 137.684, val loss: 2726.344, train acc: 0.997, val acc: 0.909
diff inf
epoch 2 train loss: 183.602, val loss: 1803.259, train acc: 0.995, val acc: 0.934
diff 923.0846136575158
epoch 3 train loss: 32.546, val loss: 2068.936, train acc: 0.999, val acc: 0.932
diff 265.677241235476
epoch 4 train loss: 0.781, val loss: 2211.410, train acc: 1.000, val acc: 0.928
diff 142.47325109013536
epoch 5 train loss: 0.023, val loss: 2209.732, train acc: 1.000, val acc: 0.928
diff 1.6776585638153847
epoch 6 train loss: 0.017, val loss: 2207.292, train acc: 1.000, val acc: 0.929
diff 2.4399540726567466
epoch 7 train loss: 0.013, val loss: 2206.711, train acc: 1.000, val acc: 0.930
diff 0.5813600166670767
epoch 8 train loss: 0.010, val loss: 2207.393, train acc: 1.000, val acc: 0.930
diff 0.6823438713781798
epoch 9 train loss: 0.007, val loss: 2215.161, train acc: 1.000, val acc: 0.930
diff 7.767937876246378
epoch 10 train loss: 0.005, val loss: 2225.566, train acc: 1.000, val acc: 0.930
diff 10.405472738885692
epoch 11 train loss: 0.004, val loss: 2237.518, train acc: 1.000, val acc: 0.930
diff 11.951955699013979
epoch 12 train loss: 0.003, val loss: 2248.943, train acc: 1.000, val acc: 0.932
diff 11.424477466681765
epoch 13 train loss: 0.002, val loss: 2265.465, train acc: 1.000, val acc: 0.931
diff 16.52169365216514
epoch 14 train loss: 0.001, val loss: 2281.254, train acc: 1.000, val acc: 0.931
diff 15.789669321437486
epoch 15 train loss: 0.001, val loss: 2302.407, train acc: 1.000, val acc: 0.931
diff 21.152655012401738
epoch 16 train loss: 0.001, val loss: 2322.851, train acc: 1.000, val acc: 0.931
diff 20.444024125972646
epoch 17 train loss: 0.000, val loss: 2347.730, train acc: 1.000, val acc: 0.931
diff 24.878816762378847
epoch 18 train loss: 0.000, val loss: 2370.881, train acc: 1.000, val acc: 0.930
diff 23.15089872069302
epoch 19 train loss: 0.000, val loss: 2392.661, train acc: 1.000, val acc: 0.930
diff 21.78002019394762
epoch 20 train loss: 0.000, val loss: 2416.950, train acc: 1.000, val acc: 0.930
diff 24.28886394711344
epoch 21 train loss: 0.000, val loss: 2444.052, train acc: 1.000, val acc: 0.930
diff 27.102143606871778
epoch 22 train loss: 0.000, val loss: 2471.482, train acc: 1.000, val acc: 0.930
diff 27.4306013938085
epoch 23 train loss: 0.000, val loss: 2495.391, train acc: 1.000, val acc: 0.930
diff 23.909214608991533
epoch 24 train loss: 0.000, val loss: 2523.044, train acc: 1.000, val acc: 0.929
diff 27.652255994878487
epoch 25 train loss: 0.000, val loss: 2552.797, train acc: 1.000, val acc: 0.930
diff 29.75290034835143
epoch 26 train loss: 0.000, val loss: 2580.064, train acc: 1.000, val acc: 0.929
diff 27.26736583724869
epoch 27 train loss: 0.000, val loss: 2610.743, train acc: 1.000, val acc: 0.930
diff 30.679273829316116
epoch 28 train loss: 0.000, val loss: 2640.113, train acc: 1.000, val acc: 0.930
diff 29.369509913504317
epoch 29 train loss: 0.000, val loss: 2663.819, train acc: 1.000, val acc: 0.930
diff 23.706131513712535
epoch 30 train loss: 0.000, val loss: 2690.846, train acc: 1.000, val acc: 0.930
diff 27.0271977618836
Training model M3
epoch 1 train loss: 1412.412, val loss: 175.967, train acc: 0.966, val acc: 0.981
diff inf
epoch 2 train loss: 303.066, val loss: 132.135, train acc: 0.989, val acc: 0.988
diff 43.83182895516313
epoch 3 train loss: 129.442, val loss: 295.307, train acc: 0.996, val acc: 0.978
diff 163.17204613919125
epoch 4 train loss: 109.667, val loss: 323.010, train acc: 0.995, val acc: 0.975
diff 27.703471318408333
epoch 5 train loss: 157.505, val loss: 288.249, train acc: 0.993, val acc: 0.978
diff 34.76090551099486
epoch 6 train loss: 96.289, val loss: 552.432, train acc: 0.996, val acc: 0.968
diff 264.1829409104465
epoch 7 train loss: 197.048, val loss: 379.995, train acc: 0.992, val acc: 0.977
diff 172.4368877985305
epoch 8 train loss: 78.574, val loss: 363.910, train acc: 0.996, val acc: 0.976
diff 16.085349177360342
epoch 9 train loss: 85.075, val loss: 357.403, train acc: 0.997, val acc: 0.979
diff 6.507572767984982
epoch 10 train loss: 107.325, val loss: 403.285, train acc: 0.995, val acc: 0.981
diff 45.88266796977251
epoch 11 train loss: 180.813, val loss: 457.137, train acc: 0.994, val acc: 0.975
diff 53.85217358131388
epoch 12 train loss: 77.689, val loss: 392.910, train acc: 0.997, val acc: 0.980
diff 64.22701993516569
epoch 13 train loss: 8.637, val loss: 373.934, train acc: 1.000, val acc: 0.984
diff 18.976577981981904
epoch 14 train loss: 0.337, val loss: 395.631, train acc: 1.000, val acc: 0.982
diff 21.69714838770483
epoch 15 train loss: 0.052, val loss: 394.192, train acc: 1.000, val acc: 0.982
diff 1.4393150459800381
epoch 16 train loss: 0.038, val loss: 393.682, train acc: 1.000, val acc: 0.982
diff 0.5093587341753505
epoch 17 train loss: 0.029, val loss: 393.707, train acc: 1.000, val acc: 0.983
diff 0.02455077952646434
2
