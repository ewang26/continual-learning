Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 1, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2413.907, val loss: 187.938, train acc: 0.965, val acc: 0.976
diff inf
epoch 2 train loss: 813.982, val loss: 125.166, train acc: 0.989, val acc: 0.984
diff 62.77117558104118
epoch 3 train loss: 489.248, val loss: 85.710, train acc: 0.993, val acc: 0.991
diff 39.45686628513296
epoch 4 train loss: 288.334, val loss: 104.458, train acc: 0.996, val acc: 0.990
diff 18.74832901783327
epoch 5 train loss: 267.391, val loss: 125.659, train acc: 0.996, val acc: 0.988
diff 21.201047528886036
epoch 6 train loss: 280.558, val loss: 125.759, train acc: 0.997, val acc: 0.988
diff 0.09978302265392358
Training model M2
epoch 1 train loss: 3923.168, val loss: 236.680, train acc: 0.956, val acc: 0.978
diff inf
epoch 2 train loss: 1305.400, val loss: 162.244, train acc: 0.985, val acc: 0.986
diff 74.43608669390093
epoch 3 train loss: 768.521, val loss: 175.086, train acc: 0.991, val acc: 0.987
diff 12.842566983735878
epoch 4 train loss: 570.503, val loss: 298.701, train acc: 0.993, val acc: 0.981
diff 123.61505330963709
epoch 5 train loss: 423.977, val loss: 158.749, train acc: 0.995, val acc: 0.988
diff 139.95244052733813
epoch 6 train loss: 339.352, val loss: 230.515, train acc: 0.996, val acc: 0.983
diff 71.76622713520095
epoch 7 train loss: 383.264, val loss: 237.264, train acc: 0.996, val acc: 0.988
diff 6.748704035967108
epoch 8 train loss: 304.341, val loss: 300.985, train acc: 0.997, val acc: 0.985
diff 63.72153576871139
epoch 9 train loss: 279.952, val loss: 230.285, train acc: 0.997, val acc: 0.986
diff 70.70055201008975
epoch 10 train loss: 267.120, val loss: 229.492, train acc: 0.998, val acc: 0.989
diff 0.792394160394366
epoch 11 train loss: 322.671, val loss: 242.317, train acc: 0.997, val acc: 0.990
diff 12.824580393291257
epoch 12 train loss: 243.870, val loss: 351.678, train acc: 0.998, val acc: 0.985
diff 109.3607132916757
epoch 13 train loss: 263.577, val loss: 483.205, train acc: 0.998, val acc: 0.985
diff 131.52714026260924
epoch 14 train loss: 106.352, val loss: 268.736, train acc: 0.999, val acc: 0.990
diff 214.46903977765965
epoch 15 train loss: 407.881, val loss: 495.123, train acc: 0.997, val acc: 0.982
diff 226.3877317967083
epoch 16 train loss: 262.569, val loss: 526.106, train acc: 0.998, val acc: 0.986
diff 30.982715467989976
epoch 17 train loss: 261.285, val loss: 398.967, train acc: 0.998, val acc: 0.987
diff 127.13881986185936
epoch 18 train loss: 256.962, val loss: 438.751, train acc: 0.998, val acc: 0.987
diff 39.783182691203706
epoch 19 train loss: 208.595, val loss: 550.447, train acc: 0.999, val acc: 0.987
diff 111.69621035305693
epoch 20 train loss: 73.937, val loss: 592.893, train acc: 0.999, val acc: 0.985
diff 42.44586453034799
epoch 21 train loss: 344.466, val loss: 562.451, train acc: 0.998, val acc: 0.987
diff 30.441506178571785
epoch 22 train loss: 301.086, val loss: 571.680, train acc: 0.999, val acc: 0.986
diff 9.228509067370851
epoch 23 train loss: 269.500, val loss: 494.105, train acc: 0.998, val acc: 0.987
diff 77.5749017693779
epoch 24 train loss: 189.265, val loss: 615.590, train acc: 0.999, val acc: 0.986
diff 121.48494742713012
epoch 25 train loss: 213.409, val loss: 468.094, train acc: 0.999, val acc: 0.988
diff 147.4959268193884
epoch 26 train loss: 113.920, val loss: 681.749, train acc: 0.999, val acc: 0.988
diff 213.65510504379415
epoch 27 train loss: 357.458, val loss: 602.987, train acc: 0.999, val acc: 0.987
diff 78.7617482325162
epoch 28 train loss: 242.939, val loss: 669.716, train acc: 0.999, val acc: 0.985
diff 66.7290027094723
epoch 29 train loss: 320.846, val loss: 873.372, train acc: 0.999, val acc: 0.986
diff 203.6562263860102
epoch 30 train loss: 251.406, val loss: 716.008, train acc: 0.999, val acc: 0.987
diff 157.36397347828733
Training model M3
epoch 1 train loss: 1981.307, val loss: 502.112, train acc: 0.924, val acc: 0.948
diff inf
epoch 2 train loss: 507.477, val loss: 508.204, train acc: 0.980, val acc: 0.949
diff 6.09174070739499
epoch 3 train loss: 315.826, val loss: 739.983, train acc: 0.986, val acc: 0.935
diff 231.77897839683908
epoch 4 train loss: 142.765, val loss: 394.409, train acc: 0.994, val acc: 0.967
diff 345.5732417794596
epoch 5 train loss: 203.176, val loss: 783.274, train acc: 0.991, val acc: 0.935
diff 388.86452015123353
epoch 6 train loss: 92.727, val loss: 494.900, train acc: 0.996, val acc: 0.963
diff 288.3737415674664
epoch 7 train loss: 131.669, val loss: 594.978, train acc: 0.995, val acc: 0.961
diff 100.07837536988524
epoch 8 train loss: 82.521, val loss: 899.944, train acc: 0.996, val acc: 0.949
diff 304.96522222793465
epoch 9 train loss: 90.545, val loss: 763.049, train acc: 0.997, val acc: 0.952
diff 136.89465827543927
epoch 10 train loss: 152.264, val loss: 666.983, train acc: 0.995, val acc: 0.955
diff 96.06627507811845
epoch 11 train loss: 66.468, val loss: 806.235, train acc: 0.998, val acc: 0.954
diff 139.25258736998217
epoch 12 train loss: 36.337, val loss: 742.455, train acc: 0.999, val acc: 0.960
diff 63.77987225828679
epoch 13 train loss: 17.263, val loss: 819.867, train acc: 0.999, val acc: 0.961
diff 77.41195148560928
epoch 14 train loss: 55.391, val loss: 879.258, train acc: 0.998, val acc: 0.950
diff 59.390999397914015
epoch 15 train loss: 142.058, val loss: 795.461, train acc: 0.995, val acc: 0.963
diff 83.79788022612138
epoch 16 train loss: 67.494, val loss: 880.676, train acc: 0.998, val acc: 0.960
diff 85.21555506925199
epoch 17 train loss: 22.528, val loss: 682.654, train acc: 0.999, val acc: 0.968
diff 198.02188005366213
epoch 18 train loss: 110.255, val loss: 678.837, train acc: 0.996, val acc: 0.968
diff 3.816756442613837
epoch 19 train loss: 45.525, val loss: 787.719, train acc: 0.998, val acc: 0.954
diff 108.88138912260672
epoch 20 train loss: 107.856, val loss: 845.836, train acc: 0.996, val acc: 0.965
diff 58.117003457309806
epoch 21 train loss: 35.503, val loss: 1217.709, train acc: 0.999, val acc: 0.955
diff 371.8734021489813
epoch 22 train loss: 45.661, val loss: 956.464, train acc: 0.998, val acc: 0.964
diff 261.2452327986614
epoch 23 train loss: 76.827, val loss: 1339.129, train acc: 0.998, val acc: 0.958
diff 382.66481516839735
epoch 24 train loss: 82.615, val loss: 1323.939, train acc: 0.998, val acc: 0.959
diff 15.190245397434865
epoch 25 train loss: 52.935, val loss: 890.290, train acc: 0.998, val acc: 0.966
diff 433.64878328090356
epoch 26 train loss: 53.590, val loss: 1296.739, train acc: 0.998, val acc: 0.962
diff 406.4491299292016
epoch 27 train loss: 2.954, val loss: 1109.953, train acc: 1.000, val acc: 0.968
diff 186.78592074568314
epoch 28 train loss: 0.011, val loss: 1098.219, train acc: 1.000, val acc: 0.968
diff 11.73357091763728
epoch 29 train loss: 0.005, val loss: 1093.852, train acc: 1.000, val acc: 0.968
diff 4.367856178137345
epoch 30 train loss: 0.004, val loss: 1089.681, train acc: 1.000, val acc: 0.968
diff 4.170665086100826
Training model M3
epoch 1 train loss: 80.862, val loss: 2328.788, train acc: 0.999, val acc: 0.944
diff inf
epoch 2 train loss: 115.151, val loss: 2365.845, train acc: 0.998, val acc: 0.947
diff 37.05707932259611
epoch 3 train loss: 10.584, val loss: 2157.065, train acc: 0.999, val acc: 0.953
diff 208.77991578999627
epoch 4 train loss: 0.000, val loss: 2120.036, train acc: 1.000, val acc: 0.954
diff 37.02863236622443
epoch 5 train loss: 0.000, val loss: 2117.721, train acc: 1.000, val acc: 0.954
diff 2.315126015855185
epoch 6 train loss: 0.000, val loss: 2115.268, train acc: 1.000, val acc: 0.954
diff 2.45329768513011
epoch 7 train loss: 0.000, val loss: 2114.467, train acc: 1.000, val acc: 0.954
diff 0.8012340139325715
epoch 8 train loss: 0.000, val loss: 2113.106, train acc: 1.000, val acc: 0.953
diff 1.3603219357210037
epoch 9 train loss: 0.000, val loss: 2112.310, train acc: 1.000, val acc: 0.953
diff 0.7963538871263154
epoch 10 train loss: 0.000, val loss: 2111.860, train acc: 1.000, val acc: 0.953
diff 0.4503635446444605
epoch 11 train loss: 0.000, val loss: 2111.476, train acc: 1.000, val acc: 0.953
diff 0.3841086286256541
epoch 12 train loss: 0.000, val loss: 2110.615, train acc: 1.000, val acc: 0.953
diff 0.8608246197645713
epoch 13 train loss: 0.000, val loss: 2111.410, train acc: 1.000, val acc: 0.953
diff 0.795028736225504
epoch 14 train loss: 0.000, val loss: 2111.013, train acc: 1.000, val acc: 0.953
diff 0.39678867793281825
epoch 15 train loss: 0.000, val loss: 2111.364, train acc: 1.000, val acc: 0.953
diff 0.35082851525294245
epoch 16 train loss: 0.000, val loss: 2111.902, train acc: 1.000, val acc: 0.954
diff 0.5376452780196814
epoch 17 train loss: 0.000, val loss: 2112.990, train acc: 1.000, val acc: 0.954
diff 1.0881324876781946
epoch 18 train loss: 0.000, val loss: 2113.426, train acc: 1.000, val acc: 0.954
diff 0.4365867485707895
epoch 19 train loss: 0.000, val loss: 2113.600, train acc: 1.000, val acc: 0.954
diff 0.17361681595320988
epoch 20 train loss: 0.000, val loss: 2114.412, train acc: 1.000, val acc: 0.954
diff 0.812189192945425
epoch 21 train loss: 0.000, val loss: 2115.064, train acc: 1.000, val acc: 0.954
diff 0.6518268286445164
epoch 22 train loss: 0.000, val loss: 2115.377, train acc: 1.000, val acc: 0.954
diff 0.3127449764579069
epoch 23 train loss: 0.000, val loss: 2116.250, train acc: 1.000, val acc: 0.954
diff 0.8735638217144697
epoch 24 train loss: 0.000, val loss: 2116.651, train acc: 1.000, val acc: 0.954
diff 0.40074199044556735
epoch 25 train loss: 0.000, val loss: 2117.790, train acc: 1.000, val acc: 0.954
diff 1.1387310571126363
epoch 26 train loss: 0.000, val loss: 2119.323, train acc: 1.000, val acc: 0.954
diff 1.533694332183586
epoch 27 train loss: 0.000, val loss: 2121.096, train acc: 1.000, val acc: 0.954
diff 1.7723561518509996
epoch 28 train loss: 0.000, val loss: 2123.950, train acc: 1.000, val acc: 0.954
diff 2.8542782973586327
epoch 29 train loss: 0.000, val loss: 2127.517, train acc: 1.000, val acc: 0.954
diff 3.567173845030993
epoch 30 train loss: 0.000, val loss: 2130.566, train acc: 1.000, val acc: 0.953
diff 3.0486770742136287
Training model M3
epoch 1 train loss: 1520.687, val loss: 160.881, train acc: 0.963, val acc: 0.984
diff inf
epoch 2 train loss: 264.563, val loss: 154.478, train acc: 0.990, val acc: 0.985
diff 6.402481050304004
epoch 3 train loss: 68.115, val loss: 190.913, train acc: 0.998, val acc: 0.983
diff 36.43429541055809
epoch 4 train loss: 10.076, val loss: 175.367, train acc: 1.000, val acc: 0.986
diff 15.546113880656065
epoch 5 train loss: 1.465, val loss: 172.416, train acc: 1.000, val acc: 0.987
diff 2.9503048827116345
epoch 6 train loss: 0.357, val loss: 175.964, train acc: 1.000, val acc: 0.988
diff 3.547987600354105
epoch 7 train loss: 0.204, val loss: 179.766, train acc: 1.000, val acc: 0.988
diff 3.8016793602724306
epoch 8 train loss: 0.127, val loss: 184.280, train acc: 1.000, val acc: 0.988
diff 4.513553767073432
epoch 9 train loss: 0.080, val loss: 189.545, train acc: 1.000, val acc: 0.988
diff 5.265459478091884
epoch 10 train loss: 0.049, val loss: 193.459, train acc: 1.000, val acc: 0.988
diff 3.913937587012299
epoch 11 train loss: 0.026, val loss: 202.968, train acc: 1.000, val acc: 0.988
diff 9.509309968437663
epoch 12 train loss: 0.014, val loss: 207.588, train acc: 1.000, val acc: 0.988
diff 4.6201024027236315
epoch 13 train loss: 0.008, val loss: 213.832, train acc: 1.000, val acc: 0.988
diff 6.24334338273286
epoch 14 train loss: 0.005, val loss: 216.915, train acc: 1.000, val acc: 0.988
diff 3.083726527616676
epoch 15 train loss: 0.003, val loss: 226.142, train acc: 1.000, val acc: 0.988
diff 9.226307447904986
epoch 16 train loss: 0.002, val loss: 237.079, train acc: 1.000, val acc: 0.987
diff 10.9373810450858
epoch 17 train loss: 0.001, val loss: 242.478, train acc: 1.000, val acc: 0.988
diff 5.3985143113696665
epoch 18 train loss: 0.001, val loss: 248.869, train acc: 1.000, val acc: 0.987
diff 6.390913749894878
epoch 19 train loss: 0.000, val loss: 256.929, train acc: 1.000, val acc: 0.988
diff 8.060046846998603
epoch 20 train loss: 0.000, val loss: 264.995, train acc: 1.000, val acc: 0.988
diff 8.066626894027593
epoch 21 train loss: 0.000, val loss: 270.318, train acc: 1.000, val acc: 0.987
diff 5.323234647503739
epoch 22 train loss: 0.000, val loss: 275.245, train acc: 1.000, val acc: 0.988
diff 4.9262098270000365
epoch 23 train loss: 0.000, val loss: 284.992, train acc: 1.000, val acc: 0.987
diff 9.747071071433595
epoch 24 train loss: 0.000, val loss: 290.296, train acc: 1.000, val acc: 0.988
diff 5.303774109605229
epoch 25 train loss: 0.000, val loss: 296.981, train acc: 1.000, val acc: 0.987
diff 6.68544903545893
epoch 26 train loss: 0.000, val loss: 302.106, train acc: 1.000, val acc: 0.987
diff 5.12503166044695
epoch 27 train loss: 0.000, val loss: 308.674, train acc: 1.000, val acc: 0.986
diff 6.56753299403357
epoch 28 train loss: 0.000, val loss: 315.174, train acc: 1.000, val acc: 0.987
diff 6.500137386476467
epoch 29 train loss: 0.000, val loss: 321.451, train acc: 1.000, val acc: 0.987
diff 6.277604290561499
epoch 30 train loss: 0.000, val loss: 321.621, train acc: 1.000, val acc: 0.986
diff 0.16971004583706417
2
2
2
2
