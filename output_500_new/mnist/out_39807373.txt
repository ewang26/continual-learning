Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.02, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 11, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2347.190, val loss: 175.463, train acc: 0.967, val acc: 0.979
diff inf
epoch 2 train loss: 865.988, val loss: 125.663, train acc: 0.987, val acc: 0.985
diff 49.79976564818233
epoch 3 train loss: 450.436, val loss: 118.546, train acc: 0.993, val acc: 0.990
diff 7.117005164379435
epoch 4 train loss: 326.713, val loss: 99.176, train acc: 0.995, val acc: 0.992
diff 19.369822743745942
epoch 5 train loss: 301.525, val loss: 83.002, train acc: 0.995, val acc: 0.993
diff 16.174208327782736
epoch 6 train loss: 205.786, val loss: 103.960, train acc: 0.998, val acc: 0.992
diff 20.957944184271113
epoch 7 train loss: 242.261, val loss: 338.204, train acc: 0.997, val acc: 0.980
diff 234.24440750768974
epoch 8 train loss: 168.533, val loss: 135.424, train acc: 0.998, val acc: 0.992
diff 202.78033344648776
epoch 9 train loss: 163.612, val loss: 229.014, train acc: 0.998, val acc: 0.987
diff 93.59058643307998
epoch 10 train loss: 141.457, val loss: 219.091, train acc: 0.999, val acc: 0.989
diff 9.92346724233758
epoch 11 train loss: 178.620, val loss: 163.245, train acc: 0.998, val acc: 0.990
diff 55.846346001695196
epoch 12 train loss: 136.906, val loss: 244.773, train acc: 0.998, val acc: 0.989
diff 81.52831733970868
epoch 13 train loss: 90.367, val loss: 257.417, train acc: 0.999, val acc: 0.992
diff 12.644083268062218
epoch 14 train loss: 185.585, val loss: 311.573, train acc: 0.998, val acc: 0.988
diff 54.15607370358401
epoch 15 train loss: 157.276, val loss: 311.488, train acc: 0.998, val acc: 0.988
diff 0.08479392235756222
Training model M2
epoch 1 train loss: 3782.071, val loss: 189.054, train acc: 0.956, val acc: 0.981
diff inf
epoch 2 train loss: 1398.504, val loss: 189.995, train acc: 0.984, val acc: 0.983
diff 0.9409922927809191
epoch 3 train loss: 788.041, val loss: 228.616, train acc: 0.991, val acc: 0.980
diff 38.620947063611254
epoch 4 train loss: 564.196, val loss: 146.681, train acc: 0.994, val acc: 0.989
diff 81.93574612857029
epoch 5 train loss: 478.048, val loss: 173.573, train acc: 0.994, val acc: 0.986
diff 26.891931875797752
epoch 6 train loss: 376.377, val loss: 263.096, train acc: 0.995, val acc: 0.985
diff 89.52392266245062
epoch 7 train loss: 324.416, val loss: 256.030, train acc: 0.997, val acc: 0.987
diff 7.066584957634632
epoch 8 train loss: 358.304, val loss: 267.813, train acc: 0.996, val acc: 0.985
diff 11.783094134965722
epoch 9 train loss: 303.536, val loss: 282.045, train acc: 0.997, val acc: 0.986
diff 14.231986563762518
epoch 10 train loss: 305.108, val loss: 345.882, train acc: 0.997, val acc: 0.984
diff 63.836762405260515
epoch 11 train loss: 290.261, val loss: 354.485, train acc: 0.997, val acc: 0.988
diff 8.603310218781871
epoch 12 train loss: 247.814, val loss: 353.631, train acc: 0.998, val acc: 0.986
diff 0.8545151058266356
epoch 13 train loss: 207.047, val loss: 417.148, train acc: 0.998, val acc: 0.987
diff 63.51784985098226
epoch 14 train loss: 250.938, val loss: 364.988, train acc: 0.998, val acc: 0.986
diff 52.16067801003976
epoch 15 train loss: 184.453, val loss: 345.994, train acc: 0.998, val acc: 0.988
diff 18.99407533337552
epoch 16 train loss: 230.092, val loss: 376.641, train acc: 0.998, val acc: 0.988
diff 30.647674007395324
epoch 17 train loss: 282.269, val loss: 506.853, train acc: 0.998, val acc: 0.986
diff 130.21149894073835
epoch 18 train loss: 219.734, val loss: 449.151, train acc: 0.998, val acc: 0.988
diff 57.70217910832207
epoch 19 train loss: 179.564, val loss: 383.250, train acc: 0.999, val acc: 0.988
diff 65.90016949617268
epoch 20 train loss: 311.031, val loss: 438.715, train acc: 0.998, val acc: 0.988
diff 55.4643250065177
epoch 21 train loss: 132.091, val loss: 494.186, train acc: 0.999, val acc: 0.987
diff 55.47098112023161
epoch 22 train loss: 302.575, val loss: 513.028, train acc: 0.998, val acc: 0.987
diff 18.8426252263572
epoch 23 train loss: 293.152, val loss: 696.697, train acc: 0.998, val acc: 0.984
diff 183.66830271548667
epoch 24 train loss: 280.518, val loss: 530.735, train acc: 0.999, val acc: 0.987
diff 165.96146760131603
epoch 25 train loss: 189.539, val loss: 649.737, train acc: 0.999, val acc: 0.987
diff 119.00153636376649
epoch 26 train loss: 233.003, val loss: 748.858, train acc: 0.999, val acc: 0.990
diff 99.12171477619745
epoch 27 train loss: 187.793, val loss: 863.054, train acc: 0.999, val acc: 0.987
diff 114.19549217788938
epoch 28 train loss: 252.234, val loss: 797.689, train acc: 0.999, val acc: 0.986
diff 65.36476854569742
epoch 29 train loss: 337.061, val loss: 699.378, train acc: 0.999, val acc: 0.986
diff 98.31083170791351
epoch 30 train loss: 294.657, val loss: 721.541, train acc: 0.998, val acc: 0.987
diff 22.162316289511864
Training model M3
epoch 1 train loss: 1224.614, val loss: 1969.891, train acc: 0.940, val acc: 0.783
diff inf
epoch 2 train loss: 322.266, val loss: 997.614, train acc: 0.984, val acc: 0.902
diff 972.2767567245143
epoch 3 train loss: 110.629, val loss: 1321.745, train acc: 0.992, val acc: 0.890
diff 324.13099268249323
epoch 4 train loss: 127.485, val loss: 1047.195, train acc: 0.994, val acc: 0.912
diff 274.55043577332594
epoch 5 train loss: 97.225, val loss: 1724.216, train acc: 0.994, val acc: 0.872
diff 677.0209267074415
epoch 6 train loss: 52.476, val loss: 1740.989, train acc: 0.998, val acc: 0.894
diff 16.773508108476108
epoch 7 train loss: 54.132, val loss: 3689.220, train acc: 0.997, val acc: 0.805
diff 1948.230606752078
epoch 8 train loss: 130.528, val loss: 1449.963, train acc: 0.993, val acc: 0.917
diff 2239.2568557851973
epoch 9 train loss: 41.210, val loss: 2169.634, train acc: 0.997, val acc: 0.876
diff 719.671388939375
epoch 10 train loss: 10.749, val loss: 2392.319, train acc: 0.999, val acc: 0.903
diff 222.6848835260621
epoch 11 train loss: 115.843, val loss: 1735.247, train acc: 0.995, val acc: 0.921
diff 657.0715428204626
epoch 12 train loss: 23.939, val loss: 2803.950, train acc: 0.998, val acc: 0.891
diff 1068.7025642439548
epoch 13 train loss: 2.514, val loss: 2556.983, train acc: 1.000, val acc: 0.902
diff 246.9666907140404
epoch 14 train loss: 0.074, val loss: 2576.033, train acc: 1.000, val acc: 0.901
diff 19.04966232789002
epoch 15 train loss: 0.046, val loss: 2589.388, train acc: 1.000, val acc: 0.902
diff 13.355351781936406
epoch 16 train loss: 0.034, val loss: 2605.386, train acc: 1.000, val acc: 0.902
diff 15.997609266644758
epoch 17 train loss: 0.025, val loss: 2622.082, train acc: 1.000, val acc: 0.901
diff 16.696145702201648
epoch 18 train loss: 0.019, val loss: 2638.023, train acc: 1.000, val acc: 0.902
diff 15.940585215963438
epoch 19 train loss: 0.015, val loss: 2654.782, train acc: 1.000, val acc: 0.902
diff 16.759513417442577
epoch 20 train loss: 0.011, val loss: 2675.367, train acc: 1.000, val acc: 0.902
diff 20.585022438525357
epoch 21 train loss: 0.009, val loss: 2694.925, train acc: 1.000, val acc: 0.902
diff 19.557728225937808
epoch 22 train loss: 0.006, val loss: 2728.191, train acc: 1.000, val acc: 0.903
diff 33.26629037352586
epoch 23 train loss: 0.005, val loss: 2755.134, train acc: 1.000, val acc: 0.902
diff 26.942666112773622
epoch 24 train loss: 0.004, val loss: 2782.360, train acc: 1.000, val acc: 0.903
diff 27.225884307261367
epoch 25 train loss: 0.003, val loss: 2811.150, train acc: 1.000, val acc: 0.903
diff 28.78974509274667
epoch 26 train loss: 0.002, val loss: 2839.594, train acc: 1.000, val acc: 0.903
diff 28.44475897540451
epoch 27 train loss: 0.002, val loss: 2873.942, train acc: 1.000, val acc: 0.904
diff 34.34770414281138
epoch 28 train loss: 0.001, val loss: 2910.707, train acc: 1.000, val acc: 0.904
diff 36.765162129416694
epoch 29 train loss: 0.001, val loss: 2943.194, train acc: 1.000, val acc: 0.905
diff 32.48719087186373
epoch 30 train loss: 0.001, val loss: 2982.086, train acc: 1.000, val acc: 0.904
diff 38.89160368875537
Training model M3
epoch 1 train loss: 89.244, val loss: 4559.405, train acc: 0.997, val acc: 0.883
diff inf
epoch 2 train loss: 28.696, val loss: 3186.247, train acc: 0.999, val acc: 0.908
diff 1373.1577773661988
epoch 3 train loss: 58.936, val loss: 6168.211, train acc: 0.997, val acc: 0.835
diff 2981.964069905173
epoch 4 train loss: 0.041, val loss: 5929.652, train acc: 1.000, val acc: 0.846
diff 238.55877295137452
epoch 5 train loss: 0.005, val loss: 5682.660, train acc: 1.000, val acc: 0.853
diff 246.9929236264461
epoch 6 train loss: 0.001, val loss: 5876.097, train acc: 1.000, val acc: 0.854
diff 193.4379020671995
epoch 7 train loss: 0.000, val loss: 5955.009, train acc: 1.000, val acc: 0.854
diff 78.91157632289651
epoch 8 train loss: 0.000, val loss: 6099.870, train acc: 1.000, val acc: 0.852
diff 144.86049410693886
epoch 9 train loss: 0.000, val loss: 6175.169, train acc: 1.000, val acc: 0.852
diff 75.29963669074914
epoch 10 train loss: 0.000, val loss: 6334.162, train acc: 1.000, val acc: 0.849
diff 158.99314529550156
epoch 11 train loss: 0.000, val loss: 6462.616, train acc: 1.000, val acc: 0.849
diff 128.45387672550805
epoch 12 train loss: 0.000, val loss: 6611.430, train acc: 1.000, val acc: 0.847
diff 148.81362814525528
epoch 13 train loss: 0.000, val loss: 6620.849, train acc: 1.000, val acc: 0.848
diff 9.419515973117996
epoch 14 train loss: 0.000, val loss: 6671.152, train acc: 1.000, val acc: 0.849
diff 50.30276019383564
epoch 15 train loss: 0.000, val loss: 6667.603, train acc: 1.000, val acc: 0.850
diff 3.5492134181058645
epoch 16 train loss: 0.000, val loss: 6816.145, train acc: 1.000, val acc: 0.849
diff 148.54184200146028
epoch 17 train loss: 0.000, val loss: 6901.426, train acc: 1.000, val acc: 0.849
diff 85.28164827373439
epoch 18 train loss: 0.000, val loss: 6990.547, train acc: 1.000, val acc: 0.848
diff 89.1203478608686
epoch 19 train loss: 0.000, val loss: 6891.854, train acc: 1.000, val acc: 0.850
diff 98.69289707298594
epoch 20 train loss: 0.000, val loss: 7239.942, train acc: 1.000, val acc: 0.847
diff 348.0883007612056
epoch 21 train loss: 0.000, val loss: 7021.616, train acc: 1.000, val acc: 0.851
diff 218.32644702644575
epoch 22 train loss: 0.000, val loss: 7040.189, train acc: 1.000, val acc: 0.850
diff 18.573045900275247
epoch 23 train loss: 0.000, val loss: 7264.569, train acc: 1.000, val acc: 0.848
diff 224.37977285342095
epoch 24 train loss: 0.000, val loss: 7463.266, train acc: 1.000, val acc: 0.847
diff 198.697801224489
epoch 25 train loss: 0.000, val loss: 7344.395, train acc: 1.000, val acc: 0.848
diff 118.87142111285539
epoch 26 train loss: 0.000, val loss: 7523.682, train acc: 1.000, val acc: 0.847
diff 179.287144872902
epoch 27 train loss: 0.000, val loss: 7537.942, train acc: 1.000, val acc: 0.846
diff 14.259954479814041
epoch 28 train loss: 0.000, val loss: 7412.900, train acc: 1.000, val acc: 0.848
diff 125.04243340933226
epoch 29 train loss: 0.000, val loss: 7636.999, train acc: 1.000, val acc: 0.845
diff 224.09938775638057
epoch 30 train loss: 0.000, val loss: 7593.991, train acc: 1.000, val acc: 0.846
diff 43.0076717889433
Training model M3
epoch 1 train loss: 1027.110, val loss: 677.748, train acc: 0.971, val acc: 0.937
diff inf
epoch 2 train loss: 168.605, val loss: 801.663, train acc: 0.991, val acc: 0.944
diff 123.91496088183362
epoch 3 train loss: 46.828, val loss: 834.446, train acc: 0.997, val acc: 0.948
diff 32.78309118729692
epoch 4 train loss: 7.711, val loss: 882.573, train acc: 1.000, val acc: 0.950
diff 48.12721410677534
epoch 5 train loss: 0.683, val loss: 968.275, train acc: 1.000, val acc: 0.949
diff 85.70183324135257
epoch 6 train loss: 0.265, val loss: 985.188, train acc: 1.000, val acc: 0.949
diff 16.912881630853462
epoch 7 train loss: 0.170, val loss: 1007.956, train acc: 1.000, val acc: 0.949
diff 22.76773643790966
epoch 8 train loss: 0.113, val loss: 1027.922, train acc: 1.000, val acc: 0.949
diff 19.96654921693687
epoch 9 train loss: 0.078, val loss: 1053.932, train acc: 1.000, val acc: 0.949
diff 26.009436470745413
epoch 10 train loss: 0.054, val loss: 1067.355, train acc: 1.000, val acc: 0.950
diff 13.42335900873968
epoch 11 train loss: 0.038, val loss: 1093.212, train acc: 1.000, val acc: 0.950
diff 25.85684351611917
epoch 12 train loss: 0.027, val loss: 1120.256, train acc: 1.000, val acc: 0.949
diff 27.044166268426807
epoch 13 train loss: 0.019, val loss: 1132.126, train acc: 1.000, val acc: 0.951
diff 11.86978634558227
epoch 14 train loss: 0.013, val loss: 1158.566, train acc: 1.000, val acc: 0.950
diff 26.439983669103412
epoch 15 train loss: 0.009, val loss: 1207.563, train acc: 1.000, val acc: 0.950
diff 48.997346166085435
epoch 16 train loss: 0.005, val loss: 1210.387, train acc: 1.000, val acc: 0.950
diff 2.823620198945946
epoch 17 train loss: 0.003, val loss: 1210.901, train acc: 1.000, val acc: 0.951
diff 0.5138204319316628
epoch 18 train loss: 0.002, val loss: 1283.819, train acc: 1.000, val acc: 0.951
diff 72.91796808972708
epoch 19 train loss: 0.001, val loss: 1304.617, train acc: 1.000, val acc: 0.950
diff 20.798116449275994
epoch 20 train loss: 0.001, val loss: 1374.209, train acc: 1.000, val acc: 0.948
diff 69.59172593372068
epoch 21 train loss: 0.000, val loss: 1428.387, train acc: 1.000, val acc: 0.946
diff 54.17841683059601
epoch 22 train loss: 0.000, val loss: 1449.271, train acc: 1.000, val acc: 0.946
diff 20.884146489663635
epoch 23 train loss: 0.000, val loss: 1482.804, train acc: 1.000, val acc: 0.945
diff 33.53274719715296
epoch 24 train loss: 0.000, val loss: 1512.374, train acc: 1.000, val acc: 0.946
diff 29.569932570215315
epoch 25 train loss: 0.000, val loss: 1575.599, train acc: 1.000, val acc: 0.944
diff 63.22561861684858
epoch 26 train loss: 0.000, val loss: 1618.537, train acc: 1.000, val acc: 0.943
diff 42.937304932301686
epoch 27 train loss: 0.000, val loss: 1640.571, train acc: 1.000, val acc: 0.943
diff 22.034687260755618
epoch 28 train loss: 0.000, val loss: 1661.314, train acc: 1.000, val acc: 0.943
diff 20.742859873455473
epoch 29 train loss: 0.000, val loss: 1691.836, train acc: 1.000, val acc: 0.942
diff 30.521533055451073
epoch 30 train loss: 0.000, val loss: 1707.174, train acc: 1.000, val acc: 0.941
diff 15.337972563798985
2
