Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 15, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2413.414, val loss: 138.278, train acc: 0.966, val acc: 0.983
diff inf
epoch 2 train loss: 822.966, val loss: 168.928, train acc: 0.988, val acc: 0.978
diff 30.650142545466707
epoch 3 train loss: 496.008, val loss: 96.839, train acc: 0.993, val acc: 0.990
diff 72.0883672285189
epoch 4 train loss: 353.827, val loss: 84.080, train acc: 0.995, val acc: 0.990
diff 12.759618456600037
epoch 5 train loss: 247.598, val loss: 172.413, train acc: 0.997, val acc: 0.988
diff 88.33359130418353
epoch 6 train loss: 245.380, val loss: 122.020, train acc: 0.997, val acc: 0.988
diff 50.39343105566729
epoch 7 train loss: 239.703, val loss: 144.625, train acc: 0.997, val acc: 0.990
diff 22.605301395202076
epoch 8 train loss: 184.916, val loss: 236.300, train acc: 0.998, val acc: 0.987
diff 91.67499221417833
epoch 9 train loss: 196.773, val loss: 194.596, train acc: 0.998, val acc: 0.991
diff 41.70438848329326
epoch 10 train loss: 181.768, val loss: 228.145, train acc: 0.998, val acc: 0.988
diff 33.54874924706289
epoch 11 train loss: 171.724, val loss: 158.925, train acc: 0.998, val acc: 0.993
diff 69.21957754808372
epoch 12 train loss: 160.044, val loss: 161.910, train acc: 0.999, val acc: 0.992
diff 2.984899291273422
epoch 13 train loss: 173.139, val loss: 291.007, train acc: 0.999, val acc: 0.990
diff 129.09709862094593
epoch 14 train loss: 142.520, val loss: 299.128, train acc: 0.999, val acc: 0.986
diff 8.12077058831403
epoch 15 train loss: 17.561, val loss: 213.870, train acc: 1.000, val acc: 0.989
diff 85.2580804443034
epoch 16 train loss: 236.904, val loss: 473.226, train acc: 0.998, val acc: 0.985
diff 259.3566056171841
epoch 17 train loss: 169.651, val loss: 294.963, train acc: 0.998, val acc: 0.987
diff 178.26290422477626
epoch 18 train loss: 90.157, val loss: 221.294, train acc: 0.999, val acc: 0.990
diff 73.66912877584772
epoch 19 train loss: 91.318, val loss: 433.548, train acc: 0.999, val acc: 0.988
diff 212.2536401707346
epoch 20 train loss: 185.251, val loss: 262.130, train acc: 0.999, val acc: 0.993
diff 171.41815539445838
epoch 21 train loss: 81.713, val loss: 190.018, train acc: 0.999, val acc: 0.991
diff 72.11131901635258
epoch 22 train loss: 186.325, val loss: 355.471, train acc: 0.999, val acc: 0.988
diff 165.45220830255835
epoch 23 train loss: 43.230, val loss: 209.267, train acc: 1.000, val acc: 0.993
diff 146.20312245165394
epoch 24 train loss: 123.749, val loss: 515.469, train acc: 0.999, val acc: 0.988
diff 306.2017989133377
epoch 25 train loss: 97.175, val loss: 270.078, train acc: 0.999, val acc: 0.992
diff 245.39130304581073
epoch 26 train loss: 186.057, val loss: 299.145, train acc: 0.999, val acc: 0.992
diff 29.067038485742557
epoch 27 train loss: 106.134, val loss: 362.722, train acc: 0.999, val acc: 0.991
diff 63.577127899375114
epoch 28 train loss: 134.455, val loss: 367.145, train acc: 0.999, val acc: 0.990
diff 4.423056700004736
epoch 29 train loss: 125.704, val loss: 294.562, train acc: 0.999, val acc: 0.992
diff 72.58307339509412
epoch 30 train loss: 132.517, val loss: 426.109, train acc: 0.999, val acc: 0.991
diff 131.54656605166684
Training model M2
epoch 1 train loss: 3969.648, val loss: 251.834, train acc: 0.954, val acc: 0.974
diff inf
epoch 2 train loss: 1314.953, val loss: 166.826, train acc: 0.985, val acc: 0.983
diff 85.00740012580326
epoch 3 train loss: 789.196, val loss: 201.495, train acc: 0.990, val acc: 0.983
diff 34.66873390586275
epoch 4 train loss: 586.246, val loss: 204.629, train acc: 0.993, val acc: 0.986
diff 3.133730719635764
epoch 5 train loss: 392.897, val loss: 195.053, train acc: 0.995, val acc: 0.984
diff 9.576091366088889
epoch 6 train loss: 408.937, val loss: 346.949, train acc: 0.995, val acc: 0.982
diff 151.89677277013644
epoch 7 train loss: 334.231, val loss: 286.282, train acc: 0.996, val acc: 0.984
diff 60.667743898800495
epoch 8 train loss: 298.194, val loss: 223.441, train acc: 0.997, val acc: 0.987
diff 62.840951509284366
epoch 9 train loss: 329.696, val loss: 250.698, train acc: 0.997, val acc: 0.986
diff 27.257380574726113
epoch 10 train loss: 232.124, val loss: 372.397, train acc: 0.998, val acc: 0.985
diff 121.69878566468438
epoch 11 train loss: 268.079, val loss: 302.388, train acc: 0.998, val acc: 0.986
diff 70.00900492111435
epoch 12 train loss: 279.758, val loss: 493.380, train acc: 0.997, val acc: 0.980
diff 190.9923664434104
epoch 13 train loss: 253.115, val loss: 370.878, train acc: 0.998, val acc: 0.981
diff 122.50180858640033
epoch 14 train loss: 252.933, val loss: 444.958, train acc: 0.998, val acc: 0.985
diff 74.07919293811722
epoch 15 train loss: 258.323, val loss: 297.246, train acc: 0.998, val acc: 0.987
diff 147.7115650866117
epoch 16 train loss: 181.135, val loss: 449.082, train acc: 0.998, val acc: 0.985
diff 151.83629342589785
epoch 17 train loss: 217.777, val loss: 470.425, train acc: 0.998, val acc: 0.989
diff 21.342776239337354
epoch 18 train loss: 178.403, val loss: 429.914, train acc: 0.998, val acc: 0.987
diff 40.510969716840634
epoch 19 train loss: 236.108, val loss: 543.950, train acc: 0.998, val acc: 0.984
diff 114.0357655576936
epoch 20 train loss: 220.671, val loss: 570.537, train acc: 0.998, val acc: 0.988
diff 26.586912249123998
epoch 21 train loss: 325.010, val loss: 646.382, train acc: 0.998, val acc: 0.982
diff 75.84511204996272
epoch 22 train loss: 274.772, val loss: 510.668, train acc: 0.999, val acc: 0.987
diff 135.71391344085345
epoch 23 train loss: 219.419, val loss: 542.476, train acc: 0.998, val acc: 0.988
diff 31.807868723433046
epoch 24 train loss: 101.946, val loss: 695.804, train acc: 0.999, val acc: 0.988
diff 153.32783188901533
epoch 25 train loss: 231.933, val loss: 740.897, train acc: 0.999, val acc: 0.986
diff 45.09300632016709
epoch 26 train loss: 144.754, val loss: 966.384, train acc: 0.999, val acc: 0.987
diff 225.48748985526447
epoch 27 train loss: 314.112, val loss: 846.282, train acc: 0.999, val acc: 0.986
diff 120.10267595422977
epoch 28 train loss: 297.952, val loss: 639.903, train acc: 0.999, val acc: 0.989
diff 206.37881007163935
epoch 29 train loss: 400.054, val loss: 1160.100, train acc: 0.998, val acc: 0.985
diff 520.1971541565168
epoch 30 train loss: 281.656, val loss: 927.446, train acc: 0.999, val acc: 0.984
diff 232.65404277020843
Training model M3
epoch 1 train loss: 1637.920, val loss: 942.920, train acc: 0.927, val acc: 0.899
diff inf
epoch 2 train loss: 431.951, val loss: 736.277, train acc: 0.980, val acc: 0.933
diff 206.64336293327494
epoch 3 train loss: 223.762, val loss: 683.358, train acc: 0.989, val acc: 0.938
diff 52.91874177770819
epoch 4 train loss: 157.222, val loss: 870.227, train acc: 0.992, val acc: 0.940
diff 186.86933197366432
epoch 5 train loss: 128.732, val loss: 937.715, train acc: 0.994, val acc: 0.936
diff 67.4880819037786
epoch 6 train loss: 130.597, val loss: 813.631, train acc: 0.995, val acc: 0.933
diff 124.08389920349862
epoch 7 train loss: 42.464, val loss: 790.611, train acc: 0.998, val acc: 0.950
diff 23.020306611895762
epoch 8 train loss: 77.701, val loss: 1090.907, train acc: 0.998, val acc: 0.935
diff 300.29563819330417
epoch 9 train loss: 57.099, val loss: 1165.503, train acc: 0.997, val acc: 0.940
diff 74.59631690650576
epoch 10 train loss: 196.896, val loss: 841.934, train acc: 0.993, val acc: 0.944
diff 323.56899388261036
epoch 11 train loss: 34.548, val loss: 1129.332, train acc: 0.998, val acc: 0.943
diff 287.3982876524128
epoch 12 train loss: 70.902, val loss: 1598.479, train acc: 0.997, val acc: 0.926
diff 469.14701673595323
epoch 13 train loss: 64.775, val loss: 1010.762, train acc: 0.997, val acc: 0.950
diff 587.7174703751435
epoch 14 train loss: 90.487, val loss: 1112.023, train acc: 0.996, val acc: 0.942
diff 101.26109649938041
epoch 15 train loss: 29.907, val loss: 1504.839, train acc: 0.998, val acc: 0.932
diff 392.8163786090129
epoch 16 train loss: 6.958, val loss: 1946.825, train acc: 1.000, val acc: 0.927
diff 441.98608438483484
epoch 17 train loss: 97.663, val loss: 1318.921, train acc: 0.997, val acc: 0.939
diff 627.9044335010635
epoch 18 train loss: 56.108, val loss: 1094.740, train acc: 0.998, val acc: 0.950
diff 224.18112130166674
epoch 19 train loss: 52.015, val loss: 1067.476, train acc: 0.998, val acc: 0.950
diff 27.264347163611546
epoch 20 train loss: 84.386, val loss: 1221.905, train acc: 0.997, val acc: 0.944
diff 154.42994770840392
epoch 21 train loss: 36.228, val loss: 1466.614, train acc: 0.998, val acc: 0.941
diff 244.70901439052864
epoch 22 train loss: 1.861, val loss: 1243.543, train acc: 1.000, val acc: 0.949
diff 223.0716525970886
epoch 23 train loss: 0.131, val loss: 1301.407, train acc: 1.000, val acc: 0.949
diff 57.8642065013571
epoch 24 train loss: 0.041, val loss: 1302.579, train acc: 1.000, val acc: 0.949
diff 1.171622522819007
epoch 25 train loss: 0.029, val loss: 1307.283, train acc: 1.000, val acc: 0.950
diff 4.704443373223057
epoch 26 train loss: 0.021, val loss: 1313.181, train acc: 1.000, val acc: 0.949
diff 5.897833823264136
epoch 27 train loss: 0.016, val loss: 1320.930, train acc: 1.000, val acc: 0.950
diff 7.749094473340392
epoch 28 train loss: 0.012, val loss: 1328.275, train acc: 1.000, val acc: 0.950
diff 7.344777307773484
epoch 29 train loss: 0.009, val loss: 1338.646, train acc: 1.000, val acc: 0.951
diff 10.371258046154253
epoch 30 train loss: 0.007, val loss: 1349.562, train acc: 1.000, val acc: 0.951
diff 10.916259951728534
Training model M3
epoch 1 train loss: 25.808, val loss: 2660.323, train acc: 0.999, val acc: 0.936
diff inf
epoch 2 train loss: 0.004, val loss: 2993.579, train acc: 1.000, val acc: 0.934
diff 333.25598077056793
epoch 3 train loss: 0.000, val loss: 3020.001, train acc: 1.000, val acc: 0.934
diff 26.421788457691036
epoch 4 train loss: 0.000, val loss: 3025.495, train acc: 1.000, val acc: 0.933
diff 5.4937801373339425
epoch 5 train loss: 0.000, val loss: 3022.911, train acc: 1.000, val acc: 0.933
diff 2.5834688482627826
epoch 6 train loss: 0.000, val loss: 3030.843, train acc: 1.000, val acc: 0.933
diff 7.931943110143948
epoch 7 train loss: 0.000, val loss: 3041.361, train acc: 1.000, val acc: 0.933
diff 10.517997498560817
epoch 8 train loss: 0.000, val loss: 3047.899, train acc: 1.000, val acc: 0.933
diff 6.537577045148282
epoch 9 train loss: 0.000, val loss: 3058.375, train acc: 1.000, val acc: 0.934
diff 10.476394171349057
epoch 10 train loss: 0.000, val loss: 3062.929, train acc: 1.000, val acc: 0.934
diff 4.553662993911075
epoch 11 train loss: 0.000, val loss: 3081.001, train acc: 1.000, val acc: 0.934
diff 18.071496219507935
epoch 12 train loss: 0.000, val loss: 3091.741, train acc: 1.000, val acc: 0.934
diff 10.740430561995709
epoch 13 train loss: 0.000, val loss: 3106.114, train acc: 1.000, val acc: 0.933
diff 14.373376567442847
epoch 14 train loss: 0.000, val loss: 3100.200, train acc: 1.000, val acc: 0.933
diff 5.914214077881752
epoch 15 train loss: 0.000, val loss: 3121.900, train acc: 1.000, val acc: 0.932
diff 21.700284521935828
epoch 16 train loss: 0.000, val loss: 3133.644, train acc: 1.000, val acc: 0.932
diff 11.74390005979103
epoch 17 train loss: 0.000, val loss: 3151.415, train acc: 1.000, val acc: 0.932
diff 17.77062251733969
epoch 18 train loss: 0.000, val loss: 3164.495, train acc: 1.000, val acc: 0.932
diff 13.080115329639284
epoch 19 train loss: 0.000, val loss: 3178.474, train acc: 1.000, val acc: 0.931
diff 13.978916956634748
epoch 20 train loss: 0.000, val loss: 3188.212, train acc: 1.000, val acc: 0.931
diff 9.737802097698477
epoch 21 train loss: 0.000, val loss: 3211.878, train acc: 1.000, val acc: 0.931
diff 23.666245558633364
epoch 22 train loss: 0.000, val loss: 3223.464, train acc: 1.000, val acc: 0.931
diff 11.58630945085406
epoch 23 train loss: 0.000, val loss: 3237.652, train acc: 1.000, val acc: 0.931
diff 14.187460566034133
epoch 24 train loss: 0.000, val loss: 3245.316, train acc: 1.000, val acc: 0.931
diff 7.664421724563908
epoch 25 train loss: 0.000, val loss: 3268.165, train acc: 1.000, val acc: 0.931
diff 22.848618074324804
epoch 26 train loss: 0.000, val loss: 3294.067, train acc: 1.000, val acc: 0.930
diff 25.901887327745044
epoch 27 train loss: 0.000, val loss: 3283.674, train acc: 1.000, val acc: 0.930
diff 10.392751300989858
epoch 28 train loss: 0.000, val loss: 3306.506, train acc: 1.000, val acc: 0.930
diff 22.83205460371073
epoch 29 train loss: 0.000, val loss: 3326.038, train acc: 1.000, val acc: 0.930
diff 19.531752912750107
epoch 30 train loss: 0.000, val loss: 3326.119, train acc: 1.000, val acc: 0.930
diff 0.08145422929055712
Training model M3
epoch 1 train loss: 1343.521, val loss: 334.888, train acc: 0.967, val acc: 0.971
diff inf
epoch 2 train loss: 286.877, val loss: 380.959, train acc: 0.989, val acc: 0.970
diff 46.07123580304153
epoch 3 train loss: 97.794, val loss: 589.110, train acc: 0.995, val acc: 0.958
diff 208.15132035995845
epoch 4 train loss: 30.773, val loss: 411.791, train acc: 0.998, val acc: 0.972
diff 177.3199442984082
epoch 5 train loss: 27.880, val loss: 511.918, train acc: 0.999, val acc: 0.971
diff 100.1271443959136
epoch 6 train loss: 101.675, val loss: 852.802, train acc: 0.995, val acc: 0.964
diff 340.88422283611976
epoch 7 train loss: 45.754, val loss: 737.077, train acc: 0.998, val acc: 0.964
diff 115.72484442920427
epoch 8 train loss: 13.917, val loss: 764.961, train acc: 1.000, val acc: 0.968
diff 27.88414027915894
epoch 9 train loss: 156.459, val loss: 941.131, train acc: 0.993, val acc: 0.951
diff 176.16957823829478
epoch 10 train loss: 46.865, val loss: 1258.368, train acc: 0.997, val acc: 0.941
diff 317.23699215521606
epoch 11 train loss: 9.384, val loss: 909.080, train acc: 0.999, val acc: 0.956
diff 349.28776244907783
epoch 12 train loss: 32.754, val loss: 1092.519, train acc: 0.999, val acc: 0.952
diff 183.438969775464
epoch 13 train loss: 111.022, val loss: 986.965, train acc: 0.996, val acc: 0.951
diff 105.5535427993077
epoch 14 train loss: 25.879, val loss: 917.791, train acc: 0.998, val acc: 0.959
diff 69.17417385910528
epoch 15 train loss: 0.550, val loss: 899.584, train acc: 1.000, val acc: 0.962
diff 18.206951097358683
epoch 16 train loss: 0.090, val loss: 889.205, train acc: 1.000, val acc: 0.962
diff 10.379492657335845
epoch 17 train loss: 0.041, val loss: 891.709, train acc: 1.000, val acc: 0.963
diff 2.503771932599534
epoch 18 train loss: 0.030, val loss: 894.869, train acc: 1.000, val acc: 0.963
diff 3.160156266142735
epoch 19 train loss: 0.022, val loss: 899.282, train acc: 1.000, val acc: 0.964
diff 4.413278428969306
epoch 20 train loss: 0.016, val loss: 903.424, train acc: 1.000, val acc: 0.963
diff 4.141684577091269
epoch 21 train loss: 0.013, val loss: 907.844, train acc: 1.000, val acc: 0.963
diff 4.419944439072879
epoch 22 train loss: 0.009, val loss: 912.923, train acc: 1.000, val acc: 0.963
diff 5.079453807827463
epoch 23 train loss: 0.007, val loss: 917.952, train acc: 1.000, val acc: 0.964
diff 5.029260999469898
epoch 24 train loss: 0.005, val loss: 923.735, train acc: 1.000, val acc: 0.964
diff 5.7823308869873244
epoch 25 train loss: 0.004, val loss: 930.550, train acc: 1.000, val acc: 0.964
diff 6.814980744070795
epoch 26 train loss: 0.003, val loss: 936.698, train acc: 1.000, val acc: 0.964
diff 6.148092810832395
epoch 27 train loss: 0.002, val loss: 943.613, train acc: 1.000, val acc: 0.964
diff 6.915567722411083
epoch 28 train loss: 0.002, val loss: 950.718, train acc: 1.000, val acc: 0.965
diff 7.105128649862081
epoch 29 train loss: 0.001, val loss: 958.692, train acc: 1.000, val acc: 0.965
diff 7.973931296007095
epoch 30 train loss: 0.001, val loss: 966.300, train acc: 1.000, val acc: 0.966
diff 7.607474255209922
2
2
2
2
