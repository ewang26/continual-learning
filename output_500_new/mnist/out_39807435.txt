Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 9, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2375.029, val loss: 138.704, train acc: 0.967, val acc: 0.982
diff inf
epoch 2 train loss: 826.414, val loss: 159.223, train acc: 0.988, val acc: 0.983
diff 20.51854529771046
epoch 3 train loss: 476.192, val loss: 181.283, train acc: 0.993, val acc: 0.982
diff 22.06038946385422
epoch 4 train loss: 403.096, val loss: 143.854, train acc: 0.994, val acc: 0.988
diff 37.42907231395472
epoch 5 train loss: 267.477, val loss: 155.813, train acc: 0.996, val acc: 0.990
diff 11.95892618053287
epoch 6 train loss: 235.469, val loss: 159.500, train acc: 0.996, val acc: 0.988
diff 3.686994679522428
epoch 7 train loss: 218.976, val loss: 185.012, train acc: 0.997, val acc: 0.986
diff 25.511786921491193
epoch 8 train loss: 235.112, val loss: 220.786, train acc: 0.997, val acc: 0.988
diff 35.774041870466846
epoch 9 train loss: 123.328, val loss: 233.821, train acc: 0.999, val acc: 0.986
diff 13.034866494772075
epoch 10 train loss: 258.529, val loss: 217.240, train acc: 0.996, val acc: 0.993
diff 16.58102190631658
epoch 11 train loss: 135.284, val loss: 162.766, train acc: 0.998, val acc: 0.992
diff 54.47384355050937
epoch 12 train loss: 156.794, val loss: 211.965, train acc: 0.999, val acc: 0.990
diff 49.199610194078105
epoch 13 train loss: 248.914, val loss: 188.160, train acc: 0.998, val acc: 0.990
diff 23.80581261161811
epoch 14 train loss: 177.826, val loss: 195.820, train acc: 0.998, val acc: 0.990
diff 7.660545878070764
epoch 15 train loss: 124.259, val loss: 195.112, train acc: 0.998, val acc: 0.991
diff 0.7077481230707292
epoch 16 train loss: 164.816, val loss: 288.953, train acc: 0.998, val acc: 0.987
diff 93.84088580894979
epoch 17 train loss: 74.472, val loss: 184.942, train acc: 0.999, val acc: 0.993
diff 104.01113880634435
epoch 18 train loss: 123.927, val loss: 354.686, train acc: 0.999, val acc: 0.989
diff 169.7440323046608
epoch 19 train loss: 143.935, val loss: 219.241, train acc: 0.999, val acc: 0.995
diff 135.44525188543923
epoch 20 train loss: 104.376, val loss: 405.343, train acc: 0.999, val acc: 0.991
diff 186.10209955451307
epoch 21 train loss: 216.774, val loss: 306.745, train acc: 0.998, val acc: 0.994
diff 98.59762868791938
epoch 22 train loss: 139.510, val loss: 376.415, train acc: 0.999, val acc: 0.991
diff 69.66922882475927
epoch 23 train loss: 131.638, val loss: 266.519, train acc: 0.999, val acc: 0.993
diff 109.89536043003972
epoch 24 train loss: 104.688, val loss: 383.902, train acc: 0.999, val acc: 0.991
diff 117.38275959300603
epoch 25 train loss: 269.329, val loss: 268.112, train acc: 0.999, val acc: 0.993
diff 115.7904258576715
epoch 26 train loss: 118.879, val loss: 341.262, train acc: 0.999, val acc: 0.993
diff 73.1509329846948
epoch 27 train loss: 81.369, val loss: 432.548, train acc: 0.999, val acc: 0.989
diff 91.28545296011526
epoch 28 train loss: 99.663, val loss: 423.225, train acc: 0.999, val acc: 0.990
diff 9.322826687325858
epoch 29 train loss: 172.725, val loss: 425.535, train acc: 0.999, val acc: 0.993
diff 2.3100934790859355
epoch 30 train loss: 128.641, val loss: 617.598, train acc: 0.999, val acc: 0.987
diff 192.06284715595172
Training model M2
epoch 1 train loss: 3788.547, val loss: 203.555, train acc: 0.957, val acc: 0.982
diff inf
epoch 2 train loss: 1285.835, val loss: 177.967, train acc: 0.984, val acc: 0.985
diff 25.588036878129856
epoch 3 train loss: 839.074, val loss: 228.587, train acc: 0.991, val acc: 0.980
diff 50.61982140476633
epoch 4 train loss: 591.743, val loss: 229.800, train acc: 0.994, val acc: 0.980
diff 1.2131558457793972
epoch 5 train loss: 509.539, val loss: 168.226, train acc: 0.994, val acc: 0.984
diff 61.57481430894316
epoch 6 train loss: 261.757, val loss: 231.108, train acc: 0.997, val acc: 0.984
diff 62.88197657744891
epoch 7 train loss: 400.022, val loss: 339.465, train acc: 0.995, val acc: 0.983
diff 108.35787727794684
epoch 8 train loss: 314.077, val loss: 330.375, train acc: 0.997, val acc: 0.982
diff 9.090057577397204
epoch 9 train loss: 220.378, val loss: 270.965, train acc: 0.998, val acc: 0.987
diff 59.41022048745248
epoch 10 train loss: 321.453, val loss: 233.157, train acc: 0.997, val acc: 0.987
diff 37.808513932499324
epoch 11 train loss: 246.798, val loss: 544.422, train acc: 0.998, val acc: 0.974
diff 311.26539860529624
epoch 12 train loss: 249.298, val loss: 322.591, train acc: 0.998, val acc: 0.985
diff 221.8311223386841
epoch 13 train loss: 288.411, val loss: 297.249, train acc: 0.998, val acc: 0.988
diff 25.34228499294244
epoch 14 train loss: 181.594, val loss: 298.584, train acc: 0.998, val acc: 0.987
diff 1.3351907766265754
epoch 15 train loss: 281.946, val loss: 368.198, train acc: 0.998, val acc: 0.984
diff 69.6146450045577
epoch 16 train loss: 174.551, val loss: 371.196, train acc: 0.999, val acc: 0.988
diff 2.9971460111373744
epoch 17 train loss: 299.500, val loss: 390.810, train acc: 0.998, val acc: 0.987
diff 19.61469474493026
epoch 18 train loss: 251.278, val loss: 434.677, train acc: 0.998, val acc: 0.987
diff 43.866981551750655
epoch 19 train loss: 198.342, val loss: 413.776, train acc: 0.999, val acc: 0.986
diff 20.900882789079503
epoch 20 train loss: 227.195, val loss: 658.658, train acc: 0.999, val acc: 0.985
diff 244.88158236426818
epoch 21 train loss: 165.095, val loss: 722.638, train acc: 0.999, val acc: 0.985
diff 63.97983823817708
epoch 22 train loss: 183.133, val loss: 571.681, train acc: 0.999, val acc: 0.989
diff 150.95635467050954
epoch 23 train loss: 322.139, val loss: 895.984, train acc: 0.998, val acc: 0.980
diff 324.3026250505578
epoch 24 train loss: 128.022, val loss: 517.302, train acc: 0.999, val acc: 0.988
diff 378.6818781141868
epoch 25 train loss: 250.596, val loss: 772.198, train acc: 0.999, val acc: 0.987
diff 254.896028774068
epoch 26 train loss: 106.256, val loss: 850.553, train acc: 0.999, val acc: 0.985
diff 78.35433659206763
epoch 27 train loss: 368.495, val loss: 810.203, train acc: 0.998, val acc: 0.985
diff 40.34974093513074
epoch 28 train loss: 240.319, val loss: 733.729, train acc: 0.999, val acc: 0.986
diff 76.47399107731906
epoch 29 train loss: 194.858, val loss: 646.435, train acc: 0.999, val acc: 0.988
diff 87.29366645500045
epoch 30 train loss: 312.071, val loss: 623.427, train acc: 0.998, val acc: 0.988
diff 23.00778711405212
Training model M3
epoch 1 train loss: 1851.447, val loss: 554.752, train acc: 0.928, val acc: 0.947
diff inf
epoch 2 train loss: 486.140, val loss: 409.037, train acc: 0.979, val acc: 0.963
diff 145.71502231741863
epoch 3 train loss: 280.558, val loss: 865.669, train acc: 0.989, val acc: 0.936
diff 456.63285926394747
epoch 4 train loss: 240.031, val loss: 656.435, train acc: 0.989, val acc: 0.950
diff 209.23478730517763
epoch 5 train loss: 101.331, val loss: 837.532, train acc: 0.996, val acc: 0.939
diff 181.09741011714902
epoch 6 train loss: 168.252, val loss: 1064.584, train acc: 0.993, val acc: 0.932
diff 227.05217875288508
epoch 7 train loss: 176.487, val loss: 705.467, train acc: 0.992, val acc: 0.950
diff 359.11707683677173
epoch 8 train loss: 95.904, val loss: 497.584, train acc: 0.996, val acc: 0.967
diff 207.88289785743785
epoch 9 train loss: 43.293, val loss: 564.208, train acc: 0.998, val acc: 0.963
diff 66.62363473254408
epoch 10 train loss: 5.404, val loss: 585.924, train acc: 1.000, val acc: 0.970
diff 21.715756218321417
epoch 11 train loss: 0.494, val loss: 611.649, train acc: 1.000, val acc: 0.970
diff 25.725388082756467
epoch 12 train loss: 0.075, val loss: 617.580, train acc: 1.000, val acc: 0.971
diff 5.9310769969802095
epoch 13 train loss: 0.048, val loss: 626.583, train acc: 1.000, val acc: 0.971
diff 9.002649261340139
epoch 14 train loss: 0.034, val loss: 635.240, train acc: 1.000, val acc: 0.972
diff 8.657163055769047
epoch 15 train loss: 0.023, val loss: 645.527, train acc: 1.000, val acc: 0.972
diff 10.28680197038625
epoch 16 train loss: 0.016, val loss: 655.043, train acc: 1.000, val acc: 0.972
diff 9.51604975555722
epoch 17 train loss: 0.011, val loss: 668.210, train acc: 1.000, val acc: 0.972
diff 13.167309589948104
epoch 18 train loss: 0.008, val loss: 678.906, train acc: 1.000, val acc: 0.972
diff 10.695969213616536
epoch 19 train loss: 0.005, val loss: 689.662, train acc: 1.000, val acc: 0.972
diff 10.755537752049236
epoch 20 train loss: 0.003, val loss: 703.834, train acc: 1.000, val acc: 0.972
diff 14.172339389798026
epoch 21 train loss: 0.002, val loss: 716.284, train acc: 1.000, val acc: 0.972
diff 12.450136903643397
epoch 22 train loss: 0.002, val loss: 727.621, train acc: 1.000, val acc: 0.972
diff 11.337064898523977
epoch 23 train loss: 0.001, val loss: 741.519, train acc: 1.000, val acc: 0.973
diff 13.897954639088312
epoch 24 train loss: 0.001, val loss: 754.138, train acc: 1.000, val acc: 0.973
diff 12.619194369029401
epoch 25 train loss: 0.000, val loss: 766.387, train acc: 1.000, val acc: 0.973
diff 12.248647797203034
epoch 26 train loss: 0.000, val loss: 779.938, train acc: 1.000, val acc: 0.973
diff 13.551460560858118
epoch 27 train loss: 0.000, val loss: 793.373, train acc: 1.000, val acc: 0.973
diff 13.434081106718054
epoch 28 train loss: 0.000, val loss: 809.122, train acc: 1.000, val acc: 0.973
diff 15.74983626321648
epoch 29 train loss: 0.000, val loss: 828.240, train acc: 1.000, val acc: 0.974
diff 19.117455866495447
epoch 30 train loss: 0.000, val loss: 860.595, train acc: 1.000, val acc: 0.975
diff 32.35515184464805
Training model M3
epoch 1 train loss: 127.904, val loss: 1281.227, train acc: 0.997, val acc: 0.957
diff inf
epoch 2 train loss: 42.164, val loss: 1908.676, train acc: 0.999, val acc: 0.939
diff 627.4488296397233
epoch 3 train loss: 0.624, val loss: 2247.210, train acc: 1.000, val acc: 0.933
diff 338.53383825638
epoch 4 train loss: 127.475, val loss: 1712.292, train acc: 0.998, val acc: 0.927
diff 534.9176408644496
epoch 5 train loss: 95.807, val loss: 3024.381, train acc: 0.997, val acc: 0.892
diff 1312.0888223106465
epoch 6 train loss: 31.521, val loss: 2081.518, train acc: 0.999, val acc: 0.922
diff 942.8631074966697
epoch 7 train loss: 36.191, val loss: 1739.506, train acc: 0.999, val acc: 0.932
diff 342.01205843513276
epoch 8 train loss: 3.693, val loss: 2252.970, train acc: 1.000, val acc: 0.919
diff 513.4642246589085
epoch 9 train loss: 9.813, val loss: 1359.425, train acc: 1.000, val acc: 0.945
diff 893.5449960273706
epoch 10 train loss: 0.041, val loss: 1456.026, train acc: 1.000, val acc: 0.944
diff 96.60104036113057
epoch 11 train loss: 0.011, val loss: 1500.738, train acc: 1.000, val acc: 0.943
diff 44.71205945306747
epoch 12 train loss: 0.007, val loss: 1547.632, train acc: 1.000, val acc: 0.942
diff 46.893753935879204
epoch 13 train loss: 0.005, val loss: 1591.427, train acc: 1.000, val acc: 0.940
diff 43.794753036177326
epoch 14 train loss: 0.004, val loss: 1634.021, train acc: 1.000, val acc: 0.938
diff 42.594529433738444
epoch 15 train loss: 0.003, val loss: 1681.777, train acc: 1.000, val acc: 0.938
diff 47.75534348550423
epoch 16 train loss: 0.002, val loss: 1722.721, train acc: 1.000, val acc: 0.937
diff 40.94461187509978
epoch 17 train loss: 0.001, val loss: 1778.656, train acc: 1.000, val acc: 0.936
diff 55.93503268985728
epoch 18 train loss: 0.001, val loss: 1823.750, train acc: 1.000, val acc: 0.935
diff 45.09404177828128
epoch 19 train loss: 0.001, val loss: 1866.722, train acc: 1.000, val acc: 0.935
diff 42.97210685201776
epoch 20 train loss: 0.000, val loss: 1912.420, train acc: 1.000, val acc: 0.934
diff 45.697709539045036
epoch 21 train loss: 0.000, val loss: 1955.009, train acc: 1.000, val acc: 0.933
diff 42.588968560316744
epoch 22 train loss: 0.000, val loss: 2007.485, train acc: 1.000, val acc: 0.932
diff 52.47606490866747
epoch 23 train loss: 0.000, val loss: 2051.778, train acc: 1.000, val acc: 0.932
diff 44.29253248100326
epoch 24 train loss: 0.000, val loss: 2089.211, train acc: 1.000, val acc: 0.933
diff 37.43301940529727
epoch 25 train loss: 0.000, val loss: 2124.721, train acc: 1.000, val acc: 0.932
diff 35.51017246142055
epoch 26 train loss: 0.000, val loss: 2171.935, train acc: 1.000, val acc: 0.933
diff 47.214535212902774
epoch 27 train loss: 0.000, val loss: 2203.810, train acc: 1.000, val acc: 0.932
diff 31.87470952837384
epoch 28 train loss: 0.000, val loss: 2247.347, train acc: 1.000, val acc: 0.932
diff 43.53649424512014
epoch 29 train loss: 0.000, val loss: 2292.268, train acc: 1.000, val acc: 0.932
diff 44.9210979760046
epoch 30 train loss: 0.000, val loss: 2326.403, train acc: 1.000, val acc: 0.932
diff 34.134899642735036
Training model M3
epoch 1 train loss: 1329.064, val loss: 211.473, train acc: 0.961, val acc: 0.979
diff inf
epoch 2 train loss: 283.599, val loss: 181.540, train acc: 0.989, val acc: 0.983
diff 29.932218825902766
epoch 3 train loss: 72.703, val loss: 280.057, train acc: 0.998, val acc: 0.979
diff 98.51630560584144
epoch 4 train loss: 13.403, val loss: 318.169, train acc: 0.999, val acc: 0.982
diff 38.111891428403055
epoch 5 train loss: 157.097, val loss: 527.563, train acc: 0.993, val acc: 0.970
diff 209.39481158726244
epoch 6 train loss: 153.157, val loss: 374.558, train acc: 0.994, val acc: 0.981
diff 153.0055228985633
epoch 7 train loss: 94.239, val loss: 501.382, train acc: 0.997, val acc: 0.975
diff 126.8240254492311
epoch 8 train loss: 84.893, val loss: 428.670, train acc: 0.997, val acc: 0.976
diff 72.71171428965079
epoch 9 train loss: 82.390, val loss: 686.553, train acc: 0.996, val acc: 0.971
diff 257.8830033141364
epoch 10 train loss: 48.890, val loss: 487.945, train acc: 0.999, val acc: 0.979
diff 198.60846083611392
epoch 11 train loss: 172.425, val loss: 492.864, train acc: 0.994, val acc: 0.973
diff 4.9194576932948735
epoch 12 train loss: 85.907, val loss: 479.474, train acc: 0.997, val acc: 0.978
diff 13.390067168319376
epoch 13 train loss: 10.519, val loss: 390.845, train acc: 1.000, val acc: 0.978
diff 88.62966018269293
epoch 14 train loss: 0.425, val loss: 416.416, train acc: 1.000, val acc: 0.978
diff 25.57181154235718
epoch 15 train loss: 0.067, val loss: 410.260, train acc: 1.000, val acc: 0.979
diff 6.156460301289485
epoch 16 train loss: 0.038, val loss: 409.969, train acc: 1.000, val acc: 0.979
diff 0.2910962574999303
epoch 17 train loss: 0.027, val loss: 411.585, train acc: 1.000, val acc: 0.979
diff 1.6158681120327287
epoch 18 train loss: 0.019, val loss: 414.036, train acc: 1.000, val acc: 0.979
diff 2.4516206546146577
epoch 19 train loss: 0.013, val loss: 417.342, train acc: 1.000, val acc: 0.979
diff 3.3059399103394185
epoch 20 train loss: 0.009, val loss: 421.508, train acc: 1.000, val acc: 0.980
diff 4.16627350565841
epoch 21 train loss: 0.006, val loss: 425.405, train acc: 1.000, val acc: 0.980
diff 3.8963248051144888
epoch 22 train loss: 0.004, val loss: 430.188, train acc: 1.000, val acc: 0.980
diff 4.783090534946609
epoch 23 train loss: 0.003, val loss: 435.996, train acc: 1.000, val acc: 0.980
diff 5.807813494866082
epoch 24 train loss: 0.002, val loss: 441.230, train acc: 1.000, val acc: 0.980
diff 5.23407385741973
epoch 25 train loss: 0.001, val loss: 447.182, train acc: 1.000, val acc: 0.980
diff 5.952302047802334
epoch 26 train loss: 0.001, val loss: 451.261, train acc: 1.000, val acc: 0.980
diff 4.0793066835106515
epoch 27 train loss: 0.001, val loss: 457.918, train acc: 1.000, val acc: 0.980
diff 6.65672603457881
epoch 28 train loss: 0.000, val loss: 463.166, train acc: 1.000, val acc: 0.980
diff 5.248216757862679
epoch 29 train loss: 0.000, val loss: 470.284, train acc: 1.000, val acc: 0.980
diff 7.117486020730553
epoch 30 train loss: 0.000, val loss: 475.542, train acc: 1.000, val acc: 0.981
diff 5.258008019715817
2
