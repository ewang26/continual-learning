Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 9, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2375.029, val loss: 138.704, train acc: 0.967, val acc: 0.982
diff inf
epoch 2 train loss: 826.414, val loss: 159.223, train acc: 0.988, val acc: 0.983
diff 20.51854529771046
epoch 3 train loss: 476.192, val loss: 181.283, train acc: 0.993, val acc: 0.982
diff 22.06038946385422
epoch 4 train loss: 403.096, val loss: 143.854, train acc: 0.994, val acc: 0.988
diff 37.42907231395472
epoch 5 train loss: 267.477, val loss: 155.813, train acc: 0.996, val acc: 0.990
diff 11.95892618053287
epoch 6 train loss: 235.469, val loss: 159.500, train acc: 0.996, val acc: 0.988
diff 3.686994679522428
epoch 7 train loss: 218.976, val loss: 185.012, train acc: 0.997, val acc: 0.986
diff 25.511786921491193
epoch 8 train loss: 235.112, val loss: 220.786, train acc: 0.997, val acc: 0.988
diff 35.774041870466846
epoch 9 train loss: 123.328, val loss: 233.821, train acc: 0.999, val acc: 0.986
diff 13.034866494772075
epoch 10 train loss: 258.529, val loss: 217.240, train acc: 0.996, val acc: 0.993
diff 16.58102190631658
epoch 11 train loss: 135.284, val loss: 162.766, train acc: 0.998, val acc: 0.992
diff 54.47384355050937
epoch 12 train loss: 156.794, val loss: 211.965, train acc: 0.999, val acc: 0.990
diff 49.199610194078105
epoch 13 train loss: 248.914, val loss: 188.160, train acc: 0.998, val acc: 0.990
diff 23.80581261161811
epoch 14 train loss: 177.826, val loss: 195.820, train acc: 0.998, val acc: 0.990
diff 7.660545878070764
epoch 15 train loss: 124.259, val loss: 195.112, train acc: 0.998, val acc: 0.991
diff 0.7077481230707292
epoch 16 train loss: 164.816, val loss: 288.953, train acc: 0.998, val acc: 0.987
diff 93.84088580894979
epoch 17 train loss: 74.472, val loss: 184.942, train acc: 0.999, val acc: 0.993
diff 104.01113880634435
epoch 18 train loss: 123.927, val loss: 354.686, train acc: 0.999, val acc: 0.989
diff 169.7440323046608
epoch 19 train loss: 143.935, val loss: 219.241, train acc: 0.999, val acc: 0.995
diff 135.44525188543923
epoch 20 train loss: 104.376, val loss: 405.343, train acc: 0.999, val acc: 0.991
diff 186.10209955451307
epoch 21 train loss: 216.774, val loss: 306.745, train acc: 0.998, val acc: 0.994
diff 98.59762868791938
epoch 22 train loss: 139.510, val loss: 376.415, train acc: 0.999, val acc: 0.991
diff 69.66922882475927
epoch 23 train loss: 131.638, val loss: 266.519, train acc: 0.999, val acc: 0.993
diff 109.89536043003972
epoch 24 train loss: 104.688, val loss: 383.902, train acc: 0.999, val acc: 0.991
diff 117.38275959300603
epoch 25 train loss: 269.329, val loss: 268.112, train acc: 0.999, val acc: 0.993
diff 115.7904258576715
epoch 26 train loss: 118.879, val loss: 341.262, train acc: 0.999, val acc: 0.993
diff 73.1509329846948
epoch 27 train loss: 81.369, val loss: 432.548, train acc: 0.999, val acc: 0.989
diff 91.28545296011526
epoch 28 train loss: 99.663, val loss: 423.225, train acc: 0.999, val acc: 0.990
diff 9.322826687325858
epoch 29 train loss: 172.725, val loss: 425.535, train acc: 0.999, val acc: 0.993
diff 2.3100934790859355
epoch 30 train loss: 128.641, val loss: 617.598, train acc: 0.999, val acc: 0.987
diff 192.06284715595172
Training model M2
epoch 1 train loss: 3788.547, val loss: 203.555, train acc: 0.957, val acc: 0.982
diff inf
epoch 2 train loss: 1285.835, val loss: 177.967, train acc: 0.984, val acc: 0.985
diff 25.588036878129856
epoch 3 train loss: 839.074, val loss: 228.587, train acc: 0.991, val acc: 0.980
diff 50.61982140476633
epoch 4 train loss: 591.743, val loss: 229.800, train acc: 0.994, val acc: 0.980
diff 1.2131558457793972
epoch 5 train loss: 509.539, val loss: 168.226, train acc: 0.994, val acc: 0.984
diff 61.57481430894316
epoch 6 train loss: 261.757, val loss: 231.108, train acc: 0.997, val acc: 0.984
diff 62.88197657744891
epoch 7 train loss: 400.022, val loss: 339.465, train acc: 0.995, val acc: 0.983
diff 108.35787727794684
epoch 8 train loss: 314.077, val loss: 330.375, train acc: 0.997, val acc: 0.982
diff 9.090057577397204
epoch 9 train loss: 220.378, val loss: 270.965, train acc: 0.998, val acc: 0.987
diff 59.41022048745248
epoch 10 train loss: 321.453, val loss: 233.157, train acc: 0.997, val acc: 0.987
diff 37.808513932499324
epoch 11 train loss: 246.798, val loss: 544.422, train acc: 0.998, val acc: 0.974
diff 311.26539860529624
epoch 12 train loss: 249.298, val loss: 322.591, train acc: 0.998, val acc: 0.985
diff 221.8311223386841
epoch 13 train loss: 288.411, val loss: 297.249, train acc: 0.998, val acc: 0.988
diff 25.34228499294244
epoch 14 train loss: 181.594, val loss: 298.584, train acc: 0.998, val acc: 0.987
diff 1.3351907766265754
epoch 15 train loss: 281.946, val loss: 368.198, train acc: 0.998, val acc: 0.984
diff 69.6146450045577
epoch 16 train loss: 174.551, val loss: 371.196, train acc: 0.999, val acc: 0.988
diff 2.9971460111373744
epoch 17 train loss: 299.500, val loss: 390.810, train acc: 0.998, val acc: 0.987
diff 19.61469474493026
epoch 18 train loss: 251.278, val loss: 434.677, train acc: 0.998, val acc: 0.987
diff 43.866981551750655
epoch 19 train loss: 198.342, val loss: 413.776, train acc: 0.999, val acc: 0.986
diff 20.900882789079503
epoch 20 train loss: 227.195, val loss: 658.658, train acc: 0.999, val acc: 0.985
diff 244.88158236426818
epoch 21 train loss: 165.095, val loss: 722.638, train acc: 0.999, val acc: 0.985
diff 63.97983823817708
epoch 22 train loss: 183.133, val loss: 571.681, train acc: 0.999, val acc: 0.989
diff 150.95635467050954
epoch 23 train loss: 322.139, val loss: 895.984, train acc: 0.998, val acc: 0.980
diff 324.3026250505578
epoch 24 train loss: 128.022, val loss: 517.302, train acc: 0.999, val acc: 0.988
diff 378.6818781141868
epoch 25 train loss: 250.596, val loss: 772.198, train acc: 0.999, val acc: 0.987
diff 254.896028774068
epoch 26 train loss: 106.256, val loss: 850.553, train acc: 0.999, val acc: 0.985
diff 78.35433659206763
epoch 27 train loss: 368.495, val loss: 810.203, train acc: 0.998, val acc: 0.985
diff 40.34974093513074
epoch 28 train loss: 240.319, val loss: 733.729, train acc: 0.999, val acc: 0.986
diff 76.47399107731906
epoch 29 train loss: 194.858, val loss: 646.435, train acc: 0.999, val acc: 0.988
diff 87.29366645500045
epoch 30 train loss: 312.071, val loss: 623.427, train acc: 0.998, val acc: 0.988
diff 23.00778711405212
Training model M3
epoch 1 train loss: 1625.615, val loss: 971.168, train acc: 0.926, val acc: 0.895
diff inf
epoch 2 train loss: 426.210, val loss: 645.305, train acc: 0.980, val acc: 0.947
diff 325.86280893413857
epoch 3 train loss: 243.799, val loss: 766.264, train acc: 0.988, val acc: 0.927
diff 120.95938014185094
epoch 4 train loss: 128.290, val loss: 692.206, train acc: 0.994, val acc: 0.944
diff 74.05820965049702
epoch 5 train loss: 124.919, val loss: 921.576, train acc: 0.994, val acc: 0.932
diff 229.36952874781662
epoch 6 train loss: 139.765, val loss: 589.746, train acc: 0.994, val acc: 0.948
diff 331.8299024819571
epoch 7 train loss: 42.517, val loss: 963.345, train acc: 0.998, val acc: 0.940
diff 373.59971290081626
epoch 8 train loss: 72.576, val loss: 1170.510, train acc: 0.997, val acc: 0.933
diff 207.16435960185447
epoch 9 train loss: 107.363, val loss: 964.636, train acc: 0.995, val acc: 0.940
diff 205.873308306657
epoch 10 train loss: 81.696, val loss: 843.422, train acc: 0.996, val acc: 0.948
diff 121.2145930550696
epoch 11 train loss: 81.543, val loss: 2141.285, train acc: 0.996, val acc: 0.897
diff 1297.8632616386003
epoch 12 train loss: 39.607, val loss: 1125.037, train acc: 0.999, val acc: 0.945
diff 1016.2481235321532
epoch 13 train loss: 1.077, val loss: 1051.454, train acc: 1.000, val acc: 0.949
diff 73.58339435775838
epoch 14 train loss: 0.144, val loss: 1046.676, train acc: 1.000, val acc: 0.951
diff 4.777413725629458
epoch 15 train loss: 0.083, val loss: 1055.064, train acc: 1.000, val acc: 0.952
diff 8.387643739498117
epoch 16 train loss: 0.057, val loss: 1065.781, train acc: 1.000, val acc: 0.952
diff 10.717267052179977
epoch 17 train loss: 0.041, val loss: 1080.600, train acc: 1.000, val acc: 0.951
diff 14.818882493045749
epoch 18 train loss: 0.029, val loss: 1091.139, train acc: 1.000, val acc: 0.953
diff 10.538636208109438
epoch 19 train loss: 0.021, val loss: 1106.309, train acc: 1.000, val acc: 0.953
diff 15.170775111322428
epoch 20 train loss: 0.015, val loss: 1121.700, train acc: 1.000, val acc: 0.953
diff 15.390244805381826
epoch 21 train loss: 0.011, val loss: 1138.460, train acc: 1.000, val acc: 0.953
diff 16.760602544264884
epoch 22 train loss: 0.008, val loss: 1154.674, train acc: 1.000, val acc: 0.953
diff 16.213973525128722
epoch 23 train loss: 0.006, val loss: 1177.677, train acc: 1.000, val acc: 0.954
diff 23.002641093866487
epoch 24 train loss: 0.004, val loss: 1192.587, train acc: 1.000, val acc: 0.954
diff 14.909901034737004
epoch 25 train loss: 0.002, val loss: 1219.234, train acc: 1.000, val acc: 0.955
diff 26.647775334203516
epoch 26 train loss: 0.001, val loss: 1283.143, train acc: 1.000, val acc: 0.955
diff 63.90804914865976
epoch 27 train loss: 0.001, val loss: 1230.127, train acc: 1.000, val acc: 0.958
diff 53.015873619244985
epoch 28 train loss: 0.001, val loss: 1254.187, train acc: 1.000, val acc: 0.956
diff 24.06028843002423
epoch 29 train loss: 0.000, val loss: 1337.753, train acc: 1.000, val acc: 0.957
diff 83.565774713981
epoch 30 train loss: 0.000, val loss: 1374.154, train acc: 1.000, val acc: 0.955
diff 36.401367426117986
Training model M3
epoch 1 train loss: 114.569, val loss: 3063.898, train acc: 0.998, val acc: 0.895
diff inf
epoch 2 train loss: 41.597, val loss: 2187.835, train acc: 0.998, val acc: 0.920
diff 876.0623450674725
epoch 3 train loss: 1.315, val loss: 2418.088, train acc: 1.000, val acc: 0.918
diff 230.25289180535174
epoch 4 train loss: 0.041, val loss: 2422.685, train acc: 1.000, val acc: 0.920
diff 4.596973201365472
epoch 5 train loss: 0.015, val loss: 2438.422, train acc: 1.000, val acc: 0.920
diff 15.73738088628079
epoch 6 train loss: 0.011, val loss: 2441.054, train acc: 1.000, val acc: 0.920
diff 2.632018281679393
epoch 7 train loss: 0.008, val loss: 2450.406, train acc: 1.000, val acc: 0.919
diff 9.351416327116112
epoch 8 train loss: 0.006, val loss: 2462.041, train acc: 1.000, val acc: 0.920
diff 11.635117794461166
epoch 9 train loss: 0.005, val loss: 2480.170, train acc: 1.000, val acc: 0.920
diff 18.129059879225224
epoch 10 train loss: 0.004, val loss: 2492.463, train acc: 1.000, val acc: 0.921
diff 12.292896668218418
epoch 11 train loss: 0.003, val loss: 2508.113, train acc: 1.000, val acc: 0.922
diff 15.650265384815611
epoch 12 train loss: 0.002, val loss: 2527.919, train acc: 1.000, val acc: 0.922
diff 19.806166516063513
epoch 13 train loss: 0.002, val loss: 2547.337, train acc: 1.000, val acc: 0.922
diff 19.417658045093503
epoch 14 train loss: 0.001, val loss: 2570.872, train acc: 1.000, val acc: 0.922
diff 23.534772550627622
epoch 15 train loss: 0.001, val loss: 2590.702, train acc: 1.000, val acc: 0.922
diff 19.830712807343843
epoch 16 train loss: 0.001, val loss: 2619.805, train acc: 1.000, val acc: 0.922
diff 29.102661377100503
epoch 17 train loss: 0.000, val loss: 2648.199, train acc: 1.000, val acc: 0.923
diff 28.39426419987103
epoch 18 train loss: 0.000, val loss: 2683.531, train acc: 1.000, val acc: 0.923
diff 35.33179973252891
epoch 19 train loss: 0.000, val loss: 2715.340, train acc: 1.000, val acc: 0.922
diff 31.80902375216374
epoch 20 train loss: 0.000, val loss: 2753.456, train acc: 1.000, val acc: 0.922
diff 38.11566738667625
epoch 21 train loss: 0.000, val loss: 2792.740, train acc: 1.000, val acc: 0.921
diff 39.284093384844255
epoch 22 train loss: 0.000, val loss: 2831.949, train acc: 1.000, val acc: 0.921
diff 39.208942535025926
epoch 23 train loss: 0.000, val loss: 2877.889, train acc: 1.000, val acc: 0.921
diff 45.939771188204304
epoch 24 train loss: 0.000, val loss: 2915.336, train acc: 1.000, val acc: 0.921
diff 37.44691412838256
epoch 25 train loss: 0.000, val loss: 2957.533, train acc: 1.000, val acc: 0.921
diff 42.19707314032212
epoch 26 train loss: 0.000, val loss: 3002.246, train acc: 1.000, val acc: 0.920
diff 44.71337184122058
epoch 27 train loss: 0.000, val loss: 3049.150, train acc: 1.000, val acc: 0.920
diff 46.90388260922646
epoch 28 train loss: 0.000, val loss: 3088.675, train acc: 1.000, val acc: 0.920
diff 39.52506853951445
epoch 29 train loss: 0.000, val loss: 3132.605, train acc: 1.000, val acc: 0.920
diff 43.92953021596577
epoch 30 train loss: 0.000, val loss: 3175.246, train acc: 1.000, val acc: 0.919
diff 42.64117491077104
Training model M3
epoch 1 train loss: 1148.100, val loss: 341.949, train acc: 0.964, val acc: 0.964
diff inf
epoch 2 train loss: 232.513, val loss: 417.107, train acc: 0.990, val acc: 0.964
diff 75.15811921713424
epoch 3 train loss: 82.009, val loss: 434.979, train acc: 0.997, val acc: 0.964
diff 17.87137776011332
epoch 4 train loss: 25.938, val loss: 483.118, train acc: 0.999, val acc: 0.966
diff 48.13899109631359
epoch 5 train loss: 22.047, val loss: 623.119, train acc: 0.999, val acc: 0.954
diff 140.00122218999678
epoch 6 train loss: 4.295, val loss: 567.567, train acc: 1.000, val acc: 0.958
diff 55.55187140237797
epoch 7 train loss: 0.526, val loss: 566.667, train acc: 1.000, val acc: 0.962
diff 0.9001809675105505
epoch 8 train loss: 0.190, val loss: 582.059, train acc: 1.000, val acc: 0.963
diff 15.391870833327403
epoch 9 train loss: 0.119, val loss: 595.653, train acc: 1.000, val acc: 0.962
diff 13.594094671684502
epoch 10 train loss: 0.080, val loss: 610.267, train acc: 1.000, val acc: 0.962
diff 14.614587744729079
epoch 11 train loss: 0.054, val loss: 625.484, train acc: 1.000, val acc: 0.962
diff 15.217181399284414
epoch 12 train loss: 0.037, val loss: 639.225, train acc: 1.000, val acc: 0.962
diff 13.740586566333036
epoch 13 train loss: 0.026, val loss: 658.434, train acc: 1.000, val acc: 0.964
diff 19.209248477219944
epoch 14 train loss: 0.018, val loss: 683.704, train acc: 1.000, val acc: 0.964
diff 25.269469811297654
epoch 15 train loss: 0.012, val loss: 693.310, train acc: 1.000, val acc: 0.964
diff 9.606317331296054
epoch 16 train loss: 0.008, val loss: 714.005, train acc: 1.000, val acc: 0.964
diff 20.69451888212143
epoch 17 train loss: 0.006, val loss: 732.266, train acc: 1.000, val acc: 0.964
diff 18.261678995840384
epoch 18 train loss: 0.004, val loss: 748.561, train acc: 1.000, val acc: 0.964
diff 16.295110619436628
epoch 19 train loss: 0.003, val loss: 765.588, train acc: 1.000, val acc: 0.964
diff 17.026612835893843
epoch 20 train loss: 0.002, val loss: 785.824, train acc: 1.000, val acc: 0.964
diff 20.236465857297503
epoch 21 train loss: 0.001, val loss: 808.172, train acc: 1.000, val acc: 0.964
diff 22.34749079051835
epoch 22 train loss: 0.001, val loss: 818.959, train acc: 1.000, val acc: 0.964
diff 10.78675287559679
epoch 23 train loss: 0.001, val loss: 841.997, train acc: 1.000, val acc: 0.964
diff 23.03780376745442
epoch 24 train loss: 0.000, val loss: 860.078, train acc: 1.000, val acc: 0.964
diff 18.081343480366286
epoch 25 train loss: 0.000, val loss: 882.730, train acc: 1.000, val acc: 0.964
diff 22.65164873108256
epoch 26 train loss: 0.000, val loss: 899.909, train acc: 1.000, val acc: 0.965
diff 17.179853786393664
epoch 27 train loss: 0.000, val loss: 919.807, train acc: 1.000, val acc: 0.965
diff 19.897347857006935
epoch 28 train loss: 0.000, val loss: 940.426, train acc: 1.000, val acc: 0.965
diff 20.619708589173456
epoch 29 train loss: 0.000, val loss: 961.799, train acc: 1.000, val acc: 0.965
diff 21.372438454459257
epoch 30 train loss: 0.000, val loss: 981.174, train acc: 1.000, val acc: 0.965
diff 19.37517690990512
2
