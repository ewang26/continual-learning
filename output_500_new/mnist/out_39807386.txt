Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.02, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 18, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2423.896, val loss: 143.248, train acc: 0.966, val acc: 0.983
diff inf
epoch 2 train loss: 738.080, val loss: 153.936, train acc: 0.990, val acc: 0.980
diff 10.688126515890872
epoch 3 train loss: 510.669, val loss: 163.657, train acc: 0.993, val acc: 0.985
diff 9.721068622059846
epoch 4 train loss: 333.219, val loss: 116.563, train acc: 0.995, val acc: 0.991
diff 47.09358085132614
epoch 5 train loss: 287.439, val loss: 99.753, train acc: 0.996, val acc: 0.992
diff 16.810315616002825
epoch 6 train loss: 154.857, val loss: 159.625, train acc: 0.998, val acc: 0.991
diff 59.87179433452715
epoch 7 train loss: 233.544, val loss: 175.752, train acc: 0.997, val acc: 0.988
diff 16.126883645639396
epoch 8 train loss: 220.801, val loss: 146.944, train acc: 0.997, val acc: 0.990
diff 28.807743135528398
epoch 9 train loss: 147.071, val loss: 149.547, train acc: 0.998, val acc: 0.991
diff 2.6031115081753455
epoch 10 train loss: 223.930, val loss: 184.777, train acc: 0.998, val acc: 0.989
diff 35.2296944436697
epoch 11 train loss: 125.352, val loss: 207.358, train acc: 0.998, val acc: 0.990
diff 22.5809490696154
epoch 12 train loss: 230.728, val loss: 180.877, train acc: 0.997, val acc: 0.991
diff 26.480501487120023
epoch 13 train loss: 130.143, val loss: 177.125, train acc: 0.999, val acc: 0.991
diff 3.752519283839092
epoch 14 train loss: 121.729, val loss: 185.221, train acc: 0.999, val acc: 0.991
diff 8.096228472338822
epoch 15 train loss: 126.250, val loss: 254.183, train acc: 0.999, val acc: 0.990
diff 68.96235112416159
epoch 16 train loss: 193.156, val loss: 230.839, train acc: 0.998, val acc: 0.992
diff 23.344333775926685
epoch 17 train loss: 118.632, val loss: 276.866, train acc: 0.999, val acc: 0.991
diff 46.02748718107617
epoch 18 train loss: 207.600, val loss: 261.780, train acc: 0.998, val acc: 0.991
diff 15.086610635267618
epoch 19 train loss: 151.720, val loss: 320.830, train acc: 0.999, val acc: 0.986
diff 59.05067102006211
epoch 20 train loss: 49.449, val loss: 468.961, train acc: 0.999, val acc: 0.990
diff 148.13058335728675
epoch 21 train loss: 125.255, val loss: 386.408, train acc: 0.999, val acc: 0.991
diff 82.55259444285412
epoch 22 train loss: 122.005, val loss: 339.750, train acc: 0.999, val acc: 0.990
diff 46.658139553681224
epoch 23 train loss: 126.849, val loss: 323.062, train acc: 0.999, val acc: 0.992
diff 16.687843760929866
epoch 24 train loss: 106.669, val loss: 535.130, train acc: 0.999, val acc: 0.984
diff 212.0675879900304
epoch 25 train loss: 125.429, val loss: 414.681, train acc: 0.999, val acc: 0.988
diff 120.4492689052309
epoch 26 train loss: 144.188, val loss: 475.441, train acc: 0.999, val acc: 0.990
diff 60.76073300820377
epoch 27 train loss: 53.550, val loss: 426.209, train acc: 1.000, val acc: 0.993
diff 49.23247514000764
epoch 28 train loss: 221.233, val loss: 370.956, train acc: 0.999, val acc: 0.994
diff 55.252701418121774
epoch 29 train loss: 118.751, val loss: 577.903, train acc: 0.999, val acc: 0.989
diff 206.94675133079
epoch 30 train loss: 64.079, val loss: 506.255, train acc: 0.999, val acc: 0.991
diff 71.64797394486294
Training model M2
epoch 1 train loss: 3894.607, val loss: 173.620, train acc: 0.956, val acc: 0.985
diff inf
epoch 2 train loss: 1296.417, val loss: 207.212, train acc: 0.985, val acc: 0.978
diff 33.59172529939531
epoch 3 train loss: 847.083, val loss: 175.896, train acc: 0.990, val acc: 0.984
diff 31.315853931939017
epoch 4 train loss: 493.617, val loss: 236.888, train acc: 0.994, val acc: 0.985
diff 60.99165462430153
epoch 5 train loss: 453.906, val loss: 229.071, train acc: 0.995, val acc: 0.985
diff 7.816987489184385
epoch 6 train loss: 416.815, val loss: 263.716, train acc: 0.996, val acc: 0.986
diff 34.645058490941096
epoch 7 train loss: 303.031, val loss: 318.025, train acc: 0.997, val acc: 0.979
diff 54.308770272013135
epoch 8 train loss: 291.798, val loss: 258.316, train acc: 0.997, val acc: 0.986
diff 59.7086146263382
epoch 9 train loss: 324.538, val loss: 218.501, train acc: 0.997, val acc: 0.988
diff 39.815193392967814
epoch 10 train loss: 298.175, val loss: 356.856, train acc: 0.997, val acc: 0.986
diff 138.35471515697688
epoch 11 train loss: 271.690, val loss: 502.469, train acc: 0.998, val acc: 0.981
diff 145.61322838826095
epoch 12 train loss: 311.004, val loss: 544.422, train acc: 0.997, val acc: 0.983
diff 41.953387287876524
epoch 13 train loss: 299.554, val loss: 344.347, train acc: 0.998, val acc: 0.984
diff 200.07506377352297
epoch 14 train loss: 231.618, val loss: 500.036, train acc: 0.998, val acc: 0.985
diff 155.68915885518783
epoch 15 train loss: 311.035, val loss: 572.374, train acc: 0.998, val acc: 0.987
diff 72.33743972179292
epoch 16 train loss: 227.939, val loss: 540.937, train acc: 0.998, val acc: 0.988
diff 31.43681566488374
epoch 17 train loss: 451.898, val loss: 472.200, train acc: 0.998, val acc: 0.989
diff 68.73725817817677
epoch 18 train loss: 178.583, val loss: 612.359, train acc: 0.998, val acc: 0.985
diff 140.15935119855084
epoch 19 train loss: 319.213, val loss: 634.997, train acc: 0.999, val acc: 0.989
diff 22.637462325903698
epoch 20 train loss: 355.535, val loss: 791.315, train acc: 0.998, val acc: 0.984
diff 156.31846902748657
epoch 21 train loss: 236.705, val loss: 923.184, train acc: 0.999, val acc: 0.984
diff 131.86935000902963
epoch 22 train loss: 377.941, val loss: 527.066, train acc: 0.998, val acc: 0.990
diff 396.1178822466935
epoch 23 train loss: 294.989, val loss: 741.155, train acc: 0.998, val acc: 0.985
diff 214.08856954650196
epoch 24 train loss: 258.275, val loss: 719.547, train acc: 0.999, val acc: 0.988
diff 21.607646907279786
epoch 25 train loss: 445.819, val loss: 686.069, train acc: 0.999, val acc: 0.989
diff 33.47883902602996
epoch 26 train loss: 293.554, val loss: 878.630, train acc: 0.999, val acc: 0.988
diff 192.5615495007587
epoch 27 train loss: 335.322, val loss: 939.622, train acc: 0.998, val acc: 0.988
diff 60.99199339449751
epoch 28 train loss: 312.916, val loss: 1110.100, train acc: 0.999, val acc: 0.984
diff 170.4777329044815
epoch 29 train loss: 302.458, val loss: 868.266, train acc: 0.999, val acc: 0.989
diff 241.83387608176167
epoch 30 train loss: 292.815, val loss: 692.420, train acc: 0.999, val acc: 0.988
diff 175.8462512771041
Training model M3
epoch 1 train loss: 1251.914, val loss: 1668.691, train acc: 0.939, val acc: 0.811
diff inf
epoch 2 train loss: 319.252, val loss: 1226.726, train acc: 0.981, val acc: 0.874
diff 441.96497987400267
epoch 3 train loss: 148.286, val loss: 793.421, train acc: 0.992, val acc: 0.930
diff 433.304852960261
epoch 4 train loss: 126.524, val loss: 1419.504, train acc: 0.993, val acc: 0.880
diff 626.0824518728372
epoch 5 train loss: 54.829, val loss: 1468.306, train acc: 0.997, val acc: 0.898
diff 48.802833132792784
epoch 6 train loss: 82.617, val loss: 1622.600, train acc: 0.995, val acc: 0.897
diff 154.29350308866037
epoch 7 train loss: 16.612, val loss: 1689.271, train acc: 0.999, val acc: 0.916
diff 66.67124647296191
epoch 8 train loss: 14.846, val loss: 5525.161, train acc: 0.999, val acc: 0.819
diff 3835.8895254143836
epoch 9 train loss: 171.798, val loss: 2037.144, train acc: 0.993, val acc: 0.884
diff 3488.0166455199733
epoch 10 train loss: 3.739, val loss: 1471.217, train acc: 1.000, val acc: 0.924
diff 565.9269630044628
epoch 11 train loss: 0.701, val loss: 1666.887, train acc: 1.000, val acc: 0.921
diff 195.6697169284339
epoch 12 train loss: 0.968, val loss: 2035.556, train acc: 1.000, val acc: 0.915
diff 368.6687099993103
epoch 13 train loss: 0.113, val loss: 1939.582, train acc: 1.000, val acc: 0.917
diff 95.97332884435241
epoch 14 train loss: 0.036, val loss: 1975.330, train acc: 1.000, val acc: 0.918
diff 35.747788493178405
epoch 15 train loss: 0.026, val loss: 2008.100, train acc: 1.000, val acc: 0.918
diff 32.770295313041515
epoch 16 train loss: 0.020, val loss: 2026.100, train acc: 1.000, val acc: 0.918
diff 17.999888146868216
epoch 17 train loss: 0.015, val loss: 2052.678, train acc: 1.000, val acc: 0.919
diff 26.577732423046655
epoch 18 train loss: 0.011, val loss: 2071.677, train acc: 1.000, val acc: 0.918
diff 18.999548586745277
epoch 19 train loss: 0.009, val loss: 2084.895, train acc: 1.000, val acc: 0.919
diff 13.217426332215382
epoch 20 train loss: 0.006, val loss: 2129.910, train acc: 1.000, val acc: 0.918
diff 45.014946652167964
epoch 21 train loss: 0.005, val loss: 2140.158, train acc: 1.000, val acc: 0.918
diff 10.248173922148453
epoch 22 train loss: 0.003, val loss: 2173.166, train acc: 1.000, val acc: 0.919
diff 33.00831532669645
epoch 23 train loss: 0.002, val loss: 2197.752, train acc: 1.000, val acc: 0.920
diff 24.586084554166064
epoch 24 train loss: 0.002, val loss: 2253.927, train acc: 1.000, val acc: 0.919
diff 56.17455277753879
epoch 25 train loss: 0.001, val loss: 2271.710, train acc: 1.000, val acc: 0.920
diff 17.782853043633168
epoch 26 train loss: 0.001, val loss: 2314.280, train acc: 1.000, val acc: 0.920
diff 42.569825988533466
epoch 27 train loss: 0.001, val loss: 2332.960, train acc: 1.000, val acc: 0.922
diff 18.680142867744962
epoch 28 train loss: 0.000, val loss: 2408.426, train acc: 1.000, val acc: 0.918
diff 75.46632291725109
epoch 29 train loss: 0.000, val loss: 2416.752, train acc: 1.000, val acc: 0.920
diff 8.325734211065537
epoch 30 train loss: 0.000, val loss: 2439.191, train acc: 1.000, val acc: 0.922
diff 22.438775196540973
Training model M3
epoch 1 train loss: 52.326, val loss: 4383.917, train acc: 0.998, val acc: 0.873
diff inf
epoch 2 train loss: 111.662, val loss: 5815.727, train acc: 0.997, val acc: 0.789
diff 1431.809240209168
epoch 3 train loss: 12.830, val loss: 3891.725, train acc: 0.999, val acc: 0.843
diff 1924.0012355717276
epoch 4 train loss: 19.451, val loss: 5067.305, train acc: 0.999, val acc: 0.816
diff 1175.579317825895
epoch 5 train loss: 2.037, val loss: 4779.224, train acc: 1.000, val acc: 0.823
diff 288.0809453294514
epoch 6 train loss: 0.048, val loss: 5020.005, train acc: 1.000, val acc: 0.820
diff 240.78084099748776
epoch 7 train loss: 0.013, val loss: 5102.216, train acc: 1.000, val acc: 0.823
diff 82.2114286736878
epoch 8 train loss: 0.007, val loss: 5393.506, train acc: 1.000, val acc: 0.817
diff 291.2898907346216
epoch 9 train loss: 0.004, val loss: 5264.945, train acc: 1.000, val acc: 0.827
diff 128.5611150060813
epoch 10 train loss: 0.002, val loss: 5427.848, train acc: 1.000, val acc: 0.827
diff 162.90348981873558
epoch 11 train loss: 0.001, val loss: 5521.412, train acc: 1.000, val acc: 0.828
diff 93.56419416521749
epoch 12 train loss: 0.002, val loss: 5548.015, train acc: 1.000, val acc: 0.828
diff 26.602946485383654
epoch 13 train loss: 0.001, val loss: 5847.426, train acc: 1.000, val acc: 0.822
diff 299.4111119801073
epoch 14 train loss: 0.000, val loss: 5824.849, train acc: 1.000, val acc: 0.828
diff 22.57768874712292
epoch 15 train loss: 0.000, val loss: 5638.884, train acc: 1.000, val acc: 0.834
diff 185.96466345395947
epoch 16 train loss: 0.000, val loss: 6051.247, train acc: 1.000, val acc: 0.826
diff 412.36298575028013
epoch 17 train loss: 0.000, val loss: 6134.746, train acc: 1.000, val acc: 0.826
diff 83.49884893006401
epoch 18 train loss: 0.000, val loss: 6207.975, train acc: 1.000, val acc: 0.827
diff 73.2294878079656
epoch 19 train loss: 0.000, val loss: 6355.903, train acc: 1.000, val acc: 0.824
diff 147.9280030210939
epoch 20 train loss: 0.000, val loss: 6544.337, train acc: 1.000, val acc: 0.822
diff 188.43327902107012
epoch 21 train loss: 0.000, val loss: 6421.162, train acc: 1.000, val acc: 0.826
diff 123.1742325515088
epoch 22 train loss: 0.000, val loss: 6721.516, train acc: 1.000, val acc: 0.824
diff 300.35318888119673
epoch 23 train loss: 0.000, val loss: 6722.508, train acc: 1.000, val acc: 0.822
diff 0.9919711926140735
epoch 24 train loss: 0.000, val loss: 6933.351, train acc: 1.000, val acc: 0.817
diff 210.84338158243736
epoch 25 train loss: 0.000, val loss: 7242.448, train acc: 1.000, val acc: 0.812
diff 309.09665274932104
epoch 26 train loss: 0.000, val loss: 7161.610, train acc: 1.000, val acc: 0.817
diff 80.8375726669683
epoch 27 train loss: 0.000, val loss: 7060.539, train acc: 1.000, val acc: 0.819
diff 101.07080093857894
epoch 28 train loss: 0.000, val loss: 7265.842, train acc: 1.000, val acc: 0.817
diff 205.30235132717826
epoch 29 train loss: 0.000, val loss: 7546.921, train acc: 1.000, val acc: 0.810
diff 281.07970631429635
epoch 30 train loss: 0.000, val loss: 7453.317, train acc: 1.000, val acc: 0.815
diff 93.60460914344549
Training model M3
epoch 1 train loss: 871.118, val loss: 840.466, train acc: 0.969, val acc: 0.914
diff inf
epoch 2 train loss: 199.597, val loss: 726.195, train acc: 0.990, val acc: 0.937
diff 114.27053486001785
epoch 3 train loss: 46.214, val loss: 929.118, train acc: 0.997, val acc: 0.936
diff 202.92306945847065
epoch 4 train loss: 10.622, val loss: 965.915, train acc: 0.999, val acc: 0.943
diff 36.79628681881195
epoch 5 train loss: 1.203, val loss: 1014.509, train acc: 1.000, val acc: 0.944
diff 48.594255714404085
epoch 6 train loss: 0.312, val loss: 1037.890, train acc: 1.000, val acc: 0.946
diff 23.381037312686658
epoch 7 train loss: 0.177, val loss: 1122.944, train acc: 1.000, val acc: 0.944
diff 85.05465059595349
epoch 8 train loss: 0.112, val loss: 1163.199, train acc: 1.000, val acc: 0.943
diff 40.25426273071935
epoch 9 train loss: 0.074, val loss: 1227.625, train acc: 1.000, val acc: 0.942
diff 64.42622035322415
epoch 10 train loss: 0.048, val loss: 1247.286, train acc: 1.000, val acc: 0.942
diff 19.660799679381853
epoch 11 train loss: 0.032, val loss: 1296.565, train acc: 1.000, val acc: 0.942
diff 49.279031832555575
epoch 12 train loss: 0.021, val loss: 1320.922, train acc: 1.000, val acc: 0.943
diff 24.356784370682135
epoch 13 train loss: 0.014, val loss: 1374.200, train acc: 1.000, val acc: 0.942
diff 53.27798214935251
epoch 14 train loss: 0.010, val loss: 1405.540, train acc: 1.000, val acc: 0.941
diff 31.340205713983323
epoch 15 train loss: 0.007, val loss: 1439.240, train acc: 1.000, val acc: 0.942
diff 33.699851229606566
epoch 16 train loss: 0.005, val loss: 1471.749, train acc: 1.000, val acc: 0.942
diff 32.50916056540768
epoch 17 train loss: 0.004, val loss: 1494.127, train acc: 1.000, val acc: 0.942
diff 22.37816241425071
epoch 18 train loss: 0.003, val loss: 1539.350, train acc: 1.000, val acc: 0.943
diff 45.222694727486896
epoch 19 train loss: 0.002, val loss: 1555.189, train acc: 1.000, val acc: 0.943
diff 15.839542899127991
epoch 20 train loss: 0.001, val loss: 1589.950, train acc: 1.000, val acc: 0.943
diff 34.76094192681762
epoch 21 train loss: 0.001, val loss: 1619.968, train acc: 1.000, val acc: 0.943
diff 30.01764823538838
epoch 22 train loss: 0.001, val loss: 1632.428, train acc: 1.000, val acc: 0.943
diff 12.460018926597513
epoch 23 train loss: 0.000, val loss: 1662.203, train acc: 1.000, val acc: 0.943
diff 29.775553970594274
epoch 24 train loss: 0.000, val loss: 1704.317, train acc: 1.000, val acc: 0.943
diff 42.11328302909851
epoch 25 train loss: 0.000, val loss: 1746.714, train acc: 1.000, val acc: 0.942
diff 42.39764687668958
epoch 26 train loss: 0.000, val loss: 1767.599, train acc: 1.000, val acc: 0.942
diff 20.884787982655325
epoch 27 train loss: 0.000, val loss: 1788.134, train acc: 1.000, val acc: 0.943
diff 20.534835171760278
epoch 28 train loss: 0.000, val loss: 1828.718, train acc: 1.000, val acc: 0.943
diff 40.58432500084814
epoch 29 train loss: 0.000, val loss: 1840.027, train acc: 1.000, val acc: 0.943
diff 11.30883671917286
epoch 30 train loss: 0.000, val loss: 1899.125, train acc: 1.000, val acc: 0.942
diff 59.09843721792686
2
2
