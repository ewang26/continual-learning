Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 16, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2403.275, val loss: 154.060, train acc: 0.966, val acc: 0.979
diff inf
epoch 2 train loss: 827.157, val loss: 108.095, train acc: 0.987, val acc: 0.987
diff 45.96538796089992
epoch 3 train loss: 472.804, val loss: 106.825, train acc: 0.993, val acc: 0.988
diff 1.269792898467216
epoch 4 train loss: 330.134, val loss: 119.584, train acc: 0.995, val acc: 0.990
diff 12.759281767329938
epoch 5 train loss: 322.114, val loss: 192.439, train acc: 0.995, val acc: 0.987
diff 72.85436783561522
epoch 6 train loss: 225.396, val loss: 176.934, train acc: 0.997, val acc: 0.992
diff 15.504472106375204
epoch 7 train loss: 178.852, val loss: 179.485, train acc: 0.998, val acc: 0.990
diff 2.5509748826951295
epoch 8 train loss: 193.018, val loss: 218.197, train acc: 0.998, val acc: 0.990
diff 38.71229165277458
epoch 9 train loss: 279.679, val loss: 159.891, train acc: 0.997, val acc: 0.988
diff 58.3059980653112
epoch 10 train loss: 130.940, val loss: 261.116, train acc: 0.998, val acc: 0.984
diff 101.22410689378131
epoch 11 train loss: 178.298, val loss: 310.096, train acc: 0.998, val acc: 0.989
diff 48.980317626489864
epoch 12 train loss: 198.865, val loss: 237.030, train acc: 0.998, val acc: 0.989
diff 73.06536390398335
epoch 13 train loss: 180.534, val loss: 225.075, train acc: 0.998, val acc: 0.988
diff 11.955280819368397
epoch 14 train loss: 188.939, val loss: 162.381, train acc: 0.998, val acc: 0.991
diff 62.69388044458765
epoch 15 train loss: 30.302, val loss: 343.302, train acc: 0.999, val acc: 0.988
diff 180.9211317461833
epoch 16 train loss: 156.766, val loss: 231.982, train acc: 0.999, val acc: 0.990
diff 111.32063464534647
epoch 17 train loss: 195.500, val loss: 297.244, train acc: 0.999, val acc: 0.988
diff 65.26257866572993
epoch 18 train loss: 220.866, val loss: 274.268, train acc: 0.998, val acc: 0.991
diff 22.97643785612655
epoch 19 train loss: 26.373, val loss: 351.382, train acc: 1.000, val acc: 0.991
diff 77.11425166937829
epoch 20 train loss: 177.530, val loss: 433.271, train acc: 0.999, val acc: 0.988
diff 81.8887634138693
epoch 21 train loss: 228.485, val loss: 392.010, train acc: 0.998, val acc: 0.991
diff 41.260946912311965
epoch 22 train loss: 69.204, val loss: 674.542, train acc: 0.999, val acc: 0.987
diff 282.53162868579454
epoch 23 train loss: 223.304, val loss: 284.791, train acc: 0.998, val acc: 0.991
diff 389.75016441912476
epoch 24 train loss: 183.738, val loss: 662.807, train acc: 0.999, val acc: 0.987
diff 378.01540364576135
epoch 25 train loss: 283.078, val loss: 437.210, train acc: 0.999, val acc: 0.990
diff 225.59678927886364
epoch 26 train loss: 98.753, val loss: 562.100, train acc: 0.999, val acc: 0.989
diff 124.89001137068533
epoch 27 train loss: 337.610, val loss: 636.351, train acc: 0.998, val acc: 0.989
diff 74.25079513747517
epoch 28 train loss: 147.728, val loss: 642.139, train acc: 0.999, val acc: 0.989
diff 5.7884920750219635
epoch 29 train loss: 174.129, val loss: 855.894, train acc: 0.999, val acc: 0.987
diff 213.75475509930345
epoch 30 train loss: 256.773, val loss: 665.065, train acc: 0.999, val acc: 0.989
diff 190.8288482054536
Training model M2
epoch 1 train loss: 3975.262, val loss: 201.876, train acc: 0.954, val acc: 0.985
diff inf
epoch 2 train loss: 1369.233, val loss: 237.853, train acc: 0.984, val acc: 0.976
diff 35.97761868989869
epoch 3 train loss: 814.601, val loss: 208.901, train acc: 0.990, val acc: 0.982
diff 28.952291504013033
epoch 4 train loss: 539.258, val loss: 215.951, train acc: 0.994, val acc: 0.986
diff 7.049939648245214
epoch 5 train loss: 499.236, val loss: 148.251, train acc: 0.995, val acc: 0.989
diff 67.69987422209255
epoch 6 train loss: 401.509, val loss: 193.151, train acc: 0.996, val acc: 0.986
diff 44.900201000874915
epoch 7 train loss: 325.092, val loss: 190.422, train acc: 0.997, val acc: 0.986
diff 2.7288781662834936
epoch 8 train loss: 318.109, val loss: 376.583, train acc: 0.997, val acc: 0.983
diff 186.16027432331288
epoch 9 train loss: 330.202, val loss: 284.039, train acc: 0.997, val acc: 0.986
diff 92.54325203737608
epoch 10 train loss: 253.698, val loss: 336.635, train acc: 0.998, val acc: 0.986
diff 52.59553881998875
epoch 11 train loss: 320.321, val loss: 287.076, train acc: 0.998, val acc: 0.987
diff 49.55903339225222
epoch 12 train loss: 289.094, val loss: 367.114, train acc: 0.997, val acc: 0.986
diff 80.03835458516016
epoch 13 train loss: 195.731, val loss: 475.281, train acc: 0.998, val acc: 0.986
diff 108.16686105465493
epoch 14 train loss: 476.892, val loss: 461.716, train acc: 0.996, val acc: 0.988
diff 13.564881220979032
epoch 15 train loss: 248.053, val loss: 582.301, train acc: 0.999, val acc: 0.980
diff 120.58478268048503
epoch 16 train loss: 322.970, val loss: 531.722, train acc: 0.998, val acc: 0.985
diff 50.57953451881997
epoch 17 train loss: 254.738, val loss: 408.781, train acc: 0.998, val acc: 0.986
diff 122.94007712531953
epoch 18 train loss: 284.000, val loss: 486.014, train acc: 0.998, val acc: 0.986
diff 77.23252432587753
epoch 19 train loss: 352.643, val loss: 629.023, train acc: 0.997, val acc: 0.985
diff 143.0094440268462
epoch 20 train loss: 387.232, val loss: 500.439, train acc: 0.998, val acc: 0.988
diff 128.5840681749762
epoch 21 train loss: 117.839, val loss: 496.662, train acc: 0.999, val acc: 0.989
diff 3.777117487881469
epoch 22 train loss: 329.724, val loss: 553.142, train acc: 0.998, val acc: 0.987
diff 56.47980757415769
epoch 23 train loss: 171.698, val loss: 776.810, train acc: 0.999, val acc: 0.984
diff 223.66810094913058
epoch 24 train loss: 235.925, val loss: 702.802, train acc: 0.999, val acc: 0.986
diff 74.00775983306721
epoch 25 train loss: 235.872, val loss: 661.911, train acc: 0.999, val acc: 0.985
diff 40.89189737037657
epoch 26 train loss: 262.827, val loss: 550.893, train acc: 0.999, val acc: 0.988
diff 111.01765929951239
epoch 27 train loss: 267.999, val loss: 733.170, train acc: 0.999, val acc: 0.987
diff 182.2766544078795
epoch 28 train loss: 212.395, val loss: 822.208, train acc: 0.999, val acc: 0.987
diff 89.03840868675945
epoch 29 train loss: 278.732, val loss: 894.161, train acc: 0.999, val acc: 0.990
diff 71.95267321477047
epoch 30 train loss: 385.805, val loss: 872.661, train acc: 0.999, val acc: 0.989
diff 21.499344572206383
Training model M3
epoch 1 train loss: 1662.186, val loss: 826.062, train acc: 0.924, val acc: 0.917
diff inf
epoch 2 train loss: 408.682, val loss: 516.959, train acc: 0.981, val acc: 0.952
diff 309.1037786646035
epoch 3 train loss: 279.877, val loss: 841.215, train acc: 0.986, val acc: 0.918
diff 324.2561395260326
epoch 4 train loss: 186.724, val loss: 621.229, train acc: 0.991, val acc: 0.948
diff 219.9854870213777
epoch 5 train loss: 62.033, val loss: 1042.454, train acc: 0.997, val acc: 0.929
diff 421.22434136521395
epoch 6 train loss: 137.580, val loss: 859.683, train acc: 0.994, val acc: 0.934
diff 182.77062608677466
epoch 7 train loss: 89.978, val loss: 684.592, train acc: 0.996, val acc: 0.950
diff 175.0913523204083
epoch 8 train loss: 161.931, val loss: 1181.425, train acc: 0.993, val acc: 0.917
diff 496.8335119808944
epoch 9 train loss: 32.198, val loss: 1474.475, train acc: 0.998, val acc: 0.913
diff 293.0493827898847
epoch 10 train loss: 26.731, val loss: 957.665, train acc: 0.998, val acc: 0.947
diff 516.809747229453
epoch 11 train loss: 89.821, val loss: 1365.887, train acc: 0.997, val acc: 0.918
diff 408.222326589412
epoch 12 train loss: 95.651, val loss: 1056.957, train acc: 0.997, val acc: 0.935
diff 308.92974612995863
epoch 13 train loss: 85.041, val loss: 935.079, train acc: 0.997, val acc: 0.944
diff 121.87820017979448
epoch 14 train loss: 34.475, val loss: 899.432, train acc: 0.998, val acc: 0.952
diff 35.64689628307258
epoch 15 train loss: 10.061, val loss: 957.247, train acc: 1.000, val acc: 0.953
diff 57.814435162170525
epoch 16 train loss: 0.271, val loss: 1012.452, train acc: 1.000, val acc: 0.954
diff 55.205473641156686
epoch 17 train loss: 0.098, val loss: 1012.353, train acc: 1.000, val acc: 0.955
diff 0.09919170866055538
Training model M3
epoch 1 train loss: 14.228, val loss: 3113.457, train acc: 1.000, val acc: 0.915
diff inf
epoch 2 train loss: 158.930, val loss: 3003.130, train acc: 0.996, val acc: 0.906
diff 110.32794513535146
epoch 3 train loss: 41.243, val loss: 2714.256, train acc: 0.999, val acc: 0.908
diff 288.8736471757261
epoch 4 train loss: 3.075, val loss: 2855.255, train acc: 1.000, val acc: 0.912
diff 140.99921015092286
epoch 5 train loss: 0.012, val loss: 2843.612, train acc: 1.000, val acc: 0.915
diff 11.643130503738575
epoch 6 train loss: 0.007, val loss: 2847.103, train acc: 1.000, val acc: 0.917
diff 3.490646040856973
epoch 7 train loss: 0.005, val loss: 2856.191, train acc: 1.000, val acc: 0.917
diff 9.088347342747056
epoch 8 train loss: 0.004, val loss: 2871.962, train acc: 1.000, val acc: 0.917
diff 15.770788496774003
epoch 9 train loss: 0.003, val loss: 2887.938, train acc: 1.000, val acc: 0.917
diff 15.97631884175189
epoch 10 train loss: 0.002, val loss: 2913.255, train acc: 1.000, val acc: 0.915
diff 25.31698213582922
epoch 11 train loss: 0.002, val loss: 2940.500, train acc: 1.000, val acc: 0.915
diff 27.245065502151647
epoch 12 train loss: 0.001, val loss: 2971.132, train acc: 1.000, val acc: 0.915
diff 30.63205884069521
epoch 13 train loss: 0.001, val loss: 3010.353, train acc: 1.000, val acc: 0.915
diff 39.22093317555982
epoch 14 train loss: 0.001, val loss: 3033.781, train acc: 1.000, val acc: 0.915
diff 23.427734089760634
epoch 15 train loss: 0.000, val loss: 3068.032, train acc: 1.000, val acc: 0.915
diff 34.2515430030262
epoch 16 train loss: 0.000, val loss: 3096.754, train acc: 1.000, val acc: 0.914
diff 28.721899302197016
epoch 17 train loss: 0.000, val loss: 3132.861, train acc: 1.000, val acc: 0.913
diff 36.10715198147864
epoch 18 train loss: 0.000, val loss: 3170.158, train acc: 1.000, val acc: 0.913
diff 37.29618704166751
epoch 19 train loss: 0.000, val loss: 3209.988, train acc: 1.000, val acc: 0.912
diff 39.83067389698681
epoch 20 train loss: 0.000, val loss: 3251.659, train acc: 1.000, val acc: 0.912
diff 41.67023618822577
epoch 21 train loss: 0.000, val loss: 3277.901, train acc: 1.000, val acc: 0.911
diff 26.24249928114159
epoch 22 train loss: 0.000, val loss: 3325.742, train acc: 1.000, val acc: 0.910
diff 47.84143586294431
epoch 23 train loss: 0.000, val loss: 3361.039, train acc: 1.000, val acc: 0.910
diff 35.296741576578825
epoch 24 train loss: 0.000, val loss: 3403.329, train acc: 1.000, val acc: 0.909
diff 42.28968043064333
epoch 25 train loss: 0.000, val loss: 3443.195, train acc: 1.000, val acc: 0.909
diff 39.866340116187075
epoch 26 train loss: 0.000, val loss: 3476.593, train acc: 1.000, val acc: 0.909
diff 33.398105455450604
epoch 27 train loss: 0.000, val loss: 3518.121, train acc: 1.000, val acc: 0.909
diff 41.52733604995956
epoch 28 train loss: 0.000, val loss: 3557.212, train acc: 1.000, val acc: 0.909
diff 39.09106833679243
epoch 29 train loss: 0.000, val loss: 3592.054, train acc: 1.000, val acc: 0.909
diff 34.84203030543722
epoch 30 train loss: 0.000, val loss: 3631.445, train acc: 1.000, val acc: 0.909
diff 39.39076686784665
Training model M3
epoch 1 train loss: 1391.128, val loss: 320.259, train acc: 0.956, val acc: 0.969
diff inf
epoch 2 train loss: 309.204, val loss: 229.107, train acc: 0.987, val acc: 0.975
diff 91.15181170181401
epoch 3 train loss: 91.069, val loss: 389.544, train acc: 0.996, val acc: 0.970
diff 160.4373961236207
epoch 4 train loss: 39.706, val loss: 342.330, train acc: 0.998, val acc: 0.975
diff 47.21417594201654
epoch 5 train loss: 49.731, val loss: 648.831, train acc: 0.998, val acc: 0.951
diff 306.50121315344995
epoch 6 train loss: 137.374, val loss: 685.677, train acc: 0.992, val acc: 0.966
diff 36.845434482177325
epoch 7 train loss: 118.138, val loss: 607.871, train acc: 0.994, val acc: 0.963
diff 77.80585636680394
epoch 8 train loss: 64.813, val loss: 529.070, train acc: 0.997, val acc: 0.965
diff 78.8005816172257
epoch 9 train loss: 13.846, val loss: 478.378, train acc: 0.999, val acc: 0.972
diff 50.69228496019463
epoch 10 train loss: 17.154, val loss: 625.237, train acc: 0.999, val acc: 0.966
diff 146.85883289279406
epoch 11 train loss: 122.304, val loss: 767.172, train acc: 0.995, val acc: 0.957
diff 141.93548943490498
epoch 12 train loss: 80.634, val loss: 930.820, train acc: 0.997, val acc: 0.953
diff 163.64765848880563
epoch 13 train loss: 64.374, val loss: 484.413, train acc: 0.998, val acc: 0.970
diff 446.40689157734744
epoch 14 train loss: 1.561, val loss: 568.674, train acc: 1.000, val acc: 0.970
diff 84.26069237638615
epoch 15 train loss: 0.387, val loss: 529.685, train acc: 1.000, val acc: 0.970
diff 38.988764388668415
epoch 16 train loss: 0.040, val loss: 533.995, train acc: 1.000, val acc: 0.970
diff 4.30973991175847
epoch 17 train loss: 0.029, val loss: 537.606, train acc: 1.000, val acc: 0.970
diff 3.611171353692839
epoch 18 train loss: 0.022, val loss: 541.772, train acc: 1.000, val acc: 0.971
diff 4.166517131490764
epoch 19 train loss: 0.017, val loss: 545.527, train acc: 1.000, val acc: 0.970
diff 3.7548614006509524
epoch 20 train loss: 0.013, val loss: 549.390, train acc: 1.000, val acc: 0.970
diff 3.8627525397326963
epoch 21 train loss: 0.009, val loss: 555.049, train acc: 1.000, val acc: 0.971
diff 5.659020709151719
epoch 22 train loss: 0.007, val loss: 562.011, train acc: 1.000, val acc: 0.971
diff 6.961981575441541
epoch 23 train loss: 0.005, val loss: 566.262, train acc: 1.000, val acc: 0.972
diff 4.250829191754292
epoch 24 train loss: 0.003, val loss: 574.630, train acc: 1.000, val acc: 0.971
diff 8.368343944383355
epoch 25 train loss: 0.002, val loss: 583.826, train acc: 1.000, val acc: 0.971
diff 9.196038241073438
epoch 26 train loss: 0.001, val loss: 593.081, train acc: 1.000, val acc: 0.971
diff 9.254967143624981
epoch 27 train loss: 0.001, val loss: 601.091, train acc: 1.000, val acc: 0.973
diff 8.010198139279169
epoch 28 train loss: 0.001, val loss: 611.972, train acc: 1.000, val acc: 0.973
diff 10.880665673196404
epoch 29 train loss: 0.000, val loss: 619.236, train acc: 1.000, val acc: 0.973
diff 7.2637772382280446
epoch 30 train loss: 0.000, val loss: 630.936, train acc: 1.000, val acc: 0.973
diff 11.699968618260755
