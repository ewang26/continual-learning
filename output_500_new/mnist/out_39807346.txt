Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.02, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 1, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2413.907, val loss: 187.938, train acc: 0.965, val acc: 0.976
diff inf
epoch 2 train loss: 813.982, val loss: 125.166, train acc: 0.989, val acc: 0.984
diff 62.77117558104118
epoch 3 train loss: 489.248, val loss: 85.710, train acc: 0.993, val acc: 0.991
diff 39.45686628513296
epoch 4 train loss: 288.334, val loss: 104.458, train acc: 0.996, val acc: 0.990
diff 18.74832901783327
epoch 5 train loss: 267.391, val loss: 125.659, train acc: 0.996, val acc: 0.988
diff 21.201047528886036
epoch 6 train loss: 280.558, val loss: 125.759, train acc: 0.997, val acc: 0.988
diff 0.09978302265392358
Training model M2
epoch 1 train loss: 3923.168, val loss: 236.680, train acc: 0.956, val acc: 0.978
diff inf
epoch 2 train loss: 1305.400, val loss: 162.244, train acc: 0.985, val acc: 0.986
diff 74.43608669390093
epoch 3 train loss: 768.521, val loss: 175.086, train acc: 0.991, val acc: 0.987
diff 12.842566983735878
epoch 4 train loss: 570.503, val loss: 298.701, train acc: 0.993, val acc: 0.981
diff 123.61505330963709
epoch 5 train loss: 423.977, val loss: 158.749, train acc: 0.995, val acc: 0.988
diff 139.95244052733813
epoch 6 train loss: 339.352, val loss: 230.515, train acc: 0.996, val acc: 0.983
diff 71.76622713520095
epoch 7 train loss: 383.264, val loss: 237.264, train acc: 0.996, val acc: 0.988
diff 6.748704035967108
epoch 8 train loss: 304.341, val loss: 300.985, train acc: 0.997, val acc: 0.985
diff 63.72153576871139
epoch 9 train loss: 279.952, val loss: 230.285, train acc: 0.997, val acc: 0.986
diff 70.70055201008975
epoch 10 train loss: 267.120, val loss: 229.492, train acc: 0.998, val acc: 0.989
diff 0.792394160394366
epoch 11 train loss: 322.671, val loss: 242.317, train acc: 0.997, val acc: 0.990
diff 12.824580393291257
epoch 12 train loss: 243.870, val loss: 351.678, train acc: 0.998, val acc: 0.985
diff 109.3607132916757
epoch 13 train loss: 263.577, val loss: 483.205, train acc: 0.998, val acc: 0.985
diff 131.52714026260924
epoch 14 train loss: 106.352, val loss: 268.736, train acc: 0.999, val acc: 0.990
diff 214.46903977765965
epoch 15 train loss: 407.881, val loss: 495.123, train acc: 0.997, val acc: 0.982
diff 226.3877317967083
epoch 16 train loss: 262.569, val loss: 526.106, train acc: 0.998, val acc: 0.986
diff 30.982715467989976
epoch 17 train loss: 261.285, val loss: 398.967, train acc: 0.998, val acc: 0.987
diff 127.13881986185936
epoch 18 train loss: 256.962, val loss: 438.751, train acc: 0.998, val acc: 0.987
diff 39.783182691203706
epoch 19 train loss: 208.595, val loss: 550.447, train acc: 0.999, val acc: 0.987
diff 111.69621035305693
epoch 20 train loss: 73.937, val loss: 592.893, train acc: 0.999, val acc: 0.985
diff 42.44586453034799
epoch 21 train loss: 344.466, val loss: 562.451, train acc: 0.998, val acc: 0.987
diff 30.441506178571785
epoch 22 train loss: 301.086, val loss: 571.680, train acc: 0.999, val acc: 0.986
diff 9.228509067370851
epoch 23 train loss: 269.500, val loss: 494.105, train acc: 0.998, val acc: 0.987
diff 77.5749017693779
epoch 24 train loss: 189.265, val loss: 615.590, train acc: 0.999, val acc: 0.986
diff 121.48494742713012
epoch 25 train loss: 213.409, val loss: 468.094, train acc: 0.999, val acc: 0.988
diff 147.4959268193884
epoch 26 train loss: 113.920, val loss: 681.749, train acc: 0.999, val acc: 0.988
diff 213.65510504379415
epoch 27 train loss: 357.458, val loss: 602.987, train acc: 0.999, val acc: 0.987
diff 78.7617482325162
epoch 28 train loss: 242.939, val loss: 669.716, train acc: 0.999, val acc: 0.985
diff 66.7290027094723
epoch 29 train loss: 320.846, val loss: 873.372, train acc: 0.999, val acc: 0.986
diff 203.6562263860102
epoch 30 train loss: 251.406, val loss: 716.008, train acc: 0.999, val acc: 0.987
diff 157.36397347828733
Training model M3
epoch 1 train loss: 1351.690, val loss: 1969.865, train acc: 0.934, val acc: 0.779
diff inf
epoch 2 train loss: 323.266, val loss: 1132.971, train acc: 0.980, val acc: 0.884
diff 836.8937515309531
epoch 3 train loss: 177.602, val loss: 1056.467, train acc: 0.989, val acc: 0.905
diff 76.50410794506388
epoch 4 train loss: 143.134, val loss: 1218.681, train acc: 0.992, val acc: 0.892
diff 162.21338071080163
epoch 5 train loss: 50.386, val loss: 1334.210, train acc: 0.997, val acc: 0.913
diff 115.52983029993788
epoch 6 train loss: 30.719, val loss: 1821.015, train acc: 0.998, val acc: 0.902
diff 486.80448438108556
epoch 7 train loss: 65.604, val loss: 1682.830, train acc: 0.998, val acc: 0.877
diff 138.184719579702
epoch 8 train loss: 124.238, val loss: 1900.096, train acc: 0.991, val acc: 0.880
diff 217.26538182016816
epoch 9 train loss: 33.081, val loss: 2332.828, train acc: 0.998, val acc: 0.875
diff 432.73187586223935
epoch 10 train loss: 62.740, val loss: 2047.867, train acc: 0.997, val acc: 0.888
diff 284.9601584662694
epoch 11 train loss: 7.688, val loss: 2101.683, train acc: 1.000, val acc: 0.896
diff 53.81562153106347
epoch 12 train loss: 1.600, val loss: 2538.319, train acc: 1.000, val acc: 0.884
diff 436.636171284832
epoch 13 train loss: 116.434, val loss: 2008.403, train acc: 0.996, val acc: 0.890
diff 529.9160054569745
epoch 14 train loss: 67.821, val loss: 2495.369, train acc: 0.996, val acc: 0.884
diff 486.965801849459
epoch 15 train loss: 4.662, val loss: 2330.136, train acc: 1.000, val acc: 0.899
diff 165.2327599824116
epoch 16 train loss: 0.382, val loss: 2537.250, train acc: 1.000, val acc: 0.893
diff 207.11428531177216
epoch 17 train loss: 0.064, val loss: 2561.851, train acc: 1.000, val acc: 0.893
diff 24.60062786228127
epoch 18 train loss: 0.046, val loss: 2581.027, train acc: 1.000, val acc: 0.892
diff 19.176135674179932
epoch 19 train loss: 0.034, val loss: 2599.298, train acc: 1.000, val acc: 0.893
diff 18.270691839316896
epoch 20 train loss: 0.026, val loss: 2622.632, train acc: 1.000, val acc: 0.893
diff 23.333680448999075
epoch 21 train loss: 0.020, val loss: 2646.781, train acc: 1.000, val acc: 0.894
diff 24.149866566700894
epoch 22 train loss: 0.015, val loss: 2675.141, train acc: 1.000, val acc: 0.894
diff 28.35963292267479
epoch 23 train loss: 0.011, val loss: 2699.397, train acc: 1.000, val acc: 0.894
diff 24.256054836916064
epoch 24 train loss: 0.008, val loss: 2736.415, train acc: 1.000, val acc: 0.894
diff 37.01831517604296
epoch 25 train loss: 0.006, val loss: 2776.602, train acc: 1.000, val acc: 0.895
diff 40.18693699173673
epoch 26 train loss: 0.005, val loss: 2806.019, train acc: 1.000, val acc: 0.895
diff 29.41621876976751
epoch 27 train loss: 0.003, val loss: 2841.246, train acc: 1.000, val acc: 0.895
diff 35.227346393579865
epoch 28 train loss: 0.003, val loss: 2880.495, train acc: 1.000, val acc: 0.895
diff 39.249369667750216
epoch 29 train loss: 0.002, val loss: 2922.551, train acc: 1.000, val acc: 0.895
diff 42.05573459763127
epoch 30 train loss: 0.001, val loss: 2954.702, train acc: 1.000, val acc: 0.895
diff 32.150978458174905
Training model M3
epoch 1 train loss: 65.649, val loss: 5227.730, train acc: 0.998, val acc: 0.837
diff inf
epoch 2 train loss: 63.474, val loss: 2627.093, train acc: 0.998, val acc: 0.890
diff 2600.6364397724105
epoch 3 train loss: 1.469, val loss: 4189.246, train acc: 1.000, val acc: 0.857
diff 1562.1526673908643
epoch 4 train loss: 0.020, val loss: 4275.057, train acc: 1.000, val acc: 0.856
diff 85.81105345254673
epoch 5 train loss: 0.008, val loss: 4200.623, train acc: 1.000, val acc: 0.858
diff 74.43338268579373
epoch 6 train loss: 0.005, val loss: 4260.499, train acc: 1.000, val acc: 0.856
diff 59.87509104577475
epoch 7 train loss: 0.004, val loss: 4299.052, train acc: 1.000, val acc: 0.856
diff 38.55382298739096
epoch 8 train loss: 0.003, val loss: 4350.852, train acc: 1.000, val acc: 0.856
diff 51.79917882070367
epoch 9 train loss: 0.002, val loss: 4392.052, train acc: 1.000, val acc: 0.857
diff 41.20016099248551
epoch 10 train loss: 0.001, val loss: 4414.344, train acc: 1.000, val acc: 0.857
diff 22.292175298931397
epoch 11 train loss: 0.001, val loss: 4481.821, train acc: 1.000, val acc: 0.857
diff 67.47739928168176
epoch 12 train loss: 0.001, val loss: 4508.775, train acc: 1.000, val acc: 0.857
diff 26.953667097161997
epoch 13 train loss: 0.001, val loss: 4549.292, train acc: 1.000, val acc: 0.856
diff 40.516721043676625
epoch 14 train loss: 0.000, val loss: 4578.117, train acc: 1.000, val acc: 0.856
diff 28.825551057439952
epoch 15 train loss: 0.000, val loss: 4662.039, train acc: 1.000, val acc: 0.857
diff 83.92131368689661
epoch 16 train loss: 0.000, val loss: 4747.355, train acc: 1.000, val acc: 0.854
diff 85.31682631531021
epoch 17 train loss: 0.000, val loss: 4750.970, train acc: 1.000, val acc: 0.856
diff 3.6149443460544717
epoch 18 train loss: 0.000, val loss: 4825.802, train acc: 1.000, val acc: 0.855
diff 74.83177248151424
epoch 19 train loss: 0.000, val loss: 4889.746, train acc: 1.000, val acc: 0.854
diff 63.944157587923655
epoch 20 train loss: 0.000, val loss: 4970.498, train acc: 1.000, val acc: 0.853
diff 80.75156001948835
epoch 21 train loss: 0.000, val loss: 4997.693, train acc: 1.000, val acc: 0.852
diff 27.19481986422943
epoch 22 train loss: 0.000, val loss: 5089.010, train acc: 1.000, val acc: 0.851
diff 91.31750390976867
epoch 23 train loss: 0.000, val loss: 5105.053, train acc: 1.000, val acc: 0.851
diff 16.043366634489757
epoch 24 train loss: 0.000, val loss: 5185.038, train acc: 1.000, val acc: 0.849
diff 79.98409302581786
epoch 25 train loss: 0.000, val loss: 5229.338, train acc: 1.000, val acc: 0.849
diff 44.29996675344319
epoch 26 train loss: 0.000, val loss: 5288.755, train acc: 1.000, val acc: 0.848
diff 59.4177723821731
epoch 27 train loss: 0.000, val loss: 5348.252, train acc: 1.000, val acc: 0.848
diff 59.49718239606136
epoch 28 train loss: 0.000, val loss: 5452.359, train acc: 1.000, val acc: 0.847
diff 104.1068764242973
epoch 29 train loss: 0.000, val loss: 5494.456, train acc: 1.000, val acc: 0.846
diff 42.09670100047151
epoch 30 train loss: 0.000, val loss: 5526.151, train acc: 1.000, val acc: 0.847
diff 31.695063871704406
Training model M3
epoch 1 train loss: 892.343, val loss: 757.417, train acc: 0.969, val acc: 0.935
diff inf
epoch 2 train loss: 167.112, val loss: 672.246, train acc: 0.993, val acc: 0.943
diff 85.17137060619143
epoch 3 train loss: 15.280, val loss: 828.431, train acc: 1.000, val acc: 0.944
diff 156.184855749735
epoch 4 train loss: 5.137, val loss: 1039.498, train acc: 1.000, val acc: 0.941
diff 211.06742941261416
epoch 5 train loss: 0.556, val loss: 1102.615, train acc: 1.000, val acc: 0.938
diff 63.11655739804405
epoch 6 train loss: 0.186, val loss: 1133.475, train acc: 1.000, val acc: 0.940
diff 30.860376650007993
epoch 7 train loss: 0.115, val loss: 1166.073, train acc: 1.000, val acc: 0.941
diff 32.59730034014706
epoch 8 train loss: 0.077, val loss: 1196.928, train acc: 1.000, val acc: 0.941
diff 30.85562461569566
epoch 9 train loss: 0.053, val loss: 1224.030, train acc: 1.000, val acc: 0.940
diff 27.101878336208074
epoch 10 train loss: 0.036, val loss: 1239.454, train acc: 1.000, val acc: 0.939
diff 15.42375690991912
epoch 11 train loss: 0.025, val loss: 1273.989, train acc: 1.000, val acc: 0.939
diff 34.53547277488542
epoch 12 train loss: 0.017, val loss: 1304.888, train acc: 1.000, val acc: 0.938
diff 30.89833071541898
epoch 13 train loss: 0.011, val loss: 1338.184, train acc: 1.000, val acc: 0.938
diff 33.295825297603415
epoch 14 train loss: 0.007, val loss: 1360.930, train acc: 1.000, val acc: 0.937
diff 22.746201286535097
epoch 15 train loss: 0.005, val loss: 1394.567, train acc: 1.000, val acc: 0.937
diff 33.636920217106535
epoch 16 train loss: 0.003, val loss: 1434.188, train acc: 1.000, val acc: 0.937
diff 39.621768831634654
epoch 17 train loss: 0.002, val loss: 1460.327, train acc: 1.000, val acc: 0.938
diff 26.138289590946215
epoch 18 train loss: 0.001, val loss: 1513.539, train acc: 1.000, val acc: 0.937
diff 53.21259791332045
epoch 19 train loss: 0.001, val loss: 1543.514, train acc: 1.000, val acc: 0.936
diff 29.97437017109064
epoch 20 train loss: 0.001, val loss: 1574.961, train acc: 1.000, val acc: 0.936
diff 31.447392643811554
epoch 21 train loss: 0.001, val loss: 1625.321, train acc: 1.000, val acc: 0.935
diff 50.35979242425583
epoch 22 train loss: 0.000, val loss: 1641.537, train acc: 1.000, val acc: 0.935
diff 16.215864313828206
epoch 23 train loss: 0.000, val loss: 1671.486, train acc: 1.000, val acc: 0.935
diff 29.949083010121285
epoch 24 train loss: 0.000, val loss: 1709.723, train acc: 1.000, val acc: 0.935
diff 38.237239448287255
epoch 25 train loss: 0.000, val loss: 1748.134, train acc: 1.000, val acc: 0.934
diff 38.41088828448483
epoch 26 train loss: 0.000, val loss: 1779.674, train acc: 1.000, val acc: 0.935
diff 31.54008612000348
epoch 27 train loss: 0.000, val loss: 1809.658, train acc: 1.000, val acc: 0.934
diff 29.98373744673131
epoch 28 train loss: 0.000, val loss: 1844.255, train acc: 1.000, val acc: 0.933
diff 34.59681447740536
epoch 29 train loss: 0.000, val loss: 1864.401, train acc: 1.000, val acc: 0.932
diff 20.14628849125802
epoch 30 train loss: 0.000, val loss: 1899.678, train acc: 1.000, val acc: 0.933
diff 35.27666951660444
2
2
2
2
2
2
2
