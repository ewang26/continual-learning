Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 4, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2405.715, val loss: 165.153, train acc: 0.966, val acc: 0.978
diff inf
epoch 2 train loss: 782.626, val loss: 128.648, train acc: 0.988, val acc: 0.986
diff 36.505550017707776
epoch 3 train loss: 545.575, val loss: 81.452, train acc: 0.992, val acc: 0.990
diff 47.19589731308706
epoch 4 train loss: 396.958, val loss: 84.557, train acc: 0.994, val acc: 0.991
diff 3.104980718437929
epoch 5 train loss: 242.941, val loss: 116.235, train acc: 0.996, val acc: 0.991
diff 31.678652784945157
epoch 6 train loss: 304.020, val loss: 174.601, train acc: 0.996, val acc: 0.989
diff 58.365858597560674
epoch 7 train loss: 196.674, val loss: 197.631, train acc: 0.997, val acc: 0.990
diff 23.029889960857503
epoch 8 train loss: 181.864, val loss: 252.568, train acc: 0.998, val acc: 0.988
diff 54.937026561262144
epoch 9 train loss: 175.647, val loss: 166.199, train acc: 0.998, val acc: 0.991
diff 86.36931325511219
epoch 10 train loss: 213.191, val loss: 217.497, train acc: 0.997, val acc: 0.989
diff 51.29846997285907
epoch 11 train loss: 184.007, val loss: 194.647, train acc: 0.998, val acc: 0.990
diff 22.84988775394737
epoch 12 train loss: 161.035, val loss: 194.794, train acc: 0.998, val acc: 0.988
diff 0.14651035694583925
epoch 13 train loss: 190.729, val loss: 252.279, train acc: 0.998, val acc: 0.988
diff 57.48483941697273
epoch 14 train loss: 243.345, val loss: 239.152, train acc: 0.998, val acc: 0.989
diff 13.126258645273595
epoch 15 train loss: 78.756, val loss: 173.526, train acc: 0.999, val acc: 0.990
diff 65.62655133450531
epoch 16 train loss: 155.481, val loss: 184.761, train acc: 0.999, val acc: 0.990
diff 11.234808080449369
epoch 17 train loss: 82.229, val loss: 225.743, train acc: 0.999, val acc: 0.991
diff 40.98214009036056
epoch 18 train loss: 124.509, val loss: 175.796, train acc: 0.999, val acc: 0.995
diff 49.94715987512765
epoch 19 train loss: 166.678, val loss: 387.346, train acc: 0.999, val acc: 0.988
diff 211.55059782941964
epoch 20 train loss: 149.760, val loss: 242.049, train acc: 0.998, val acc: 0.993
diff 145.29709396930045
epoch 21 train loss: 151.788, val loss: 310.642, train acc: 0.999, val acc: 0.992
diff 68.59308009776615
epoch 22 train loss: 127.074, val loss: 429.027, train acc: 0.999, val acc: 0.991
diff 118.38487563911707
epoch 23 train loss: 109.750, val loss: 262.205, train acc: 0.999, val acc: 0.995
diff 166.82212605096532
epoch 24 train loss: 184.921, val loss: 367.684, train acc: 0.999, val acc: 0.991
diff 105.4791937663112
epoch 25 train loss: 65.583, val loss: 454.552, train acc: 0.999, val acc: 0.993
diff 86.86788467452664
epoch 26 train loss: 290.222, val loss: 432.348, train acc: 0.999, val acc: 0.994
diff 22.20415824510269
epoch 27 train loss: 155.773, val loss: 339.785, train acc: 0.999, val acc: 0.990
diff 92.56280864603082
epoch 28 train loss: 93.846, val loss: 389.610, train acc: 0.999, val acc: 0.993
diff 49.82522990629849
epoch 29 train loss: 210.471, val loss: 384.324, train acc: 0.999, val acc: 0.993
diff 5.286723455092783
epoch 30 train loss: 151.738, val loss: 645.119, train acc: 0.999, val acc: 0.990
diff 260.7954392987628
Training model M2
epoch 1 train loss: 3891.664, val loss: 178.747, train acc: 0.956, val acc: 0.984
diff inf
epoch 2 train loss: 1385.750, val loss: 173.450, train acc: 0.984, val acc: 0.986
diff 5.296613652255729
epoch 3 train loss: 828.760, val loss: 235.801, train acc: 0.990, val acc: 0.979
diff 62.3511345900817
epoch 4 train loss: 629.439, val loss: 161.379, train acc: 0.993, val acc: 0.986
diff 74.42224392517139
epoch 5 train loss: 467.241, val loss: 286.357, train acc: 0.995, val acc: 0.983
diff 124.97743601107774
epoch 6 train loss: 347.001, val loss: 166.110, train acc: 0.996, val acc: 0.988
diff 120.24673290140117
epoch 7 train loss: 408.414, val loss: 205.400, train acc: 0.996, val acc: 0.988
diff 39.289971005640666
epoch 8 train loss: 243.984, val loss: 295.652, train acc: 0.997, val acc: 0.985
diff 90.25204585976473
epoch 9 train loss: 306.530, val loss: 501.257, train acc: 0.997, val acc: 0.979
diff 205.60506962798183
epoch 10 train loss: 405.142, val loss: 258.006, train acc: 0.996, val acc: 0.989
diff 243.25099900817457
epoch 11 train loss: 208.494, val loss: 246.730, train acc: 0.998, val acc: 0.987
diff 11.275786299183011
epoch 12 train loss: 213.521, val loss: 377.595, train acc: 0.997, val acc: 0.983
diff 130.86454834549843
epoch 13 train loss: 190.922, val loss: 299.193, train acc: 0.998, val acc: 0.988
diff 78.40149511459765
epoch 14 train loss: 306.798, val loss: 244.182, train acc: 0.998, val acc: 0.989
diff 55.010973060909265
epoch 15 train loss: 300.618, val loss: 312.789, train acc: 0.997, val acc: 0.985
diff 68.6070609098667
epoch 16 train loss: 198.222, val loss: 239.484, train acc: 0.998, val acc: 0.988
diff 73.30518160839614
epoch 17 train loss: 202.173, val loss: 200.627, train acc: 0.998, val acc: 0.988
diff 38.85660294105645
epoch 18 train loss: 181.177, val loss: 419.770, train acc: 0.999, val acc: 0.989
diff 219.1425955786646
epoch 19 train loss: 214.104, val loss: 256.489, train acc: 0.998, val acc: 0.991
diff 163.28105473837928
epoch 20 train loss: 283.010, val loss: 249.336, train acc: 0.998, val acc: 0.991
diff 7.152800732538793
epoch 21 train loss: 117.034, val loss: 350.360, train acc: 0.999, val acc: 0.989
diff 101.02348530340575
epoch 22 train loss: 189.075, val loss: 428.620, train acc: 0.999, val acc: 0.990
diff 78.26007807720401
epoch 23 train loss: 168.860, val loss: 644.842, train acc: 0.999, val acc: 0.984
diff 216.22245614068117
epoch 24 train loss: 244.616, val loss: 527.053, train acc: 0.998, val acc: 0.987
diff 117.78909979838488
epoch 25 train loss: 179.200, val loss: 903.094, train acc: 0.999, val acc: 0.982
diff 376.0412931053635
epoch 26 train loss: 218.851, val loss: 625.441, train acc: 0.999, val acc: 0.986
diff 277.6529470115288
epoch 27 train loss: 194.699, val loss: 485.028, train acc: 0.999, val acc: 0.992
diff 140.41325793073514
epoch 28 train loss: 375.929, val loss: 850.194, train acc: 0.998, val acc: 0.986
diff 365.1659887418228
epoch 29 train loss: 224.871, val loss: 568.018, train acc: 0.999, val acc: 0.988
diff 282.1759867402684
epoch 30 train loss: 205.416, val loss: 716.094, train acc: 0.999, val acc: 0.987
diff 148.07571942394839
Training model M3
epoch 1 train loss: 2006.914, val loss: 480.711, train acc: 0.919, val acc: 0.954
diff inf
epoch 2 train loss: 526.127, val loss: 471.360, train acc: 0.980, val acc: 0.958
diff 9.350821575503971
epoch 3 train loss: 303.060, val loss: 672.788, train acc: 0.987, val acc: 0.941
diff 201.42775992125894
epoch 4 train loss: 176.210, val loss: 336.882, train acc: 0.992, val acc: 0.971
diff 335.90545582195284
epoch 5 train loss: 117.566, val loss: 742.705, train acc: 0.996, val acc: 0.938
diff 405.8227225898421
epoch 6 train loss: 141.546, val loss: 501.365, train acc: 0.993, val acc: 0.965
diff 241.34042703137033
epoch 7 train loss: 193.973, val loss: 722.819, train acc: 0.991, val acc: 0.951
diff 221.45422512724775
epoch 8 train loss: 95.345, val loss: 450.730, train acc: 0.996, val acc: 0.974
diff 272.0883767922077
epoch 9 train loss: 119.350, val loss: 515.183, train acc: 0.996, val acc: 0.964
diff 64.45280334815305
epoch 10 train loss: 43.464, val loss: 447.643, train acc: 0.998, val acc: 0.972
diff 67.53983569668736
epoch 11 train loss: 11.594, val loss: 752.563, train acc: 1.000, val acc: 0.958
diff 304.91969512367945
epoch 12 train loss: 128.847, val loss: 526.820, train acc: 0.995, val acc: 0.970
diff 225.74273690041298
epoch 13 train loss: 116.593, val loss: 811.584, train acc: 0.996, val acc: 0.959
diff 284.7640331702397
epoch 14 train loss: 76.706, val loss: 602.576, train acc: 0.997, val acc: 0.967
diff 209.0086860921797
epoch 15 train loss: 1.849, val loss: 583.677, train acc: 1.000, val acc: 0.973
diff 18.89863698891213
epoch 16 train loss: 0.121, val loss: 593.932, train acc: 1.000, val acc: 0.973
diff 10.255349046881975
epoch 17 train loss: 0.068, val loss: 598.802, train acc: 1.000, val acc: 0.973
diff 4.86922908399697
epoch 18 train loss: 0.048, val loss: 605.347, train acc: 1.000, val acc: 0.972
diff 6.544961445841295
epoch 19 train loss: 0.034, val loss: 611.521, train acc: 1.000, val acc: 0.972
diff 6.173919649637469
epoch 20 train loss: 0.024, val loss: 617.445, train acc: 1.000, val acc: 0.972
diff 5.924066774642142
epoch 21 train loss: 0.017, val loss: 624.913, train acc: 1.000, val acc: 0.972
diff 7.468396686616529
epoch 22 train loss: 0.011, val loss: 633.005, train acc: 1.000, val acc: 0.972
diff 8.091779199003781
epoch 23 train loss: 0.008, val loss: 642.153, train acc: 1.000, val acc: 0.972
diff 9.148521083653804
epoch 24 train loss: 0.005, val loss: 650.551, train acc: 1.000, val acc: 0.972
diff 8.397610041321627
epoch 25 train loss: 0.004, val loss: 660.183, train acc: 1.000, val acc: 0.972
diff 9.632441666028626
epoch 26 train loss: 0.002, val loss: 668.507, train acc: 1.000, val acc: 0.972
diff 8.323974739562232
epoch 27 train loss: 0.002, val loss: 680.000, train acc: 1.000, val acc: 0.972
diff 11.492161259438035
epoch 28 train loss: 0.001, val loss: 688.426, train acc: 1.000, val acc: 0.972
diff 8.426380619011184
epoch 29 train loss: 0.001, val loss: 698.089, train acc: 1.000, val acc: 0.973
diff 9.662731858798793
epoch 30 train loss: 0.000, val loss: 710.135, train acc: 1.000, val acc: 0.972
diff 12.046417863620263
Training model M3
epoch 1 train loss: 88.862, val loss: 1367.796, train acc: 0.998, val acc: 0.953
diff inf
epoch 2 train loss: 75.278, val loss: 2347.402, train acc: 0.998, val acc: 0.939
diff 979.6057829607139
epoch 3 train loss: 35.068, val loss: 1668.342, train acc: 0.999, val acc: 0.947
diff 679.0598214220481
epoch 4 train loss: 18.177, val loss: 2683.366, train acc: 0.999, val acc: 0.932
diff 1015.0240021955278
epoch 5 train loss: 104.889, val loss: 1816.253, train acc: 0.998, val acc: 0.948
diff 867.1133649910678
epoch 6 train loss: 12.440, val loss: 2198.406, train acc: 0.999, val acc: 0.941
diff 382.15299281233115
epoch 7 train loss: 57.303, val loss: 2269.641, train acc: 0.999, val acc: 0.935
diff 71.23578106637751
epoch 8 train loss: 30.804, val loss: 2979.354, train acc: 0.999, val acc: 0.916
diff 709.7121097176719
epoch 9 train loss: 10.908, val loss: 2690.907, train acc: 1.000, val acc: 0.920
diff 288.4460909026484
epoch 10 train loss: 39.248, val loss: 2769.056, train acc: 0.999, val acc: 0.918
diff 78.1480986378815
epoch 11 train loss: 56.483, val loss: 4063.084, train acc: 0.999, val acc: 0.913
diff 1294.0287194782695
epoch 12 train loss: 61.925, val loss: 4293.766, train acc: 0.998, val acc: 0.900
diff 230.68165730712963
epoch 13 train loss: 0.044, val loss: 2824.063, train acc: 1.000, val acc: 0.925
diff 1469.702488383306
epoch 14 train loss: 0.003, val loss: 2823.931, train acc: 1.000, val acc: 0.925
diff 0.13264378571147972
epoch 15 train loss: 0.002, val loss: 2822.944, train acc: 1.000, val acc: 0.925
diff 0.9871747079710076
epoch 16 train loss: 0.001, val loss: 2819.660, train acc: 1.000, val acc: 0.925
diff 3.2836926793875136
epoch 17 train loss: 0.001, val loss: 2818.388, train acc: 1.000, val acc: 0.925
diff 1.2717529831602405
epoch 18 train loss: 0.001, val loss: 2816.050, train acc: 1.000, val acc: 0.925
diff 2.3384602415139852
epoch 19 train loss: 0.001, val loss: 2812.427, train acc: 1.000, val acc: 0.925
diff 3.622776313617578
epoch 20 train loss: 0.000, val loss: 2810.053, train acc: 1.000, val acc: 0.925
diff 2.3743285192972508
epoch 21 train loss: 0.000, val loss: 2806.841, train acc: 1.000, val acc: 0.925
diff 3.211564857862413
epoch 22 train loss: 0.000, val loss: 2801.668, train acc: 1.000, val acc: 0.925
diff 5.1728463373392515
epoch 23 train loss: 0.000, val loss: 2798.593, train acc: 1.000, val acc: 0.926
diff 3.074840754899924
epoch 24 train loss: 0.000, val loss: 2794.476, train acc: 1.000, val acc: 0.925
diff 4.1172456178865104
epoch 25 train loss: 0.000, val loss: 2791.496, train acc: 1.000, val acc: 0.926
diff 2.9799306846161926
epoch 26 train loss: 0.000, val loss: 2787.899, train acc: 1.000, val acc: 0.926
diff 3.5976764955521503
epoch 27 train loss: 0.000, val loss: 2785.245, train acc: 1.000, val acc: 0.926
diff 2.6535762211542533
epoch 28 train loss: 0.000, val loss: 2784.578, train acc: 1.000, val acc: 0.926
diff 0.6671133109225593
epoch 29 train loss: 0.000, val loss: 2782.338, train acc: 1.000, val acc: 0.926
diff 2.2396927484546723
epoch 30 train loss: 0.000, val loss: 2783.008, train acc: 1.000, val acc: 0.926
diff 0.6695527034580664
Training model M3
epoch 1 train loss: 1820.426, val loss: 165.460, train acc: 0.959, val acc: 0.984
diff inf
epoch 2 train loss: 338.696, val loss: 131.807, train acc: 0.989, val acc: 0.987
diff 33.65283322570207
epoch 3 train loss: 52.672, val loss: 111.897, train acc: 0.998, val acc: 0.988
diff 19.910531030420117
epoch 4 train loss: 17.048, val loss: 133.596, train acc: 1.000, val acc: 0.988
diff 21.69890075748853
epoch 5 train loss: 4.308, val loss: 121.860, train acc: 1.000, val acc: 0.990
diff 11.735860309826052
epoch 6 train loss: 0.550, val loss: 125.557, train acc: 1.000, val acc: 0.989
diff 3.6967130475565
epoch 7 train loss: 0.248, val loss: 130.343, train acc: 1.000, val acc: 0.990
diff 4.786259500572868
epoch 8 train loss: 0.152, val loss: 134.529, train acc: 1.000, val acc: 0.989
diff 4.186428435784904
epoch 9 train loss: 0.096, val loss: 138.785, train acc: 1.000, val acc: 0.989
diff 4.256160037119798
epoch 10 train loss: 0.062, val loss: 142.473, train acc: 1.000, val acc: 0.989
diff 3.687829629253656
epoch 11 train loss: 0.039, val loss: 145.875, train acc: 1.000, val acc: 0.990
diff 3.4020124183936957
epoch 12 train loss: 0.025, val loss: 149.972, train acc: 1.000, val acc: 0.990
diff 4.096808002801595
epoch 13 train loss: 0.016, val loss: 153.551, train acc: 1.000, val acc: 0.990
diff 3.5791529934197683
epoch 14 train loss: 0.010, val loss: 157.727, train acc: 1.000, val acc: 0.990
diff 4.175544544592043
epoch 15 train loss: 0.007, val loss: 163.019, train acc: 1.000, val acc: 0.990
diff 5.291956208713117
epoch 16 train loss: 0.004, val loss: 167.603, train acc: 1.000, val acc: 0.990
diff 4.584439296783842
epoch 17 train loss: 0.003, val loss: 171.520, train acc: 1.000, val acc: 0.991
diff 3.9170553385562528
epoch 18 train loss: 0.002, val loss: 177.423, train acc: 1.000, val acc: 0.991
diff 5.902886735254015
epoch 19 train loss: 0.001, val loss: 181.681, train acc: 1.000, val acc: 0.991
diff 4.257598099415674
epoch 20 train loss: 0.001, val loss: 186.762, train acc: 1.000, val acc: 0.991
diff 5.081197117946687
epoch 21 train loss: 0.000, val loss: 191.078, train acc: 1.000, val acc: 0.991
diff 4.31587580742746
epoch 22 train loss: 0.000, val loss: 198.175, train acc: 1.000, val acc: 0.990
diff 7.097295676880748
epoch 23 train loss: 0.000, val loss: 203.432, train acc: 1.000, val acc: 0.990
diff 5.2570593614486825
epoch 24 train loss: 0.000, val loss: 208.744, train acc: 1.000, val acc: 0.990
diff 5.311559513303791
epoch 25 train loss: 0.000, val loss: 215.048, train acc: 1.000, val acc: 0.990
diff 6.304693876022981
epoch 26 train loss: 0.000, val loss: 219.720, train acc: 1.000, val acc: 0.990
diff 4.6711366166930475
epoch 27 train loss: 0.000, val loss: 224.805, train acc: 1.000, val acc: 0.990
diff 5.085945100999481
epoch 28 train loss: 0.000, val loss: 231.909, train acc: 1.000, val acc: 0.991
diff 7.103823650147774
epoch 29 train loss: 0.000, val loss: 235.253, train acc: 1.000, val acc: 0.991
diff 3.3438458426989826
epoch 30 train loss: 0.000, val loss: 241.119, train acc: 1.000, val acc: 0.991
diff 5.866278827285441
