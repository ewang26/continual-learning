Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 0, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2460.479, val loss: 123.867, train acc: 0.966, val acc: 0.985
diff inf
epoch 2 train loss: 751.943, val loss: 144.683, train acc: 0.989, val acc: 0.984
diff 20.81630358188832
epoch 3 train loss: 511.368, val loss: 79.854, train acc: 0.993, val acc: 0.992
diff 64.82912344685786
epoch 4 train loss: 335.965, val loss: 98.634, train acc: 0.996, val acc: 0.990
diff 18.779958518947694
epoch 5 train loss: 270.576, val loss: 176.650, train acc: 0.996, val acc: 0.984
diff 78.01574727013013
epoch 6 train loss: 248.534, val loss: 102.028, train acc: 0.997, val acc: 0.992
diff 74.62210952492491
epoch 7 train loss: 186.974, val loss: 217.516, train acc: 0.998, val acc: 0.983
diff 115.48791454690333
epoch 8 train loss: 187.995, val loss: 104.880, train acc: 0.998, val acc: 0.993
diff 112.63618134672296
epoch 9 train loss: 105.653, val loss: 207.513, train acc: 0.999, val acc: 0.990
diff 102.63371336295637
epoch 10 train loss: 238.589, val loss: 192.720, train acc: 0.997, val acc: 0.990
diff 14.793724677862798
epoch 11 train loss: 109.074, val loss: 192.341, train acc: 0.998, val acc: 0.988
diff 0.3787585096973203
epoch 12 train loss: 146.593, val loss: 235.447, train acc: 0.998, val acc: 0.988
diff 43.10576542588595
epoch 13 train loss: 169.000, val loss: 230.418, train acc: 0.998, val acc: 0.989
diff 5.028207785257678
epoch 14 train loss: 132.325, val loss: 149.656, train acc: 0.999, val acc: 0.993
diff 80.76241687755589
epoch 15 train loss: 176.239, val loss: 253.028, train acc: 0.998, val acc: 0.991
diff 103.37248617215067
epoch 16 train loss: 224.191, val loss: 220.455, train acc: 0.998, val acc: 0.988
diff 32.57297524898732
epoch 17 train loss: 83.563, val loss: 245.031, train acc: 0.999, val acc: 0.993
diff 24.57601439234449
epoch 18 train loss: 173.449, val loss: 429.874, train acc: 0.998, val acc: 0.983
diff 184.84254384309915
epoch 19 train loss: 131.923, val loss: 239.847, train acc: 0.999, val acc: 0.991
diff 190.02667134334376
epoch 20 train loss: 66.802, val loss: 293.522, train acc: 0.999, val acc: 0.991
diff 53.67450119463143
epoch 21 train loss: 145.397, val loss: 300.446, train acc: 0.999, val acc: 0.993
diff 6.924622797660504
epoch 22 train loss: 65.943, val loss: 219.236, train acc: 0.999, val acc: 0.993
diff 81.21065837135902
epoch 23 train loss: 154.884, val loss: 485.105, train acc: 0.999, val acc: 0.990
diff 265.86929289090074
epoch 24 train loss: 119.563, val loss: 347.153, train acc: 0.999, val acc: 0.993
diff 137.95195167568323
epoch 25 train loss: 53.499, val loss: 463.770, train acc: 1.000, val acc: 0.993
diff 116.61706645128987
epoch 26 train loss: 118.556, val loss: 543.743, train acc: 0.999, val acc: 0.990
diff 79.9731455244945
epoch 27 train loss: 184.565, val loss: 465.612, train acc: 0.999, val acc: 0.993
diff 78.13142717839287
epoch 28 train loss: 139.708, val loss: 414.508, train acc: 0.999, val acc: 0.993
diff 51.1040508953202
epoch 29 train loss: 42.346, val loss: 509.927, train acc: 1.000, val acc: 0.988
diff 95.41876322635915
epoch 30 train loss: 259.128, val loss: 689.539, train acc: 0.999, val acc: 0.990
diff 179.61226585042306
Training model M2
epoch 1 train loss: 3961.719, val loss: 195.544, train acc: 0.954, val acc: 0.982
diff inf
epoch 2 train loss: 1342.979, val loss: 182.945, train acc: 0.985, val acc: 0.980
diff 12.598877379213548
epoch 3 train loss: 806.433, val loss: 175.748, train acc: 0.990, val acc: 0.987
diff 7.197019188008397
epoch 4 train loss: 516.708, val loss: 252.243, train acc: 0.994, val acc: 0.983
diff 76.49493782697152
epoch 5 train loss: 448.004, val loss: 189.288, train acc: 0.995, val acc: 0.984
diff 62.95501305636623
epoch 6 train loss: 338.444, val loss: 208.393, train acc: 0.996, val acc: 0.988
diff 19.10450550824521
epoch 7 train loss: 318.691, val loss: 326.500, train acc: 0.997, val acc: 0.982
diff 118.1069705763125
epoch 8 train loss: 322.019, val loss: 302.493, train acc: 0.997, val acc: 0.985
diff 24.00687658684575
epoch 9 train loss: 350.785, val loss: 291.530, train acc: 0.997, val acc: 0.986
diff 10.962551214275095
epoch 10 train loss: 249.416, val loss: 285.837, train acc: 0.997, val acc: 0.987
diff 5.69360777487401
epoch 11 train loss: 277.474, val loss: 367.489, train acc: 0.997, val acc: 0.984
diff 81.65229146592878
epoch 12 train loss: 289.627, val loss: 348.853, train acc: 0.998, val acc: 0.986
diff 18.635888554603525
epoch 13 train loss: 309.080, val loss: 417.886, train acc: 0.997, val acc: 0.984
diff 69.03315738510878
epoch 14 train loss: 198.523, val loss: 391.277, train acc: 0.998, val acc: 0.985
diff 26.609371865250807
epoch 15 train loss: 254.119, val loss: 369.885, train acc: 0.998, val acc: 0.986
diff 21.39240351571624
epoch 16 train loss: 314.125, val loss: 352.788, train acc: 0.998, val acc: 0.987
diff 17.096436951261353
epoch 17 train loss: 272.765, val loss: 363.371, train acc: 0.998, val acc: 0.988
diff 10.582855819781514
epoch 18 train loss: 158.955, val loss: 500.804, train acc: 0.998, val acc: 0.984
diff 137.43320484993063
epoch 19 train loss: 282.369, val loss: 545.306, train acc: 0.998, val acc: 0.987
diff 44.50185719938344
epoch 20 train loss: 321.790, val loss: 615.602, train acc: 0.998, val acc: 0.984
diff 70.29579667558198
epoch 21 train loss: 213.896, val loss: 558.099, train acc: 0.998, val acc: 0.985
diff 57.50327483076478
epoch 22 train loss: 246.735, val loss: 704.736, train acc: 0.999, val acc: 0.986
diff 146.63778296260716
epoch 23 train loss: 306.876, val loss: 643.754, train acc: 0.999, val acc: 0.984
diff 60.98263926405434
epoch 24 train loss: 153.778, val loss: 558.054, train acc: 0.999, val acc: 0.987
diff 85.69994535812964
epoch 25 train loss: 199.010, val loss: 567.798, train acc: 0.999, val acc: 0.984
diff 9.743845894447759
epoch 26 train loss: 244.243, val loss: 821.600, train acc: 0.998, val acc: 0.982
diff 253.8026548850512
epoch 27 train loss: 254.232, val loss: 574.753, train acc: 0.999, val acc: 0.990
diff 246.84764061477915
epoch 28 train loss: 174.047, val loss: 684.736, train acc: 0.999, val acc: 0.982
diff 109.98336334336398
epoch 29 train loss: 258.359, val loss: 933.943, train acc: 0.999, val acc: 0.985
diff 249.2071675748382
epoch 30 train loss: 207.371, val loss: 1037.522, train acc: 0.999, val acc: 0.985
diff 103.57874493368331
Training model M3
epoch 1 train loss: 2017.010, val loss: 482.736, train acc: 0.921, val acc: 0.954
diff inf
epoch 2 train loss: 529.637, val loss: 514.977, train acc: 0.977, val acc: 0.953
diff 32.24083159188382
epoch 3 train loss: 225.456, val loss: 618.986, train acc: 0.991, val acc: 0.952
diff 104.00922975095034
epoch 4 train loss: 177.809, val loss: 458.870, train acc: 0.993, val acc: 0.964
diff 160.11593074961536
epoch 5 train loss: 138.139, val loss: 547.164, train acc: 0.994, val acc: 0.964
diff 88.29418753300206
epoch 6 train loss: 174.350, val loss: 859.061, train acc: 0.992, val acc: 0.938
diff 311.8966331468706
epoch 7 train loss: 112.525, val loss: 559.380, train acc: 0.994, val acc: 0.968
diff 299.68120785896394
epoch 8 train loss: 64.322, val loss: 643.780, train acc: 0.997, val acc: 0.966
diff 84.40057990579464
epoch 9 train loss: 77.313, val loss: 595.212, train acc: 0.997, val acc: 0.960
diff 48.56832167650953
epoch 10 train loss: 145.674, val loss: 874.210, train acc: 0.995, val acc: 0.951
diff 278.9981274949612
epoch 11 train loss: 45.849, val loss: 573.969, train acc: 0.998, val acc: 0.967
diff 300.2413977350558
epoch 12 train loss: 25.441, val loss: 827.804, train acc: 0.999, val acc: 0.955
diff 253.83562418766985
epoch 13 train loss: 145.421, val loss: 625.295, train acc: 0.996, val acc: 0.968
diff 202.509629279372
epoch 14 train loss: 10.725, val loss: 664.740, train acc: 0.999, val acc: 0.968
diff 39.44531816765948
epoch 15 train loss: 45.135, val loss: 801.803, train acc: 0.998, val acc: 0.961
diff 137.06248706171345
epoch 16 train loss: 161.040, val loss: 668.175, train acc: 0.995, val acc: 0.963
diff 133.6272314624589
epoch 17 train loss: 59.524, val loss: 1052.156, train acc: 0.998, val acc: 0.953
diff 383.9802723636135
epoch 18 train loss: 104.793, val loss: 943.457, train acc: 0.996, val acc: 0.953
diff 108.69813783520738
epoch 19 train loss: 36.896, val loss: 779.443, train acc: 0.999, val acc: 0.957
diff 164.01454013808393
epoch 20 train loss: 1.035, val loss: 761.698, train acc: 1.000, val acc: 0.962
diff 17.745160500978386
epoch 21 train loss: 0.087, val loss: 785.572, train acc: 1.000, val acc: 0.965
diff 23.874481601628872
epoch 22 train loss: 0.009, val loss: 744.031, train acc: 1.000, val acc: 0.966
diff 41.54162883714548
epoch 23 train loss: 0.004, val loss: 796.327, train acc: 1.000, val acc: 0.966
diff 52.29617790012844
epoch 24 train loss: 0.002, val loss: 805.974, train acc: 1.000, val acc: 0.967
diff 9.646860780685984
epoch 25 train loss: 0.001, val loss: 804.844, train acc: 1.000, val acc: 0.968
diff 1.1300965496025128
epoch 26 train loss: 0.001, val loss: 826.750, train acc: 1.000, val acc: 0.967
diff 21.906853177203402
epoch 27 train loss: 0.000, val loss: 816.490, train acc: 1.000, val acc: 0.967
diff 10.260108055579053
epoch 28 train loss: 0.000, val loss: 853.231, train acc: 1.000, val acc: 0.966
diff 36.74058556025841
epoch 29 train loss: 0.000, val loss: 860.301, train acc: 1.000, val acc: 0.966
diff 7.070215545876408
epoch 30 train loss: 0.000, val loss: 876.814, train acc: 1.000, val acc: 0.966
diff 16.51297235872596
Training model M3
epoch 1 train loss: 117.009, val loss: 1966.145, train acc: 0.998, val acc: 0.930
diff inf
epoch 2 train loss: 6.569, val loss: 1760.844, train acc: 1.000, val acc: 0.945
diff 205.30064946924222
epoch 3 train loss: 80.949, val loss: 3132.378, train acc: 0.997, val acc: 0.920
diff 1371.5341234736304
epoch 4 train loss: 71.316, val loss: 3283.822, train acc: 0.998, val acc: 0.928
diff 151.44393614101273
epoch 5 train loss: 0.059, val loss: 3493.961, train acc: 1.000, val acc: 0.927
diff 210.1389621114481
epoch 6 train loss: 0.003, val loss: 3617.214, train acc: 1.000, val acc: 0.926
diff 123.25277569634318
epoch 7 train loss: 0.002, val loss: 3609.491, train acc: 1.000, val acc: 0.926
diff 7.723291284590687
epoch 8 train loss: 0.002, val loss: 3602.880, train acc: 1.000, val acc: 0.926
diff 6.610433459397427
epoch 9 train loss: 0.001, val loss: 3598.542, train acc: 1.000, val acc: 0.926
diff 4.33822174363786
epoch 10 train loss: 0.001, val loss: 3594.032, train acc: 1.000, val acc: 0.926
diff 4.510325752747576
epoch 11 train loss: 0.001, val loss: 3591.132, train acc: 1.000, val acc: 0.927
diff 2.8995464009349234
epoch 12 train loss: 0.000, val loss: 3588.577, train acc: 1.000, val acc: 0.927
diff 2.555094706294767
epoch 13 train loss: 0.000, val loss: 3588.945, train acc: 1.000, val acc: 0.928
diff 0.36791576602081477
epoch 14 train loss: 0.000, val loss: 3588.170, train acc: 1.000, val acc: 0.928
diff 0.7754380426531498
epoch 15 train loss: 0.000, val loss: 3588.602, train acc: 1.000, val acc: 0.928
diff 0.432401991405186
epoch 16 train loss: 0.000, val loss: 3588.946, train acc: 1.000, val acc: 0.929
diff 0.34454522444275426
epoch 17 train loss: 0.000, val loss: 3593.281, train acc: 1.000, val acc: 0.929
diff 4.33464914807746
epoch 18 train loss: 0.000, val loss: 3596.510, train acc: 1.000, val acc: 0.929
diff 3.229353957619878
epoch 19 train loss: 0.000, val loss: 3599.802, train acc: 1.000, val acc: 0.929
diff 3.2914808881050703
epoch 20 train loss: 0.000, val loss: 3605.841, train acc: 1.000, val acc: 0.928
diff 6.03938535275438
epoch 21 train loss: 0.000, val loss: 3611.656, train acc: 1.000, val acc: 0.928
diff 5.814345081155352
epoch 22 train loss: 0.000, val loss: 3618.781, train acc: 1.000, val acc: 0.928
diff 7.125704051002231
epoch 23 train loss: 0.000, val loss: 3625.693, train acc: 1.000, val acc: 0.928
diff 6.9120944670380595
epoch 24 train loss: 0.000, val loss: 3633.434, train acc: 1.000, val acc: 0.928
diff 7.740733752784308
epoch 25 train loss: 0.000, val loss: 3646.145, train acc: 1.000, val acc: 0.928
diff 12.711023419437424
epoch 26 train loss: 0.000, val loss: 3655.125, train acc: 1.000, val acc: 0.928
diff 8.979556294725171
epoch 27 train loss: 0.000, val loss: 3669.739, train acc: 1.000, val acc: 0.928
diff 14.614111842419334
epoch 28 train loss: 0.000, val loss: 3681.396, train acc: 1.000, val acc: 0.927
diff 11.656963913918844
epoch 29 train loss: 0.000, val loss: 3692.329, train acc: 1.000, val acc: 0.928
diff 10.932647513394386
epoch 30 train loss: 0.000, val loss: 3707.092, train acc: 1.000, val acc: 0.927
diff 14.763809399385536
Training model M3
epoch 1 train loss: 1708.245, val loss: 174.164, train acc: 0.960, val acc: 0.983
diff inf
epoch 2 train loss: 287.487, val loss: 124.116, train acc: 0.989, val acc: 0.988
diff 50.047694826976695
epoch 3 train loss: 76.270, val loss: 129.166, train acc: 0.997, val acc: 0.990
diff 5.049796246043869
epoch 4 train loss: 41.585, val loss: 184.507, train acc: 0.999, val acc: 0.986
diff 55.34046884628037
epoch 5 train loss: 138.547, val loss: 221.248, train acc: 0.994, val acc: 0.988
diff 36.74097624733187
epoch 6 train loss: 109.078, val loss: 237.534, train acc: 0.997, val acc: 0.985
diff 16.28655744361319
epoch 7 train loss: 107.179, val loss: 396.746, train acc: 0.995, val acc: 0.982
diff 159.2119832476928
epoch 8 train loss: 115.767, val loss: 272.314, train acc: 0.995, val acc: 0.986
diff 124.4324669470846
epoch 9 train loss: 33.646, val loss: 241.485, train acc: 0.998, val acc: 0.988
diff 30.828747378797573
epoch 10 train loss: 117.321, val loss: 287.078, train acc: 0.996, val acc: 0.987
diff 45.59269080976645
epoch 11 train loss: 1.048, val loss: 251.499, train acc: 1.000, val acc: 0.988
diff 35.57871853721065
epoch 12 train loss: 0.165, val loss: 251.215, train acc: 1.000, val acc: 0.989
diff 0.2835350730129278
epoch 13 train loss: 0.071, val loss: 252.264, train acc: 1.000, val acc: 0.989
diff 1.0484231393251378
epoch 14 train loss: 0.049, val loss: 254.189, train acc: 1.000, val acc: 0.990
diff 1.925080260028011
epoch 15 train loss: 0.034, val loss: 256.078, train acc: 1.000, val acc: 0.990
diff 1.889270187700987
epoch 16 train loss: 0.024, val loss: 258.712, train acc: 1.000, val acc: 0.990
diff 2.633674566456591
epoch 17 train loss: 0.016, val loss: 261.601, train acc: 1.000, val acc: 0.990
diff 2.8892927868490688
epoch 18 train loss: 0.011, val loss: 265.311, train acc: 1.000, val acc: 0.990
diff 3.7100903621648627
epoch 19 train loss: 0.007, val loss: 269.125, train acc: 1.000, val acc: 0.990
diff 3.81379228792116
epoch 20 train loss: 0.005, val loss: 273.425, train acc: 1.000, val acc: 0.990
diff 4.300271478551622
epoch 21 train loss: 0.003, val loss: 278.243, train acc: 1.000, val acc: 0.990
diff 4.8180770127387405
epoch 22 train loss: 0.002, val loss: 281.473, train acc: 1.000, val acc: 0.990
diff 3.2294646276820913
epoch 23 train loss: 0.001, val loss: 285.859, train acc: 1.000, val acc: 0.990
diff 4.386170135866848
epoch 24 train loss: 0.001, val loss: 290.643, train acc: 1.000, val acc: 0.990
diff 4.784533290067543
epoch 25 train loss: 0.001, val loss: 295.259, train acc: 1.000, val acc: 0.990
diff 4.615666552066898
epoch 26 train loss: 0.000, val loss: 300.448, train acc: 1.000, val acc: 0.990
diff 5.188843639032086
epoch 27 train loss: 0.000, val loss: 305.956, train acc: 1.000, val acc: 0.990
diff 5.50817635476443
epoch 28 train loss: 0.000, val loss: 312.430, train acc: 1.000, val acc: 0.990
diff 6.474320286477564
epoch 29 train loss: 0.000, val loss: 318.268, train acc: 1.000, val acc: 0.990
diff 5.837658741025223
epoch 30 train loss: 0.000, val loss: 327.765, train acc: 1.000, val acc: 0.990
diff 9.496654653437758
2
2
