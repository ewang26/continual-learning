Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 1, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2413.907, val loss: 187.938, train acc: 0.965, val acc: 0.976
diff inf
epoch 2 train loss: 813.982, val loss: 125.166, train acc: 0.989, val acc: 0.984
diff 62.77117558104118
epoch 3 train loss: 489.248, val loss: 85.710, train acc: 0.993, val acc: 0.991
diff 39.45686628513296
epoch 4 train loss: 288.334, val loss: 104.458, train acc: 0.996, val acc: 0.990
diff 18.74832901783327
epoch 5 train loss: 267.391, val loss: 125.659, train acc: 0.996, val acc: 0.988
diff 21.201047528886036
epoch 6 train loss: 280.558, val loss: 125.759, train acc: 0.997, val acc: 0.988
diff 0.09978302265392358
Training model M2
epoch 1 train loss: 3923.168, val loss: 236.680, train acc: 0.956, val acc: 0.978
diff inf
epoch 2 train loss: 1305.400, val loss: 162.244, train acc: 0.985, val acc: 0.986
diff 74.43608669390093
epoch 3 train loss: 768.521, val loss: 175.086, train acc: 0.991, val acc: 0.987
diff 12.842566983735878
epoch 4 train loss: 570.503, val loss: 298.701, train acc: 0.993, val acc: 0.981
diff 123.61505330963709
epoch 5 train loss: 423.977, val loss: 158.749, train acc: 0.995, val acc: 0.988
diff 139.95244052733813
epoch 6 train loss: 339.352, val loss: 230.515, train acc: 0.996, val acc: 0.983
diff 71.76622713520095
epoch 7 train loss: 383.264, val loss: 237.264, train acc: 0.996, val acc: 0.988
diff 6.748704035967108
epoch 8 train loss: 304.341, val loss: 300.985, train acc: 0.997, val acc: 0.985
diff 63.72153576871139
epoch 9 train loss: 279.952, val loss: 230.285, train acc: 0.997, val acc: 0.986
diff 70.70055201008975
epoch 10 train loss: 267.120, val loss: 229.492, train acc: 0.998, val acc: 0.989
diff 0.792394160394366
epoch 11 train loss: 322.671, val loss: 242.317, train acc: 0.997, val acc: 0.990
diff 12.824580393291257
epoch 12 train loss: 243.870, val loss: 351.678, train acc: 0.998, val acc: 0.985
diff 109.3607132916757
epoch 13 train loss: 263.577, val loss: 483.205, train acc: 0.998, val acc: 0.985
diff 131.52714026260924
epoch 14 train loss: 106.352, val loss: 268.736, train acc: 0.999, val acc: 0.990
diff 214.46903977765965
epoch 15 train loss: 407.881, val loss: 495.123, train acc: 0.997, val acc: 0.982
diff 226.3877317967083
epoch 16 train loss: 262.569, val loss: 526.106, train acc: 0.998, val acc: 0.986
diff 30.982715467989976
epoch 17 train loss: 261.285, val loss: 398.967, train acc: 0.998, val acc: 0.987
diff 127.13881986185936
epoch 18 train loss: 256.962, val loss: 438.751, train acc: 0.998, val acc: 0.987
diff 39.783182691203706
epoch 19 train loss: 208.595, val loss: 550.447, train acc: 0.999, val acc: 0.987
diff 111.69621035305693
epoch 20 train loss: 73.937, val loss: 592.893, train acc: 0.999, val acc: 0.985
diff 42.44586453034799
epoch 21 train loss: 344.466, val loss: 562.451, train acc: 0.998, val acc: 0.987
diff 30.441506178571785
epoch 22 train loss: 301.086, val loss: 571.680, train acc: 0.999, val acc: 0.986
diff 9.228509067370851
epoch 23 train loss: 269.500, val loss: 494.105, train acc: 0.998, val acc: 0.987
diff 77.5749017693779
epoch 24 train loss: 189.265, val loss: 615.590, train acc: 0.999, val acc: 0.986
diff 121.48494742713012
epoch 25 train loss: 213.409, val loss: 468.094, train acc: 0.999, val acc: 0.988
diff 147.4959268193884
epoch 26 train loss: 113.920, val loss: 681.749, train acc: 0.999, val acc: 0.988
diff 213.65510504379415
epoch 27 train loss: 357.458, val loss: 602.987, train acc: 0.999, val acc: 0.987
diff 78.7617482325162
epoch 28 train loss: 242.939, val loss: 669.716, train acc: 0.999, val acc: 0.985
diff 66.7290027094723
epoch 29 train loss: 320.846, val loss: 873.372, train acc: 0.999, val acc: 0.986
diff 203.6562263860102
epoch 30 train loss: 251.406, val loss: 716.008, train acc: 0.999, val acc: 0.987
diff 157.36397347828733
Training model M3
epoch 1 train loss: 1705.745, val loss: 915.969, train acc: 0.919, val acc: 0.897
diff inf
epoch 2 train loss: 421.065, val loss: 647.018, train acc: 0.980, val acc: 0.940
diff 268.95134987758024
epoch 3 train loss: 254.377, val loss: 673.880, train acc: 0.988, val acc: 0.937
diff 26.861615242459266
epoch 4 train loss: 169.174, val loss: 623.502, train acc: 0.992, val acc: 0.953
diff 50.3772209511269
epoch 5 train loss: 142.636, val loss: 982.757, train acc: 0.992, val acc: 0.936
diff 359.2546948044687
epoch 6 train loss: 66.676, val loss: 871.241, train acc: 0.998, val acc: 0.933
diff 111.5163447454189
epoch 7 train loss: 115.213, val loss: 769.722, train acc: 0.995, val acc: 0.943
diff 101.51853469227888
epoch 8 train loss: 90.919, val loss: 787.498, train acc: 0.996, val acc: 0.941
diff 17.775916285629023
epoch 9 train loss: 75.113, val loss: 1186.902, train acc: 0.996, val acc: 0.921
diff 399.4035253582557
epoch 10 train loss: 119.295, val loss: 691.681, train acc: 0.994, val acc: 0.953
diff 495.22073963508126
epoch 11 train loss: 31.304, val loss: 943.442, train acc: 0.999, val acc: 0.950
diff 251.76119539932847
epoch 12 train loss: 32.216, val loss: 1550.505, train acc: 0.999, val acc: 0.913
diff 607.0625871339834
epoch 13 train loss: 17.014, val loss: 1062.745, train acc: 0.999, val acc: 0.949
diff 487.75987269420375
epoch 14 train loss: 101.941, val loss: 900.481, train acc: 0.996, val acc: 0.947
diff 162.2637087452066
epoch 15 train loss: 75.319, val loss: 1260.804, train acc: 0.997, val acc: 0.946
diff 360.32234747481823
epoch 16 train loss: 53.872, val loss: 1709.552, train acc: 0.998, val acc: 0.918
diff 448.7488204786621
epoch 17 train loss: 60.655, val loss: 1445.077, train acc: 0.997, val acc: 0.942
diff 264.4751385184511
epoch 18 train loss: 13.652, val loss: 1673.448, train acc: 1.000, val acc: 0.934
diff 228.37056113072344
epoch 19 train loss: 0.628, val loss: 1384.392, train acc: 1.000, val acc: 0.948
diff 289.0553636830282
epoch 20 train loss: 0.070, val loss: 1394.032, train acc: 1.000, val acc: 0.947
diff 9.63940350644134
epoch 21 train loss: 0.023, val loss: 1382.585, train acc: 1.000, val acc: 0.948
diff 11.447143746827123
epoch 22 train loss: 0.017, val loss: 1379.570, train acc: 1.000, val acc: 0.949
diff 3.015025955885676
epoch 23 train loss: 0.013, val loss: 1380.363, train acc: 1.000, val acc: 0.949
diff 0.7938014174151249
epoch 24 train loss: 0.010, val loss: 1382.688, train acc: 1.000, val acc: 0.950
diff 2.3245059418768506
epoch 25 train loss: 0.008, val loss: 1385.865, train acc: 1.000, val acc: 0.950
diff 3.177246226986881
epoch 26 train loss: 0.006, val loss: 1390.208, train acc: 1.000, val acc: 0.950
diff 4.342302382862044
epoch 27 train loss: 0.005, val loss: 1396.994, train acc: 1.000, val acc: 0.950
diff 6.786215187547441
epoch 28 train loss: 0.003, val loss: 1402.413, train acc: 1.000, val acc: 0.950
diff 5.419187932976229
epoch 29 train loss: 0.003, val loss: 1411.948, train acc: 1.000, val acc: 0.951
diff 9.535487190403956
epoch 30 train loss: 0.002, val loss: 1419.118, train acc: 1.000, val acc: 0.951
diff 7.169223298337101
Training model M3
epoch 1 train loss: 57.298, val loss: 3817.460, train acc: 0.998, val acc: 0.895
diff inf
epoch 2 train loss: 1.357, val loss: 3880.660, train acc: 1.000, val acc: 0.910
diff 63.200403520558666
epoch 3 train loss: 0.000, val loss: 3902.220, train acc: 1.000, val acc: 0.910
diff 21.560210295384422
epoch 4 train loss: 0.000, val loss: 3888.979, train acc: 1.000, val acc: 0.910
diff 13.241798078253396
epoch 5 train loss: 0.000, val loss: 3884.749, train acc: 1.000, val acc: 0.910
diff 4.2292139638211665
epoch 6 train loss: 0.000, val loss: 3881.185, train acc: 1.000, val acc: 0.911
diff 3.5648564848829665
epoch 7 train loss: 0.000, val loss: 3882.834, train acc: 1.000, val acc: 0.911
diff 1.6491555308280113
epoch 8 train loss: 0.000, val loss: 3865.592, train acc: 1.000, val acc: 0.911
diff 17.241612583929054
epoch 9 train loss: 0.000, val loss: 3873.645, train acc: 1.000, val acc: 0.912
diff 8.05284105117562
epoch 10 train loss: 0.000, val loss: 3876.846, train acc: 1.000, val acc: 0.912
diff 3.201423396531027
epoch 11 train loss: 0.000, val loss: 3879.887, train acc: 1.000, val acc: 0.913
diff 3.0409438267192854
epoch 12 train loss: 0.000, val loss: 3879.439, train acc: 1.000, val acc: 0.914
diff 0.44866882897395044
epoch 13 train loss: 0.000, val loss: 3906.322, train acc: 1.000, val acc: 0.912
diff 26.883011871560484
epoch 14 train loss: 0.000, val loss: 3907.369, train acc: 1.000, val acc: 0.912
diff 1.0477449409004294
epoch 15 train loss: 0.000, val loss: 3914.657, train acc: 1.000, val acc: 0.912
diff 7.287914648112292
epoch 16 train loss: 0.000, val loss: 3913.632, train acc: 1.000, val acc: 0.914
diff 1.0251652644369642
epoch 17 train loss: 0.000, val loss: 3938.155, train acc: 1.000, val acc: 0.912
diff 24.523126263991344
epoch 18 train loss: 0.000, val loss: 3944.515, train acc: 1.000, val acc: 0.913
diff 6.3601276173963015
epoch 19 train loss: 0.000, val loss: 3956.765, train acc: 1.000, val acc: 0.913
diff 12.249468921868356
epoch 20 train loss: 0.000, val loss: 3954.824, train acc: 1.000, val acc: 0.914
diff 1.9408528988510625
epoch 21 train loss: 0.000, val loss: 3960.145, train acc: 1.000, val acc: 0.915
diff 5.320780337341148
epoch 22 train loss: 0.000, val loss: 3986.942, train acc: 1.000, val acc: 0.914
diff 26.7976763719671
epoch 23 train loss: 0.000, val loss: 3976.277, train acc: 1.000, val acc: 0.916
diff 10.665324415247142
epoch 24 train loss: 0.000, val loss: 3985.715, train acc: 1.000, val acc: 0.916
diff 9.437774676236586
epoch 25 train loss: 0.000, val loss: 3986.696, train acc: 1.000, val acc: 0.916
diff 0.9810773077742851
epoch 26 train loss: 0.000, val loss: 3994.868, train acc: 1.000, val acc: 0.916
diff 8.17186306729809
epoch 27 train loss: 0.000, val loss: 4014.140, train acc: 1.000, val acc: 0.915
diff 19.272301316573248
epoch 28 train loss: 0.000, val loss: 4016.536, train acc: 1.000, val acc: 0.915
diff 2.3956745088812568
epoch 29 train loss: 0.000, val loss: 4037.616, train acc: 1.000, val acc: 0.915
diff 21.080538631182208
epoch 30 train loss: 0.000, val loss: 4047.701, train acc: 1.000, val acc: 0.915
diff 10.084399767822106
Training model M3
epoch 1 train loss: 1578.742, val loss: 329.469, train acc: 0.961, val acc: 0.967
diff inf
epoch 2 train loss: 255.859, val loss: 272.045, train acc: 0.989, val acc: 0.978
diff 57.42385318511373
epoch 3 train loss: 61.435, val loss: 335.155, train acc: 0.998, val acc: 0.972
diff 63.109395888951326
epoch 4 train loss: 19.738, val loss: 407.822, train acc: 0.999, val acc: 0.973
diff 72.66760561308905
epoch 5 train loss: 4.647, val loss: 396.754, train acc: 1.000, val acc: 0.976
diff 11.068080637201888
epoch 6 train loss: 0.567, val loss: 401.877, train acc: 1.000, val acc: 0.977
diff 5.122518532384106
epoch 7 train loss: 0.244, val loss: 407.019, train acc: 1.000, val acc: 0.978
diff 5.141910438099956
epoch 8 train loss: 0.157, val loss: 414.303, train acc: 1.000, val acc: 0.978
diff 7.284530969923708
epoch 9 train loss: 0.104, val loss: 421.835, train acc: 1.000, val acc: 0.978
diff 7.531274644830489
epoch 10 train loss: 0.072, val loss: 429.154, train acc: 1.000, val acc: 0.978
diff 7.319831439003053
epoch 11 train loss: 0.049, val loss: 435.268, train acc: 1.000, val acc: 0.978
diff 6.113382855322925
epoch 12 train loss: 0.034, val loss: 443.434, train acc: 1.000, val acc: 0.978
diff 8.166544759191027
epoch 13 train loss: 0.023, val loss: 451.244, train acc: 1.000, val acc: 0.979
diff 7.810043309346895
epoch 14 train loss: 0.016, val loss: 460.609, train acc: 1.000, val acc: 0.979
diff 9.364197761213518
epoch 15 train loss: 0.011, val loss: 469.636, train acc: 1.000, val acc: 0.979
diff 9.027688571592762
epoch 16 train loss: 0.008, val loss: 476.268, train acc: 1.000, val acc: 0.979
diff 6.631301898256538
epoch 17 train loss: 0.005, val loss: 486.185, train acc: 1.000, val acc: 0.979
diff 9.917014715485209
epoch 18 train loss: 0.004, val loss: 492.369, train acc: 1.000, val acc: 0.979
diff 6.184240505719913
epoch 19 train loss: 0.002, val loss: 501.537, train acc: 1.000, val acc: 0.979
diff 9.16821632265993
epoch 20 train loss: 0.002, val loss: 512.723, train acc: 1.000, val acc: 0.980
diff 11.186233170128276
epoch 21 train loss: 0.001, val loss: 520.045, train acc: 1.000, val acc: 0.980
diff 7.3216712829357675
epoch 22 train loss: 0.001, val loss: 529.485, train acc: 1.000, val acc: 0.979
diff 9.439735277965951
epoch 23 train loss: 0.001, val loss: 541.216, train acc: 1.000, val acc: 0.979
diff 11.73119159111286
epoch 24 train loss: 0.000, val loss: 544.584, train acc: 1.000, val acc: 0.979
diff 3.3679671266776268
epoch 25 train loss: 0.000, val loss: 558.979, train acc: 1.000, val acc: 0.979
diff 14.394946530345806
epoch 26 train loss: 0.000, val loss: 563.950, train acc: 1.000, val acc: 0.979
diff 4.971163064434904
epoch 27 train loss: 0.000, val loss: 580.263, train acc: 1.000, val acc: 0.978
diff 16.313350887162073
epoch 28 train loss: 0.000, val loss: 592.910, train acc: 1.000, val acc: 0.978
diff 12.647017403403083
epoch 29 train loss: 0.000, val loss: 596.828, train acc: 1.000, val acc: 0.978
diff 3.917832176373963
epoch 30 train loss: 0.000, val loss: 609.865, train acc: 1.000, val acc: 0.977
diff 13.036964138776966
3
2
2
2
2
2
2
2
2
2
