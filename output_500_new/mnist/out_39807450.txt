Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 17, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2436.548, val loss: 106.665, train acc: 0.966, val acc: 0.988
diff inf
epoch 2 train loss: 799.222, val loss: 140.978, train acc: 0.988, val acc: 0.984
diff 34.312567975301675
epoch 3 train loss: 492.365, val loss: 139.784, train acc: 0.993, val acc: 0.985
diff 1.1940115527302169
epoch 4 train loss: 337.328, val loss: 118.658, train acc: 0.995, val acc: 0.990
diff 21.125384528263083
epoch 5 train loss: 312.605, val loss: 132.432, train acc: 0.995, val acc: 0.989
diff 13.773547003888524
epoch 6 train loss: 215.002, val loss: 98.599, train acc: 0.997, val acc: 0.993
diff 33.833225536629485
epoch 7 train loss: 194.868, val loss: 116.885, train acc: 0.997, val acc: 0.993
diff 18.2868391518265
epoch 8 train loss: 282.812, val loss: 153.609, train acc: 0.997, val acc: 0.991
diff 36.7237677835611
epoch 9 train loss: 181.563, val loss: 154.743, train acc: 0.998, val acc: 0.991
diff 1.1343159593259315
epoch 10 train loss: 104.868, val loss: 200.990, train acc: 0.999, val acc: 0.990
diff 46.24624753267099
epoch 11 train loss: 196.670, val loss: 314.244, train acc: 0.997, val acc: 0.989
diff 113.2545621439227
epoch 12 train loss: 174.474, val loss: 216.585, train acc: 0.998, val acc: 0.991
diff 97.65945587455329
epoch 13 train loss: 190.017, val loss: 236.568, train acc: 0.998, val acc: 0.990
diff 19.983070074271694
epoch 14 train loss: 127.794, val loss: 225.536, train acc: 0.999, val acc: 0.990
diff 11.03168885642782
epoch 15 train loss: 104.785, val loss: 371.653, train acc: 0.999, val acc: 0.990
diff 146.11689500461893
epoch 16 train loss: 213.679, val loss: 377.632, train acc: 0.998, val acc: 0.987
diff 5.978488445346784
epoch 17 train loss: 186.560, val loss: 348.622, train acc: 0.998, val acc: 0.990
diff 29.010021683335594
epoch 18 train loss: 221.075, val loss: 351.370, train acc: 0.998, val acc: 0.989
diff 2.748878135430232
epoch 19 train loss: 130.425, val loss: 344.245, train acc: 0.999, val acc: 0.988
diff 7.1253958994548725
epoch 20 train loss: 152.257, val loss: 303.900, train acc: 0.999, val acc: 0.989
diff 40.34459412698476
epoch 21 train loss: 106.749, val loss: 295.722, train acc: 0.999, val acc: 0.993
diff 8.178133684149714
epoch 22 train loss: 130.970, val loss: 449.775, train acc: 0.999, val acc: 0.988
diff 154.05314383295172
epoch 23 train loss: 174.294, val loss: 512.156, train acc: 0.999, val acc: 0.990
diff 62.380310738901755
epoch 24 train loss: 139.214, val loss: 514.891, train acc: 0.999, val acc: 0.989
diff 2.7355821327663534
epoch 25 train loss: 121.539, val loss: 769.062, train acc: 0.999, val acc: 0.988
diff 254.17112828170445
epoch 26 train loss: 207.212, val loss: 649.022, train acc: 0.999, val acc: 0.992
diff 120.040055419861
epoch 27 train loss: 155.137, val loss: 573.219, train acc: 0.999, val acc: 0.993
diff 75.80387774618328
epoch 28 train loss: 102.602, val loss: 619.763, train acc: 0.999, val acc: 0.992
diff 46.544615668106076
epoch 29 train loss: 188.944, val loss: 433.262, train acc: 0.999, val acc: 0.995
diff 186.50068068899606
epoch 30 train loss: 74.416, val loss: 462.106, train acc: 0.999, val acc: 0.995
diff 28.84349298141683
Training model M2
epoch 1 train loss: 4104.094, val loss: 194.078, train acc: 0.954, val acc: 0.982
diff inf
epoch 2 train loss: 1358.947, val loss: 175.000, train acc: 0.984, val acc: 0.984
diff 19.0781238526298
epoch 3 train loss: 880.089, val loss: 176.592, train acc: 0.990, val acc: 0.982
diff 1.5921039991960697
epoch 4 train loss: 618.147, val loss: 181.663, train acc: 0.993, val acc: 0.986
diff 5.070470880716044
epoch 5 train loss: 420.889, val loss: 202.958, train acc: 0.995, val acc: 0.988
diff 21.29520059092914
epoch 6 train loss: 470.510, val loss: 242.256, train acc: 0.995, val acc: 0.984
diff 39.29772937109675
epoch 7 train loss: 283.906, val loss: 280.070, train acc: 0.997, val acc: 0.986
diff 37.814186211337784
epoch 8 train loss: 326.161, val loss: 293.079, train acc: 0.996, val acc: 0.982
diff 13.00873366890778
epoch 9 train loss: 391.223, val loss: 310.293, train acc: 0.997, val acc: 0.984
diff 17.21398191811346
epoch 10 train loss: 271.159, val loss: 290.739, train acc: 0.998, val acc: 0.987
diff 19.553778520246624
epoch 11 train loss: 214.519, val loss: 390.768, train acc: 0.998, val acc: 0.985
diff 100.02870508937326
epoch 12 train loss: 373.706, val loss: 341.540, train acc: 0.997, val acc: 0.987
diff 49.22717377699479
epoch 13 train loss: 225.037, val loss: 617.068, train acc: 0.998, val acc: 0.975
diff 275.5280498644943
epoch 14 train loss: 244.982, val loss: 372.471, train acc: 0.998, val acc: 0.989
diff 244.59696360268032
epoch 15 train loss: 217.423, val loss: 436.245, train acc: 0.998, val acc: 0.983
diff 63.77400114734769
epoch 16 train loss: 287.539, val loss: 490.608, train acc: 0.998, val acc: 0.986
diff 54.36247478231928
epoch 17 train loss: 272.134, val loss: 372.866, train acc: 0.998, val acc: 0.985
diff 117.74146539036303
epoch 18 train loss: 269.367, val loss: 636.251, train acc: 0.998, val acc: 0.983
diff 263.3847526690441
epoch 19 train loss: 329.960, val loss: 588.823, train acc: 0.998, val acc: 0.984
diff 47.42843301719256
epoch 20 train loss: 172.178, val loss: 569.502, train acc: 0.999, val acc: 0.985
diff 19.320417910487095
epoch 21 train loss: 324.088, val loss: 832.146, train acc: 0.998, val acc: 0.978
diff 262.6435218304746
epoch 22 train loss: 333.968, val loss: 420.237, train acc: 0.998, val acc: 0.986
diff 411.908578108586
epoch 23 train loss: 297.143, val loss: 616.891, train acc: 0.998, val acc: 0.986
diff 196.65332245524547
epoch 24 train loss: 224.696, val loss: 799.436, train acc: 0.999, val acc: 0.984
diff 182.54540406428373
epoch 25 train loss: 528.475, val loss: 750.322, train acc: 0.998, val acc: 0.984
diff 49.1136271009093
epoch 26 train loss: 166.729, val loss: 636.484, train acc: 0.999, val acc: 0.987
diff 113.83809990274392
epoch 27 train loss: 344.535, val loss: 823.191, train acc: 0.998, val acc: 0.985
diff 186.70631568590795
epoch 28 train loss: 155.590, val loss: 813.857, train acc: 0.999, val acc: 0.987
diff 9.333228362492378
epoch 29 train loss: 330.310, val loss: 932.894, train acc: 0.998, val acc: 0.988
diff 119.03700724870669
epoch 30 train loss: 153.801, val loss: 719.407, train acc: 0.999, val acc: 0.987
diff 213.4877723513597
Training model M3
epoch 1 train loss: 1889.882, val loss: 564.126, train acc: 0.926, val acc: 0.942
diff inf
epoch 2 train loss: 533.579, val loss: 505.102, train acc: 0.978, val acc: 0.956
diff 59.0241730325975
epoch 3 train loss: 256.624, val loss: 579.107, train acc: 0.989, val acc: 0.954
diff 74.00490710246271
epoch 4 train loss: 241.544, val loss: 392.070, train acc: 0.989, val acc: 0.968
diff 187.03687927905958
epoch 5 train loss: 174.712, val loss: 529.725, train acc: 0.992, val acc: 0.964
diff 137.6554053361018
epoch 6 train loss: 102.550, val loss: 622.158, train acc: 0.996, val acc: 0.955
diff 92.43293599550395
epoch 7 train loss: 125.918, val loss: 593.362, train acc: 0.995, val acc: 0.961
diff 28.796153035101725
epoch 8 train loss: 105.387, val loss: 508.495, train acc: 0.996, val acc: 0.967
diff 84.86656993394314
epoch 9 train loss: 58.781, val loss: 552.573, train acc: 0.998, val acc: 0.970
diff 44.07718719839494
epoch 10 train loss: 26.370, val loss: 802.432, train acc: 0.999, val acc: 0.956
diff 249.85965655814596
epoch 11 train loss: 226.880, val loss: 547.513, train acc: 0.993, val acc: 0.963
diff 254.91907108646592
epoch 12 train loss: 81.404, val loss: 566.179, train acc: 0.997, val acc: 0.965
diff 18.665652402754404
epoch 13 train loss: 54.971, val loss: 589.462, train acc: 0.998, val acc: 0.966
diff 23.28292025025246
epoch 14 train loss: 37.006, val loss: 499.303, train acc: 0.999, val acc: 0.974
diff 90.1588283441834
epoch 15 train loss: 2.338, val loss: 556.982, train acc: 1.000, val acc: 0.972
diff 57.679471735235154
epoch 16 train loss: 0.095, val loss: 535.085, train acc: 1.000, val acc: 0.972
diff 21.89728835943822
epoch 17 train loss: 0.030, val loss: 538.964, train acc: 1.000, val acc: 0.973
diff 3.879195438515694
epoch 18 train loss: 0.020, val loss: 542.910, train acc: 1.000, val acc: 0.973
diff 3.9452970077833243
epoch 19 train loss: 0.014, val loss: 546.455, train acc: 1.000, val acc: 0.973
diff 3.545614478072139
epoch 20 train loss: 0.010, val loss: 550.497, train acc: 1.000, val acc: 0.972
diff 4.04162121391289
epoch 21 train loss: 0.007, val loss: 555.123, train acc: 1.000, val acc: 0.972
diff 4.626518592090861
epoch 22 train loss: 0.005, val loss: 559.975, train acc: 1.000, val acc: 0.973
diff 4.851391309893643
epoch 23 train loss: 0.004, val loss: 567.513, train acc: 1.000, val acc: 0.974
diff 7.537828487356023
epoch 24 train loss: 0.003, val loss: 573.410, train acc: 1.000, val acc: 0.974
diff 5.897690653658515
epoch 25 train loss: 0.002, val loss: 579.905, train acc: 1.000, val acc: 0.974
diff 6.494921621935191
epoch 26 train loss: 0.001, val loss: 588.822, train acc: 1.000, val acc: 0.974
diff 8.916996379615398
epoch 27 train loss: 0.001, val loss: 593.804, train acc: 1.000, val acc: 0.975
diff 4.981608301282449
epoch 28 train loss: 0.001, val loss: 612.178, train acc: 1.000, val acc: 0.975
diff 18.374064318335854
epoch 29 train loss: 0.000, val loss: 614.000, train acc: 1.000, val acc: 0.975
diff 1.821806786613024
epoch 30 train loss: 0.000, val loss: 627.342, train acc: 1.000, val acc: 0.974
diff 13.342133252516078
Training model M3
epoch 1 train loss: 104.282, val loss: 1780.423, train acc: 0.998, val acc: 0.944
diff inf
epoch 2 train loss: 45.956, val loss: 2666.193, train acc: 0.999, val acc: 0.918
diff 885.7705271085483
epoch 3 train loss: 46.385, val loss: 2310.394, train acc: 0.999, val acc: 0.931
diff 355.79926295577843
epoch 4 train loss: 202.924, val loss: 2923.510, train acc: 0.996, val acc: 0.921
diff 613.1160580756637
epoch 5 train loss: 7.932, val loss: 2601.871, train acc: 1.000, val acc: 0.923
diff 321.639740326596
epoch 6 train loss: 0.011, val loss: 2582.820, train acc: 1.000, val acc: 0.923
diff 19.051006962634347
epoch 7 train loss: 0.005, val loss: 2573.908, train acc: 1.000, val acc: 0.924
diff 8.911456895549236
epoch 8 train loss: 0.002, val loss: 2639.365, train acc: 1.000, val acc: 0.922
diff 65.45699014098636
epoch 9 train loss: 0.000, val loss: 2563.460, train acc: 1.000, val acc: 0.924
diff 75.90454413299767
epoch 10 train loss: 0.000, val loss: 2664.642, train acc: 1.000, val acc: 0.923
diff 101.1811660653807
epoch 11 train loss: 0.000, val loss: 2656.009, train acc: 1.000, val acc: 0.924
diff 8.6322817478449
epoch 12 train loss: 0.000, val loss: 2683.754, train acc: 1.000, val acc: 0.924
diff 27.744713894430788
epoch 13 train loss: 0.000, val loss: 2648.354, train acc: 1.000, val acc: 0.926
diff 35.40057225995406
epoch 14 train loss: 0.000, val loss: 2670.449, train acc: 1.000, val acc: 0.925
diff 22.09576358820368
epoch 15 train loss: 0.000, val loss: 2685.462, train acc: 1.000, val acc: 0.926
diff 15.01281224837885
epoch 16 train loss: 0.000, val loss: 2626.439, train acc: 1.000, val acc: 0.929
diff 59.023512236462466
epoch 17 train loss: 0.000, val loss: 2701.855, train acc: 1.000, val acc: 0.928
diff 75.4160266070594
