Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 18, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2423.896, val loss: 143.248, train acc: 0.966, val acc: 0.983
diff inf
epoch 2 train loss: 738.080, val loss: 153.936, train acc: 0.990, val acc: 0.980
diff 10.688126515890872
epoch 3 train loss: 510.669, val loss: 163.657, train acc: 0.993, val acc: 0.985
diff 9.721068622059846
epoch 4 train loss: 333.219, val loss: 116.563, train acc: 0.995, val acc: 0.991
diff 47.09358085132614
epoch 5 train loss: 287.439, val loss: 99.753, train acc: 0.996, val acc: 0.992
diff 16.810315616002825
epoch 6 train loss: 154.857, val loss: 159.625, train acc: 0.998, val acc: 0.991
diff 59.87179433452715
epoch 7 train loss: 233.544, val loss: 175.752, train acc: 0.997, val acc: 0.988
diff 16.126883645639396
epoch 8 train loss: 220.801, val loss: 146.944, train acc: 0.997, val acc: 0.990
diff 28.807743135528398
epoch 9 train loss: 147.071, val loss: 149.547, train acc: 0.998, val acc: 0.991
diff 2.6031115081753455
epoch 10 train loss: 223.930, val loss: 184.777, train acc: 0.998, val acc: 0.989
diff 35.2296944436697
epoch 11 train loss: 125.352, val loss: 207.358, train acc: 0.998, val acc: 0.990
diff 22.5809490696154
epoch 12 train loss: 230.728, val loss: 180.877, train acc: 0.997, val acc: 0.991
diff 26.480501487120023
epoch 13 train loss: 130.143, val loss: 177.125, train acc: 0.999, val acc: 0.991
diff 3.752519283839092
epoch 14 train loss: 121.729, val loss: 185.221, train acc: 0.999, val acc: 0.991
diff 8.096228472338822
epoch 15 train loss: 126.250, val loss: 254.183, train acc: 0.999, val acc: 0.990
diff 68.96235112416159
epoch 16 train loss: 193.156, val loss: 230.839, train acc: 0.998, val acc: 0.992
diff 23.344333775926685
epoch 17 train loss: 118.632, val loss: 276.866, train acc: 0.999, val acc: 0.991
diff 46.02748718107617
epoch 18 train loss: 207.600, val loss: 261.780, train acc: 0.998, val acc: 0.991
diff 15.086610635267618
epoch 19 train loss: 151.720, val loss: 320.830, train acc: 0.999, val acc: 0.986
diff 59.05067102006211
epoch 20 train loss: 49.449, val loss: 468.961, train acc: 0.999, val acc: 0.990
diff 148.13058335728675
epoch 21 train loss: 125.255, val loss: 386.408, train acc: 0.999, val acc: 0.991
diff 82.55259444285412
epoch 22 train loss: 122.005, val loss: 339.750, train acc: 0.999, val acc: 0.990
diff 46.658139553681224
epoch 23 train loss: 126.849, val loss: 323.062, train acc: 0.999, val acc: 0.992
diff 16.687843760929866
epoch 24 train loss: 106.669, val loss: 535.130, train acc: 0.999, val acc: 0.984
diff 212.0675879900304
epoch 25 train loss: 125.429, val loss: 414.681, train acc: 0.999, val acc: 0.988
diff 120.4492689052309
epoch 26 train loss: 144.188, val loss: 475.441, train acc: 0.999, val acc: 0.990
diff 60.76073300820377
epoch 27 train loss: 53.550, val loss: 426.209, train acc: 1.000, val acc: 0.993
diff 49.23247514000764
epoch 28 train loss: 221.233, val loss: 370.956, train acc: 0.999, val acc: 0.994
diff 55.252701418121774
epoch 29 train loss: 118.751, val loss: 577.903, train acc: 0.999, val acc: 0.989
diff 206.94675133079
epoch 30 train loss: 64.079, val loss: 506.255, train acc: 0.999, val acc: 0.991
diff 71.64797394486294
Training model M2
epoch 1 train loss: 3894.607, val loss: 173.620, train acc: 0.956, val acc: 0.985
diff inf
epoch 2 train loss: 1296.417, val loss: 207.212, train acc: 0.985, val acc: 0.978
diff 33.59172529939531
epoch 3 train loss: 847.083, val loss: 175.896, train acc: 0.990, val acc: 0.984
diff 31.315853931939017
epoch 4 train loss: 493.617, val loss: 236.888, train acc: 0.994, val acc: 0.985
diff 60.99165462430153
epoch 5 train loss: 453.906, val loss: 229.071, train acc: 0.995, val acc: 0.985
diff 7.816987489184385
epoch 6 train loss: 416.815, val loss: 263.716, train acc: 0.996, val acc: 0.986
diff 34.645058490941096
epoch 7 train loss: 303.031, val loss: 318.025, train acc: 0.997, val acc: 0.979
diff 54.308770272013135
epoch 8 train loss: 291.798, val loss: 258.316, train acc: 0.997, val acc: 0.986
diff 59.7086146263382
epoch 9 train loss: 324.538, val loss: 218.501, train acc: 0.997, val acc: 0.988
diff 39.815193392967814
epoch 10 train loss: 298.175, val loss: 356.856, train acc: 0.997, val acc: 0.986
diff 138.35471515697688
epoch 11 train loss: 271.690, val loss: 502.469, train acc: 0.998, val acc: 0.981
diff 145.61322838826095
epoch 12 train loss: 311.004, val loss: 544.422, train acc: 0.997, val acc: 0.983
diff 41.953387287876524
epoch 13 train loss: 299.554, val loss: 344.347, train acc: 0.998, val acc: 0.984
diff 200.07506377352297
epoch 14 train loss: 231.618, val loss: 500.036, train acc: 0.998, val acc: 0.985
diff 155.68915885518783
epoch 15 train loss: 311.035, val loss: 572.374, train acc: 0.998, val acc: 0.987
diff 72.33743972179292
epoch 16 train loss: 227.939, val loss: 540.937, train acc: 0.998, val acc: 0.988
diff 31.43681566488374
epoch 17 train loss: 451.898, val loss: 472.200, train acc: 0.998, val acc: 0.989
diff 68.73725817817677
epoch 18 train loss: 178.583, val loss: 612.359, train acc: 0.998, val acc: 0.985
diff 140.15935119855084
epoch 19 train loss: 319.213, val loss: 634.997, train acc: 0.999, val acc: 0.989
diff 22.637462325903698
epoch 20 train loss: 355.535, val loss: 791.315, train acc: 0.998, val acc: 0.984
diff 156.31846902748657
epoch 21 train loss: 236.705, val loss: 923.184, train acc: 0.999, val acc: 0.984
diff 131.86935000902963
epoch 22 train loss: 377.941, val loss: 527.066, train acc: 0.998, val acc: 0.990
diff 396.1178822466935
epoch 23 train loss: 294.989, val loss: 741.155, train acc: 0.998, val acc: 0.985
diff 214.08856954650196
epoch 24 train loss: 258.275, val loss: 719.547, train acc: 0.999, val acc: 0.988
diff 21.607646907279786
epoch 25 train loss: 445.819, val loss: 686.069, train acc: 0.999, val acc: 0.989
diff 33.47883902602996
epoch 26 train loss: 293.554, val loss: 878.630, train acc: 0.999, val acc: 0.988
diff 192.5615495007587
epoch 27 train loss: 335.322, val loss: 939.622, train acc: 0.998, val acc: 0.988
diff 60.99199339449751
epoch 28 train loss: 312.916, val loss: 1110.100, train acc: 0.999, val acc: 0.984
diff 170.4777329044815
epoch 29 train loss: 302.458, val loss: 868.266, train acc: 0.999, val acc: 0.989
diff 241.83387608176167
epoch 30 train loss: 292.815, val loss: 692.420, train acc: 0.999, val acc: 0.988
diff 175.8462512771041
Training model M3
epoch 1 train loss: 1982.859, val loss: 490.150, train acc: 0.920, val acc: 0.953
diff inf
epoch 2 train loss: 535.075, val loss: 545.421, train acc: 0.979, val acc: 0.948
diff 55.270786503967656
epoch 3 train loss: 235.161, val loss: 693.385, train acc: 0.990, val acc: 0.943
diff 147.96434740347706
epoch 4 train loss: 217.266, val loss: 408.070, train acc: 0.990, val acc: 0.970
diff 285.3148682194452
epoch 5 train loss: 169.395, val loss: 812.499, train acc: 0.993, val acc: 0.941
diff 404.42849217975584
epoch 6 train loss: 92.633, val loss: 457.237, train acc: 0.997, val acc: 0.968
diff 355.2610919790875
epoch 7 train loss: 161.547, val loss: 496.033, train acc: 0.993, val acc: 0.962
diff 38.79541261013611
epoch 8 train loss: 108.031, val loss: 540.833, train acc: 0.996, val acc: 0.969
diff 44.8001857455136
epoch 9 train loss: 13.157, val loss: 653.729, train acc: 1.000, val acc: 0.968
diff 112.89581402603267
epoch 10 train loss: 0.751, val loss: 631.754, train acc: 1.000, val acc: 0.972
diff 21.974457674853852
epoch 11 train loss: 0.136, val loss: 615.275, train acc: 1.000, val acc: 0.973
diff 16.479349833987044
epoch 12 train loss: 0.061, val loss: 618.129, train acc: 1.000, val acc: 0.973
diff 2.8541579287286822
epoch 13 train loss: 0.043, val loss: 623.549, train acc: 1.000, val acc: 0.974
diff 5.419769013609198
epoch 14 train loss: 0.030, val loss: 629.618, train acc: 1.000, val acc: 0.974
diff 6.069315094023409
epoch 15 train loss: 0.021, val loss: 635.311, train acc: 1.000, val acc: 0.974
diff 5.692575790345018
epoch 16 train loss: 0.015, val loss: 644.901, train acc: 1.000, val acc: 0.974
diff 9.58961914399049
epoch 17 train loss: 0.010, val loss: 653.803, train acc: 1.000, val acc: 0.975
diff 8.902934267895262
epoch 18 train loss: 0.007, val loss: 665.230, train acc: 1.000, val acc: 0.974
diff 11.426162791113029
epoch 19 train loss: 0.005, val loss: 675.389, train acc: 1.000, val acc: 0.975
diff 10.159777388883299
epoch 20 train loss: 0.003, val loss: 684.893, train acc: 1.000, val acc: 0.975
diff 9.503107390092737
epoch 21 train loss: 0.002, val loss: 696.837, train acc: 1.000, val acc: 0.975
diff 11.944338751856208
epoch 22 train loss: 0.002, val loss: 707.849, train acc: 1.000, val acc: 0.975
diff 11.012164908891918
epoch 23 train loss: 0.001, val loss: 722.948, train acc: 1.000, val acc: 0.975
diff 15.098813099022095
epoch 24 train loss: 0.001, val loss: 733.654, train acc: 1.000, val acc: 0.975
diff 10.70653425261969
epoch 25 train loss: 0.000, val loss: 744.003, train acc: 1.000, val acc: 0.975
diff 10.34859172624499
epoch 26 train loss: 0.000, val loss: 758.306, train acc: 1.000, val acc: 0.975
diff 14.302581681990432
epoch 27 train loss: 0.000, val loss: 768.419, train acc: 1.000, val acc: 0.975
diff 10.113863548421364
epoch 28 train loss: 0.000, val loss: 780.556, train acc: 1.000, val acc: 0.975
diff 12.136393184828421
epoch 29 train loss: 0.000, val loss: 797.574, train acc: 1.000, val acc: 0.975
diff 17.018365153114132
epoch 30 train loss: 0.000, val loss: 811.248, train acc: 1.000, val acc: 0.975
diff 13.674226029750798
Training model M3
epoch 1 train loss: 129.042, val loss: 1404.866, train acc: 0.997, val acc: 0.947
diff inf
epoch 2 train loss: 1.625, val loss: 1523.496, train acc: 1.000, val acc: 0.951
diff 118.63060045355132
epoch 3 train loss: 0.007, val loss: 1508.877, train acc: 1.000, val acc: 0.949
diff 14.619422906079308
epoch 4 train loss: 0.002, val loss: 1504.612, train acc: 1.000, val acc: 0.950
diff 4.264534017716869
epoch 5 train loss: 0.001, val loss: 1533.481, train acc: 1.000, val acc: 0.950
diff 28.868687109189523
epoch 6 train loss: 0.001, val loss: 1549.731, train acc: 1.000, val acc: 0.951
diff 16.249626893161576
epoch 7 train loss: 0.001, val loss: 1550.310, train acc: 1.000, val acc: 0.951
diff 0.5796931933564338
epoch 8 train loss: 0.000, val loss: 1549.022, train acc: 1.000, val acc: 0.951
diff 1.2885984183556047
epoch 9 train loss: 0.000, val loss: 1545.937, train acc: 1.000, val acc: 0.952
diff 3.085182911559741
epoch 10 train loss: 0.000, val loss: 1546.890, train acc: 1.000, val acc: 0.952
diff 0.9535455520103824
epoch 11 train loss: 0.000, val loss: 1572.974, train acc: 1.000, val acc: 0.951
diff 26.083756328484014
epoch 12 train loss: 0.000, val loss: 1563.601, train acc: 1.000, val acc: 0.951
diff 9.373217378633854
epoch 13 train loss: 0.000, val loss: 1576.657, train acc: 1.000, val acc: 0.950
diff 13.055962375392028
epoch 14 train loss: 0.000, val loss: 1577.741, train acc: 1.000, val acc: 0.950
diff 1.0839279486961004
epoch 15 train loss: 0.000, val loss: 1608.816, train acc: 1.000, val acc: 0.949
diff 31.07590334157021
epoch 16 train loss: 0.000, val loss: 1602.807, train acc: 1.000, val acc: 0.950
diff 6.009752723928841
epoch 17 train loss: 0.000, val loss: 1622.737, train acc: 1.000, val acc: 0.949
diff 19.930187113752027
epoch 18 train loss: 0.000, val loss: 1653.015, train acc: 1.000, val acc: 0.949
diff 30.27816666120384
epoch 19 train loss: 0.000, val loss: 1650.497, train acc: 1.000, val acc: 0.949
diff 2.517669558742
epoch 20 train loss: 0.000, val loss: 1681.502, train acc: 1.000, val acc: 0.949
diff 31.0049420351786
epoch 21 train loss: 0.000, val loss: 1662.039, train acc: 1.000, val acc: 0.949
diff 19.46355169379285
epoch 22 train loss: 0.000, val loss: 1697.411, train acc: 1.000, val acc: 0.948
diff 35.372201894957925
epoch 23 train loss: 0.000, val loss: 1700.661, train acc: 1.000, val acc: 0.949
diff 3.250467813676323
epoch 24 train loss: 0.000, val loss: 1719.319, train acc: 1.000, val acc: 0.949
diff 18.65745078894156
epoch 25 train loss: 0.000, val loss: 1725.382, train acc: 1.000, val acc: 0.949
diff 6.063040273852039
epoch 26 train loss: 0.000, val loss: 1729.318, train acc: 1.000, val acc: 0.949
diff 3.9360538844412076
epoch 27 train loss: 0.000, val loss: 1754.981, train acc: 1.000, val acc: 0.949
diff 25.66334437122373
epoch 28 train loss: 0.000, val loss: 1777.496, train acc: 1.000, val acc: 0.947
diff 22.515084069382056
epoch 29 train loss: 0.000, val loss: 1786.053, train acc: 1.000, val acc: 0.947
diff 8.55698233072053
epoch 30 train loss: 0.000, val loss: 1801.031, train acc: 1.000, val acc: 0.947
diff 14.977786690564244
Training model M3
epoch 1 train loss: 1258.331, val loss: 176.836, train acc: 0.968, val acc: 0.982
diff inf
epoch 2 train loss: 269.951, val loss: 214.850, train acc: 0.989, val acc: 0.980
diff 38.01443202782161
epoch 3 train loss: 89.352, val loss: 221.953, train acc: 0.996, val acc: 0.986
diff 7.102844150152237
epoch 4 train loss: 159.560, val loss: 277.601, train acc: 0.994, val acc: 0.982
diff 55.64810281338518
epoch 5 train loss: 198.764, val loss: 302.335, train acc: 0.992, val acc: 0.981
diff 24.734039571259473
epoch 6 train loss: 111.215, val loss: 261.981, train acc: 0.996, val acc: 0.986
diff 40.35391368812691
epoch 7 train loss: 78.314, val loss: 299.495, train acc: 0.997, val acc: 0.983
diff 37.51355600744398
epoch 8 train loss: 74.143, val loss: 543.408, train acc: 0.997, val acc: 0.972
diff 243.9128170989789
epoch 9 train loss: 121.112, val loss: 327.664, train acc: 0.996, val acc: 0.981
diff 215.74376503292694
epoch 10 train loss: 14.797, val loss: 427.366, train acc: 0.999, val acc: 0.982
diff 99.70189192183767
epoch 11 train loss: 159.569, val loss: 502.135, train acc: 0.995, val acc: 0.978
diff 74.76898361431421
epoch 12 train loss: 61.975, val loss: 616.838, train acc: 0.998, val acc: 0.976
diff 114.70310103890893
epoch 13 train loss: 111.990, val loss: 546.927, train acc: 0.996, val acc: 0.979
diff 69.91135091346905
epoch 14 train loss: 137.232, val loss: 428.105, train acc: 0.996, val acc: 0.983
diff 118.82128508413751
epoch 15 train loss: 85.396, val loss: 444.085, train acc: 0.997, val acc: 0.980
diff 15.97998075425403
epoch 16 train loss: 34.812, val loss: 463.747, train acc: 0.998, val acc: 0.982
diff 19.661570256175935
epoch 17 train loss: 18.128, val loss: 454.078, train acc: 0.999, val acc: 0.982
diff 9.668782353545566
epoch 18 train loss: 19.025, val loss: 640.043, train acc: 0.999, val acc: 0.981
diff 185.96525036405137
epoch 19 train loss: 198.834, val loss: 697.035, train acc: 0.994, val acc: 0.976
diff 56.99119508371564
epoch 20 train loss: 117.053, val loss: 835.518, train acc: 0.996, val acc: 0.973
diff 138.4830513638317
epoch 21 train loss: 44.960, val loss: 634.938, train acc: 0.998, val acc: 0.978
diff 200.57960597053557
epoch 22 train loss: 49.708, val loss: 597.474, train acc: 0.999, val acc: 0.978
diff 37.46374611703936
epoch 23 train loss: 38.532, val loss: 736.729, train acc: 0.999, val acc: 0.973
diff 139.2552854426566
epoch 24 train loss: 12.266, val loss: 805.097, train acc: 1.000, val acc: 0.975
diff 68.36765117948039
epoch 25 train loss: 155.734, val loss: 853.882, train acc: 0.997, val acc: 0.973
diff 48.78471343338606
epoch 26 train loss: 60.626, val loss: 631.191, train acc: 0.998, val acc: 0.977
diff 222.69092959877287
epoch 27 train loss: 40.197, val loss: 757.732, train acc: 0.999, val acc: 0.975
diff 126.54094956116307
epoch 28 train loss: 82.899, val loss: 1669.665, train acc: 0.997, val acc: 0.953
diff 911.93341949418
epoch 29 train loss: 106.569, val loss: 1078.960, train acc: 0.997, val acc: 0.971
diff 590.7056187472951
epoch 30 train loss: 44.362, val loss: 1104.341, train acc: 0.999, val acc: 0.970
diff 25.38109713754511
