Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 18, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2423.896, val loss: 143.248, train acc: 0.966, val acc: 0.983
diff inf
epoch 2 train loss: 738.080, val loss: 153.936, train acc: 0.990, val acc: 0.980
diff 10.688126515890872
epoch 3 train loss: 510.669, val loss: 163.657, train acc: 0.993, val acc: 0.985
diff 9.721068622059846
epoch 4 train loss: 333.219, val loss: 116.563, train acc: 0.995, val acc: 0.991
diff 47.09358085132614
epoch 5 train loss: 287.439, val loss: 99.753, train acc: 0.996, val acc: 0.992
diff 16.810315616002825
epoch 6 train loss: 154.857, val loss: 159.625, train acc: 0.998, val acc: 0.991
diff 59.87179433452715
epoch 7 train loss: 233.544, val loss: 175.752, train acc: 0.997, val acc: 0.988
diff 16.126883645639396
epoch 8 train loss: 220.801, val loss: 146.944, train acc: 0.997, val acc: 0.990
diff 28.807743135528398
epoch 9 train loss: 147.071, val loss: 149.547, train acc: 0.998, val acc: 0.991
diff 2.6031115081753455
epoch 10 train loss: 223.930, val loss: 184.777, train acc: 0.998, val acc: 0.989
diff 35.2296944436697
epoch 11 train loss: 125.352, val loss: 207.358, train acc: 0.998, val acc: 0.990
diff 22.5809490696154
epoch 12 train loss: 230.728, val loss: 180.877, train acc: 0.997, val acc: 0.991
diff 26.480501487120023
epoch 13 train loss: 130.143, val loss: 177.125, train acc: 0.999, val acc: 0.991
diff 3.752519283839092
epoch 14 train loss: 121.729, val loss: 185.221, train acc: 0.999, val acc: 0.991
diff 8.096228472338822
epoch 15 train loss: 126.250, val loss: 254.183, train acc: 0.999, val acc: 0.990
diff 68.96235112416159
epoch 16 train loss: 193.156, val loss: 230.839, train acc: 0.998, val acc: 0.992
diff 23.344333775926685
epoch 17 train loss: 118.632, val loss: 276.866, train acc: 0.999, val acc: 0.991
diff 46.02748718107617
epoch 18 train loss: 207.600, val loss: 261.780, train acc: 0.998, val acc: 0.991
diff 15.086610635267618
epoch 19 train loss: 151.720, val loss: 320.830, train acc: 0.999, val acc: 0.986
diff 59.05067102006211
epoch 20 train loss: 49.449, val loss: 468.961, train acc: 0.999, val acc: 0.990
diff 148.13058335728675
epoch 21 train loss: 125.255, val loss: 386.408, train acc: 0.999, val acc: 0.991
diff 82.55259444285412
epoch 22 train loss: 122.005, val loss: 339.750, train acc: 0.999, val acc: 0.990
diff 46.658139553681224
epoch 23 train loss: 126.849, val loss: 323.062, train acc: 0.999, val acc: 0.992
diff 16.687843760929866
epoch 24 train loss: 106.669, val loss: 535.130, train acc: 0.999, val acc: 0.984
diff 212.0675879900304
epoch 25 train loss: 125.429, val loss: 414.681, train acc: 0.999, val acc: 0.988
diff 120.4492689052309
epoch 26 train loss: 144.188, val loss: 475.441, train acc: 0.999, val acc: 0.990
diff 60.76073300820377
epoch 27 train loss: 53.550, val loss: 426.209, train acc: 1.000, val acc: 0.993
diff 49.23247514000764
epoch 28 train loss: 221.233, val loss: 370.956, train acc: 0.999, val acc: 0.994
diff 55.252701418121774
epoch 29 train loss: 118.751, val loss: 577.903, train acc: 0.999, val acc: 0.989
diff 206.94675133079
epoch 30 train loss: 64.079, val loss: 506.255, train acc: 0.999, val acc: 0.991
diff 71.64797394486294
Training model M2
epoch 1 train loss: 3894.607, val loss: 173.620, train acc: 0.956, val acc: 0.985
diff inf
epoch 2 train loss: 1296.417, val loss: 207.212, train acc: 0.985, val acc: 0.978
diff 33.59172529939531
epoch 3 train loss: 847.083, val loss: 175.896, train acc: 0.990, val acc: 0.984
diff 31.315853931939017
epoch 4 train loss: 493.617, val loss: 236.888, train acc: 0.994, val acc: 0.985
diff 60.99165462430153
epoch 5 train loss: 453.906, val loss: 229.071, train acc: 0.995, val acc: 0.985
diff 7.816987489184385
epoch 6 train loss: 416.815, val loss: 263.716, train acc: 0.996, val acc: 0.986
diff 34.645058490941096
epoch 7 train loss: 303.031, val loss: 318.025, train acc: 0.997, val acc: 0.979
diff 54.308770272013135
epoch 8 train loss: 291.798, val loss: 258.316, train acc: 0.997, val acc: 0.986
diff 59.7086146263382
epoch 9 train loss: 324.538, val loss: 218.501, train acc: 0.997, val acc: 0.988
diff 39.815193392967814
epoch 10 train loss: 298.175, val loss: 356.856, train acc: 0.997, val acc: 0.986
diff 138.35471515697688
epoch 11 train loss: 271.690, val loss: 502.469, train acc: 0.998, val acc: 0.981
diff 145.61322838826095
epoch 12 train loss: 311.004, val loss: 544.422, train acc: 0.997, val acc: 0.983
diff 41.953387287876524
epoch 13 train loss: 299.554, val loss: 344.347, train acc: 0.998, val acc: 0.984
diff 200.07506377352297
epoch 14 train loss: 231.618, val loss: 500.036, train acc: 0.998, val acc: 0.985
diff 155.68915885518783
epoch 15 train loss: 311.035, val loss: 572.374, train acc: 0.998, val acc: 0.987
diff 72.33743972179292
epoch 16 train loss: 227.939, val loss: 540.937, train acc: 0.998, val acc: 0.988
diff 31.43681566488374
epoch 17 train loss: 451.898, val loss: 472.200, train acc: 0.998, val acc: 0.989
diff 68.73725817817677
epoch 18 train loss: 178.583, val loss: 612.359, train acc: 0.998, val acc: 0.985
diff 140.15935119855084
epoch 19 train loss: 319.213, val loss: 634.997, train acc: 0.999, val acc: 0.989
diff 22.637462325903698
epoch 20 train loss: 355.535, val loss: 791.315, train acc: 0.998, val acc: 0.984
diff 156.31846902748657
epoch 21 train loss: 236.705, val loss: 923.184, train acc: 0.999, val acc: 0.984
diff 131.86935000902963
epoch 22 train loss: 377.941, val loss: 527.066, train acc: 0.998, val acc: 0.990
diff 396.1178822466935
epoch 23 train loss: 294.989, val loss: 741.155, train acc: 0.998, val acc: 0.985
diff 214.08856954650196
epoch 24 train loss: 258.275, val loss: 719.547, train acc: 0.999, val acc: 0.988
diff 21.607646907279786
epoch 25 train loss: 445.819, val loss: 686.069, train acc: 0.999, val acc: 0.989
diff 33.47883902602996
epoch 26 train loss: 293.554, val loss: 878.630, train acc: 0.999, val acc: 0.988
diff 192.5615495007587
epoch 27 train loss: 335.322, val loss: 939.622, train acc: 0.998, val acc: 0.988
diff 60.99199339449751
epoch 28 train loss: 312.916, val loss: 1110.100, train acc: 0.999, val acc: 0.984
diff 170.4777329044815
epoch 29 train loss: 302.458, val loss: 868.266, train acc: 0.999, val acc: 0.989
diff 241.83387608176167
epoch 30 train loss: 292.815, val loss: 692.420, train acc: 0.999, val acc: 0.988
diff 175.8462512771041
Training model M3
epoch 1 train loss: 1694.855, val loss: 973.998, train acc: 0.924, val acc: 0.894
diff inf
epoch 2 train loss: 398.814, val loss: 600.822, train acc: 0.982, val acc: 0.948
diff 373.1762603688868
epoch 3 train loss: 220.361, val loss: 1303.415, train acc: 0.989, val acc: 0.892
diff 702.5935567029253
epoch 4 train loss: 206.747, val loss: 732.243, train acc: 0.989, val acc: 0.943
diff 571.1728206936109
epoch 5 train loss: 82.680, val loss: 843.010, train acc: 0.996, val acc: 0.939
diff 110.76741635752103
epoch 6 train loss: 92.065, val loss: 715.567, train acc: 0.995, val acc: 0.953
diff 127.44250261159755
epoch 7 train loss: 92.955, val loss: 1129.347, train acc: 0.996, val acc: 0.926
diff 413.7791478707046
epoch 8 train loss: 106.307, val loss: 930.133, train acc: 0.996, val acc: 0.936
diff 199.21379753046028
epoch 9 train loss: 28.097, val loss: 1219.016, train acc: 0.998, val acc: 0.941
diff 288.8834059477375
epoch 10 train loss: 101.697, val loss: 1061.178, train acc: 0.997, val acc: 0.941
diff 157.83777807964725
epoch 11 train loss: 84.403, val loss: 1463.317, train acc: 0.996, val acc: 0.924
diff 402.1385558489451
epoch 12 train loss: 49.712, val loss: 1458.461, train acc: 0.998, val acc: 0.922
diff 4.856430608445635
epoch 13 train loss: 74.376, val loss: 858.580, train acc: 0.996, val acc: 0.945
diff 599.8804131529236
epoch 14 train loss: 22.075, val loss: 1594.380, train acc: 0.999, val acc: 0.934
diff 735.8003683878438
epoch 15 train loss: 55.641, val loss: 1599.666, train acc: 0.998, val acc: 0.938
diff 5.28536465948082
epoch 16 train loss: 170.618, val loss: 1257.829, train acc: 0.994, val acc: 0.941
diff 341.8372662657878
epoch 17 train loss: 62.906, val loss: 1356.368, train acc: 0.997, val acc: 0.940
diff 98.53955441768176
epoch 18 train loss: 32.480, val loss: 898.831, train acc: 0.999, val acc: 0.959
diff 457.5369868659333
epoch 19 train loss: 0.325, val loss: 960.321, train acc: 1.000, val acc: 0.956
diff 61.48974682172218
epoch 20 train loss: 0.060, val loss: 958.993, train acc: 1.000, val acc: 0.957
diff 1.3277927090426829
epoch 21 train loss: 0.038, val loss: 963.257, train acc: 1.000, val acc: 0.957
diff 4.263959499002226
epoch 22 train loss: 0.028, val loss: 971.134, train acc: 1.000, val acc: 0.957
diff 7.877403614309856
epoch 23 train loss: 0.022, val loss: 977.458, train acc: 1.000, val acc: 0.957
diff 6.323296490867847
epoch 24 train loss: 0.017, val loss: 988.531, train acc: 1.000, val acc: 0.957
diff 11.073143068624177
epoch 25 train loss: 0.013, val loss: 999.070, train acc: 1.000, val acc: 0.957
diff 10.539027093237223
