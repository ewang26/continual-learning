Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 19, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2581.645, val loss: 128.726, train acc: 0.964, val acc: 0.982
diff inf
epoch 2 train loss: 776.277, val loss: 119.953, train acc: 0.989, val acc: 0.988
diff 8.77245172822387
epoch 3 train loss: 470.566, val loss: 143.835, train acc: 0.993, val acc: 0.985
diff 23.882253879470795
epoch 4 train loss: 391.915, val loss: 94.535, train acc: 0.995, val acc: 0.993
diff 49.30033355658219
epoch 5 train loss: 343.675, val loss: 114.515, train acc: 0.995, val acc: 0.991
diff 19.980206873918675
epoch 6 train loss: 183.470, val loss: 142.540, train acc: 0.997, val acc: 0.988
diff 28.024698064908776
epoch 7 train loss: 212.309, val loss: 177.586, train acc: 0.997, val acc: 0.989
diff 35.04627608313976
epoch 8 train loss: 137.535, val loss: 255.927, train acc: 0.998, val acc: 0.982
diff 78.34089534678282
epoch 9 train loss: 229.711, val loss: 214.889, train acc: 0.997, val acc: 0.985
diff 41.03793007985391
epoch 10 train loss: 63.396, val loss: 174.088, train acc: 0.999, val acc: 0.990
diff 40.80079035393726
epoch 11 train loss: 168.583, val loss: 264.908, train acc: 0.998, val acc: 0.988
diff 90.81946175597429
epoch 12 train loss: 141.008, val loss: 216.000, train acc: 0.998, val acc: 0.990
diff 48.90810153174158
epoch 13 train loss: 114.577, val loss: 377.474, train acc: 0.999, val acc: 0.985
diff 161.4737689726037
epoch 14 train loss: 167.622, val loss: 209.875, train acc: 0.999, val acc: 0.993
diff 167.59827621412308
epoch 15 train loss: 125.867, val loss: 362.304, train acc: 0.999, val acc: 0.985
diff 152.42919343868465
epoch 16 train loss: 148.979, val loss: 309.592, train acc: 0.999, val acc: 0.992
diff 52.71212935999063
epoch 17 train loss: 171.014, val loss: 312.270, train acc: 0.998, val acc: 0.991
diff 2.677513266672463
epoch 18 train loss: 158.434, val loss: 255.983, train acc: 0.998, val acc: 0.991
diff 56.28631640423396
epoch 19 train loss: 174.490, val loss: 398.529, train acc: 0.998, val acc: 0.987
diff 142.5454990575127
epoch 20 train loss: 102.761, val loss: 324.230, train acc: 0.999, val acc: 0.989
diff 74.29863600625157
epoch 21 train loss: 107.139, val loss: 348.217, train acc: 0.999, val acc: 0.990
diff 23.98655439810858
epoch 22 train loss: 152.368, val loss: 426.483, train acc: 0.999, val acc: 0.987
diff 78.26586022051009
epoch 23 train loss: 116.525, val loss: 259.271, train acc: 0.999, val acc: 0.992
diff 167.21162995556557
epoch 24 train loss: 51.686, val loss: 304.319, train acc: 1.000, val acc: 0.992
diff 45.047625799513355
epoch 25 train loss: 167.742, val loss: 287.162, train acc: 0.999, val acc: 0.991
diff 17.156381645106478
epoch 26 train loss: 45.271, val loss: 352.308, train acc: 1.000, val acc: 0.992
diff 65.14533624335883
epoch 27 train loss: 82.015, val loss: 377.925, train acc: 0.999, val acc: 0.992
diff 25.61693635488797
epoch 28 train loss: 173.946, val loss: 759.889, train acc: 0.999, val acc: 0.986
diff 381.9645445229289
epoch 29 train loss: 184.848, val loss: 336.221, train acc: 0.999, val acc: 0.989
diff 423.6684986492639
epoch 30 train loss: 45.201, val loss: 328.899, train acc: 1.000, val acc: 0.992
diff 7.321604394796168
Training model M2
epoch 1 train loss: 3869.974, val loss: 198.339, train acc: 0.956, val acc: 0.982
diff inf
epoch 2 train loss: 1367.830, val loss: 175.862, train acc: 0.984, val acc: 0.984
diff 22.477237362156984
epoch 3 train loss: 851.297, val loss: 229.570, train acc: 0.990, val acc: 0.980
diff 53.70813473447606
epoch 4 train loss: 513.596, val loss: 204.429, train acc: 0.993, val acc: 0.983
diff 25.1413121536807
epoch 5 train loss: 468.139, val loss: 206.994, train acc: 0.994, val acc: 0.986
diff 2.5652291817678474
epoch 6 train loss: 361.496, val loss: 186.046, train acc: 0.996, val acc: 0.988
diff 20.948101000399163
epoch 7 train loss: 346.098, val loss: 187.066, train acc: 0.996, val acc: 0.987
diff 1.0200679190515416
epoch 8 train loss: 263.700, val loss: 259.760, train acc: 0.997, val acc: 0.987
diff 72.69458956900135
epoch 9 train loss: 340.908, val loss: 275.402, train acc: 0.997, val acc: 0.987
diff 15.641446369004143
epoch 10 train loss: 278.113, val loss: 278.383, train acc: 0.997, val acc: 0.987
diff 2.98070954406154
epoch 11 train loss: 203.843, val loss: 263.474, train acc: 0.998, val acc: 0.990
diff 14.908082478933466
epoch 12 train loss: 296.812, val loss: 406.724, train acc: 0.998, val acc: 0.985
diff 143.2496222070717
epoch 13 train loss: 173.163, val loss: 340.251, train acc: 0.999, val acc: 0.987
diff 66.47355848611807
epoch 14 train loss: 287.529, val loss: 449.264, train acc: 0.997, val acc: 0.985
diff 109.01332839745282
epoch 15 train loss: 246.549, val loss: 476.313, train acc: 0.998, val acc: 0.987
diff 27.04928768499201
epoch 16 train loss: 233.817, val loss: 250.924, train acc: 0.998, val acc: 0.990
diff 225.38933737754485
epoch 17 train loss: 263.108, val loss: 495.888, train acc: 0.998, val acc: 0.986
diff 244.963955752218
epoch 18 train loss: 245.250, val loss: 344.132, train acc: 0.998, val acc: 0.990
diff 151.75625761405047
epoch 19 train loss: 106.519, val loss: 453.637, train acc: 0.999, val acc: 0.986
diff 109.50512844141508
epoch 20 train loss: 260.308, val loss: 320.092, train acc: 0.998, val acc: 0.988
diff 133.54497223999152
epoch 21 train loss: 53.686, val loss: 431.196, train acc: 1.000, val acc: 0.988
diff 111.10436619865561
epoch 22 train loss: 295.254, val loss: 670.909, train acc: 0.998, val acc: 0.985
diff 239.71347366570478
epoch 23 train loss: 308.175, val loss: 721.094, train acc: 0.998, val acc: 0.987
diff 50.18483860964557
epoch 24 train loss: 269.535, val loss: 573.378, train acc: 0.998, val acc: 0.989
diff 147.716133100717
epoch 25 train loss: 147.864, val loss: 679.318, train acc: 0.999, val acc: 0.988
diff 105.93967592836077
epoch 26 train loss: 228.860, val loss: 986.243, train acc: 0.999, val acc: 0.981
diff 306.9247158942421
epoch 27 train loss: 313.222, val loss: 909.280, train acc: 0.998, val acc: 0.985
diff 76.96212800439218
epoch 28 train loss: 234.101, val loss: 891.511, train acc: 0.999, val acc: 0.984
diff 17.768987208060366
epoch 29 train loss: 172.895, val loss: 771.686, train acc: 0.999, val acc: 0.988
diff 119.82587858230806
epoch 30 train loss: 279.440, val loss: 1110.400, train acc: 0.999, val acc: 0.985
diff 338.71450625938587
Training model M3
epoch 1 train loss: 1956.506, val loss: 489.777, train acc: 0.923, val acc: 0.946
diff inf
epoch 2 train loss: 499.822, val loss: 357.156, train acc: 0.981, val acc: 0.965
diff 132.62141687058312
epoch 3 train loss: 244.876, val loss: 479.292, train acc: 0.989, val acc: 0.959
diff 122.13644204561842
epoch 4 train loss: 236.219, val loss: 453.686, train acc: 0.989, val acc: 0.965
diff 25.60678321281904
epoch 5 train loss: 159.837, val loss: 773.085, train acc: 0.993, val acc: 0.947
diff 319.39969873039126
epoch 6 train loss: 140.697, val loss: 1313.616, train acc: 0.993, val acc: 0.924
diff 540.530907328888
epoch 7 train loss: 126.318, val loss: 569.896, train acc: 0.995, val acc: 0.965
diff 743.7200497418945
epoch 8 train loss: 107.349, val loss: 713.880, train acc: 0.996, val acc: 0.954
diff 143.98370628113503
epoch 9 train loss: 49.659, val loss: 1005.947, train acc: 0.998, val acc: 0.951
diff 292.06691159876823
epoch 10 train loss: 141.712, val loss: 435.096, train acc: 0.995, val acc: 0.971
diff 570.8503510905572
epoch 11 train loss: 80.336, val loss: 479.788, train acc: 0.997, val acc: 0.971
diff 44.69189406720369
epoch 12 train loss: 97.216, val loss: 526.743, train acc: 0.997, val acc: 0.963
diff 46.95500498110363
epoch 13 train loss: 29.794, val loss: 658.040, train acc: 0.999, val acc: 0.968
diff 131.29619672055037
epoch 14 train loss: 46.422, val loss: 797.420, train acc: 0.998, val acc: 0.963
diff 139.3805059063419
epoch 15 train loss: 126.185, val loss: 624.639, train acc: 0.996, val acc: 0.970
diff 172.78144195167783
epoch 16 train loss: 41.259, val loss: 727.589, train acc: 0.998, val acc: 0.967
diff 102.95080185089262
epoch 17 train loss: 40.236, val loss: 610.381, train acc: 0.999, val acc: 0.972
diff 117.20824427251159
epoch 18 train loss: 53.970, val loss: 920.291, train acc: 0.998, val acc: 0.966
diff 309.91018288294583
epoch 19 train loss: 70.418, val loss: 741.433, train acc: 0.998, val acc: 0.969
diff 178.8586636470709
epoch 20 train loss: 75.964, val loss: 963.665, train acc: 0.998, val acc: 0.958
diff 222.23187692817328
epoch 21 train loss: 85.561, val loss: 752.364, train acc: 0.997, val acc: 0.972
diff 211.30016658063175
epoch 22 train loss: 46.312, val loss: 744.560, train acc: 0.999, val acc: 0.971
diff 7.803863525853899
epoch 23 train loss: 9.605, val loss: 1047.930, train acc: 1.000, val acc: 0.963
diff 303.36941673768865
epoch 24 train loss: 13.808, val loss: 751.649, train acc: 1.000, val acc: 0.970
diff 296.2807299683867
epoch 25 train loss: 0.289, val loss: 803.141, train acc: 1.000, val acc: 0.970
diff 51.4918696281959
epoch 26 train loss: 0.022, val loss: 822.964, train acc: 1.000, val acc: 0.970
diff 19.82256453383775
epoch 27 train loss: 0.005, val loss: 819.224, train acc: 1.000, val acc: 0.971
diff 3.7398293758516274
epoch 28 train loss: 0.004, val loss: 815.936, train acc: 1.000, val acc: 0.971
diff 3.287701634774862
epoch 29 train loss: 0.003, val loss: 813.694, train acc: 1.000, val acc: 0.971
diff 2.241607478944502
epoch 30 train loss: 0.002, val loss: 811.703, train acc: 1.000, val acc: 0.971
diff 1.9917112322623325
Training model M3
epoch 1 train loss: 63.709, val loss: 1933.175, train acc: 0.998, val acc: 0.953
diff inf
epoch 2 train loss: 76.918, val loss: 2378.317, train acc: 0.998, val acc: 0.944
diff 445.14201449627444
epoch 3 train loss: 0.043, val loss: 2105.671, train acc: 1.000, val acc: 0.954
diff 272.6452731230788
epoch 4 train loss: 0.000, val loss: 2118.756, train acc: 1.000, val acc: 0.953
diff 13.084678443552093
epoch 5 train loss: 0.000, val loss: 2119.880, train acc: 1.000, val acc: 0.953
diff 1.1240941218393345
epoch 6 train loss: 0.000, val loss: 2120.467, train acc: 1.000, val acc: 0.953
diff 0.5867926064752282
epoch 7 train loss: 0.000, val loss: 2120.981, train acc: 1.000, val acc: 0.953
diff 0.5136048401254811
epoch 8 train loss: 0.000, val loss: 2122.684, train acc: 1.000, val acc: 0.953
diff 1.7035469551192364
epoch 9 train loss: 0.000, val loss: 2123.381, train acc: 1.000, val acc: 0.953
diff 0.6972072572243633
epoch 10 train loss: 0.000, val loss: 2124.695, train acc: 1.000, val acc: 0.953
diff 1.3140451094063792
epoch 11 train loss: 0.000, val loss: 2126.797, train acc: 1.000, val acc: 0.954
diff 2.10128854415143
epoch 12 train loss: 0.000, val loss: 2128.775, train acc: 1.000, val acc: 0.954
diff 1.9778715461156935
epoch 13 train loss: 0.000, val loss: 2132.173, train acc: 1.000, val acc: 0.954
diff 3.3979743611066624
epoch 14 train loss: 0.000, val loss: 2134.368, train acc: 1.000, val acc: 0.954
diff 2.1954178846362993
epoch 15 train loss: 0.000, val loss: 2139.003, train acc: 1.000, val acc: 0.954
diff 4.63513450174878
epoch 16 train loss: 0.000, val loss: 2142.511, train acc: 1.000, val acc: 0.954
diff 3.508194471112347
epoch 17 train loss: 0.000, val loss: 2146.184, train acc: 1.000, val acc: 0.954
diff 3.673148202286484
epoch 18 train loss: 0.000, val loss: 2148.895, train acc: 1.000, val acc: 0.954
diff 2.7102937942709104
