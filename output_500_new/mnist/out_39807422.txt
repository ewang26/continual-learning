Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 19, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2581.645, val loss: 128.726, train acc: 0.964, val acc: 0.982
diff inf
epoch 2 train loss: 776.277, val loss: 119.953, train acc: 0.989, val acc: 0.988
diff 8.77245172822387
epoch 3 train loss: 470.566, val loss: 143.835, train acc: 0.993, val acc: 0.985
diff 23.882253879470795
epoch 4 train loss: 391.915, val loss: 94.535, train acc: 0.995, val acc: 0.993
diff 49.30033355658219
epoch 5 train loss: 343.675, val loss: 114.515, train acc: 0.995, val acc: 0.991
diff 19.980206873918675
epoch 6 train loss: 183.470, val loss: 142.540, train acc: 0.997, val acc: 0.988
diff 28.024698064908776
epoch 7 train loss: 212.309, val loss: 177.586, train acc: 0.997, val acc: 0.989
diff 35.04627608313976
epoch 8 train loss: 137.535, val loss: 255.927, train acc: 0.998, val acc: 0.982
diff 78.34089534678282
epoch 9 train loss: 229.711, val loss: 214.889, train acc: 0.997, val acc: 0.985
diff 41.03793007985391
epoch 10 train loss: 63.396, val loss: 174.088, train acc: 0.999, val acc: 0.990
diff 40.80079035393726
epoch 11 train loss: 168.583, val loss: 264.908, train acc: 0.998, val acc: 0.988
diff 90.81946175597429
epoch 12 train loss: 141.008, val loss: 216.000, train acc: 0.998, val acc: 0.990
diff 48.90810153174158
epoch 13 train loss: 114.577, val loss: 377.474, train acc: 0.999, val acc: 0.985
diff 161.4737689726037
epoch 14 train loss: 167.622, val loss: 209.875, train acc: 0.999, val acc: 0.993
diff 167.59827621412308
epoch 15 train loss: 125.867, val loss: 362.304, train acc: 0.999, val acc: 0.985
diff 152.42919343868465
epoch 16 train loss: 148.979, val loss: 309.592, train acc: 0.999, val acc: 0.992
diff 52.71212935999063
epoch 17 train loss: 171.014, val loss: 312.270, train acc: 0.998, val acc: 0.991
diff 2.677513266672463
epoch 18 train loss: 158.434, val loss: 255.983, train acc: 0.998, val acc: 0.991
diff 56.28631640423396
epoch 19 train loss: 174.490, val loss: 398.529, train acc: 0.998, val acc: 0.987
diff 142.5454990575127
epoch 20 train loss: 102.761, val loss: 324.230, train acc: 0.999, val acc: 0.989
diff 74.29863600625157
epoch 21 train loss: 107.139, val loss: 348.217, train acc: 0.999, val acc: 0.990
diff 23.98655439810858
epoch 22 train loss: 152.368, val loss: 426.483, train acc: 0.999, val acc: 0.987
diff 78.26586022051009
epoch 23 train loss: 116.525, val loss: 259.271, train acc: 0.999, val acc: 0.992
diff 167.21162995556557
epoch 24 train loss: 51.686, val loss: 304.319, train acc: 1.000, val acc: 0.992
diff 45.047625799513355
epoch 25 train loss: 167.742, val loss: 287.162, train acc: 0.999, val acc: 0.991
diff 17.156381645106478
epoch 26 train loss: 45.271, val loss: 352.308, train acc: 1.000, val acc: 0.992
diff 65.14533624335883
epoch 27 train loss: 82.015, val loss: 377.925, train acc: 0.999, val acc: 0.992
diff 25.61693635488797
epoch 28 train loss: 173.946, val loss: 759.889, train acc: 0.999, val acc: 0.986
diff 381.9645445229289
epoch 29 train loss: 184.848, val loss: 336.221, train acc: 0.999, val acc: 0.989
diff 423.6684986492639
epoch 30 train loss: 45.201, val loss: 328.899, train acc: 1.000, val acc: 0.992
diff 7.321604394796168
Training model M2
epoch 1 train loss: 3869.974, val loss: 198.339, train acc: 0.956, val acc: 0.982
diff inf
epoch 2 train loss: 1367.830, val loss: 175.862, train acc: 0.984, val acc: 0.984
diff 22.477237362156984
epoch 3 train loss: 851.297, val loss: 229.570, train acc: 0.990, val acc: 0.980
diff 53.70813473447606
epoch 4 train loss: 513.596, val loss: 204.429, train acc: 0.993, val acc: 0.983
diff 25.1413121536807
epoch 5 train loss: 468.139, val loss: 206.994, train acc: 0.994, val acc: 0.986
diff 2.5652291817678474
epoch 6 train loss: 361.496, val loss: 186.046, train acc: 0.996, val acc: 0.988
diff 20.948101000399163
epoch 7 train loss: 346.098, val loss: 187.066, train acc: 0.996, val acc: 0.987
diff 1.0200679190515416
epoch 8 train loss: 263.700, val loss: 259.760, train acc: 0.997, val acc: 0.987
diff 72.69458956900135
epoch 9 train loss: 340.908, val loss: 275.402, train acc: 0.997, val acc: 0.987
diff 15.641446369004143
epoch 10 train loss: 278.113, val loss: 278.383, train acc: 0.997, val acc: 0.987
diff 2.98070954406154
epoch 11 train loss: 203.843, val loss: 263.474, train acc: 0.998, val acc: 0.990
diff 14.908082478933466
epoch 12 train loss: 296.812, val loss: 406.724, train acc: 0.998, val acc: 0.985
diff 143.2496222070717
epoch 13 train loss: 173.163, val loss: 340.251, train acc: 0.999, val acc: 0.987
diff 66.47355848611807
epoch 14 train loss: 287.529, val loss: 449.264, train acc: 0.997, val acc: 0.985
diff 109.01332839745282
epoch 15 train loss: 246.549, val loss: 476.313, train acc: 0.998, val acc: 0.987
diff 27.04928768499201
epoch 16 train loss: 233.817, val loss: 250.924, train acc: 0.998, val acc: 0.990
diff 225.38933737754485
epoch 17 train loss: 263.108, val loss: 495.888, train acc: 0.998, val acc: 0.986
diff 244.963955752218
epoch 18 train loss: 245.250, val loss: 344.132, train acc: 0.998, val acc: 0.990
diff 151.75625761405047
epoch 19 train loss: 106.519, val loss: 453.637, train acc: 0.999, val acc: 0.986
diff 109.50512844141508
epoch 20 train loss: 260.308, val loss: 320.092, train acc: 0.998, val acc: 0.988
diff 133.54497223999152
epoch 21 train loss: 53.686, val loss: 431.196, train acc: 1.000, val acc: 0.988
diff 111.10436619865561
epoch 22 train loss: 295.254, val loss: 670.909, train acc: 0.998, val acc: 0.985
diff 239.71347366570478
epoch 23 train loss: 308.175, val loss: 721.094, train acc: 0.998, val acc: 0.987
diff 50.18483860964557
epoch 24 train loss: 269.535, val loss: 573.378, train acc: 0.998, val acc: 0.989
diff 147.716133100717
epoch 25 train loss: 147.864, val loss: 679.318, train acc: 0.999, val acc: 0.988
diff 105.93967592836077
epoch 26 train loss: 228.860, val loss: 986.243, train acc: 0.999, val acc: 0.981
diff 306.9247158942421
epoch 27 train loss: 313.222, val loss: 909.280, train acc: 0.998, val acc: 0.985
diff 76.96212800439218
epoch 28 train loss: 234.101, val loss: 891.511, train acc: 0.999, val acc: 0.984
diff 17.768987208060366
epoch 29 train loss: 172.895, val loss: 771.686, train acc: 0.999, val acc: 0.988
diff 119.82587858230806
epoch 30 train loss: 279.440, val loss: 1110.400, train acc: 0.999, val acc: 0.985
diff 338.71450625938587
Training model M3
epoch 1 train loss: 1630.268, val loss: 879.704, train acc: 0.924, val acc: 0.911
diff inf
epoch 2 train loss: 417.581, val loss: 527.549, train acc: 0.981, val acc: 0.954
diff 352.1549105292105
epoch 3 train loss: 217.796, val loss: 957.659, train acc: 0.990, val acc: 0.926
diff 430.1092961282342
epoch 4 train loss: 182.310, val loss: 787.680, train acc: 0.990, val acc: 0.944
diff 169.97888951106756
epoch 5 train loss: 73.165, val loss: 874.650, train acc: 0.997, val acc: 0.942
diff 86.97077799719148
epoch 6 train loss: 61.400, val loss: 895.595, train acc: 0.997, val acc: 0.949
diff 20.944612200724464
epoch 7 train loss: 144.259, val loss: 1422.407, train acc: 0.993, val acc: 0.908
diff 526.811776436856
epoch 8 train loss: 78.352, val loss: 765.831, train acc: 0.996, val acc: 0.956
diff 656.5754430300469
epoch 9 train loss: 66.813, val loss: 806.682, train acc: 0.997, val acc: 0.946
diff 40.85099686140427
epoch 10 train loss: 41.381, val loss: 2179.581, train acc: 0.998, val acc: 0.905
diff 1372.8988653234637
epoch 11 train loss: 58.436, val loss: 1134.952, train acc: 0.996, val acc: 0.941
diff 1044.6297157348215
epoch 12 train loss: 99.934, val loss: 1010.099, train acc: 0.996, val acc: 0.946
diff 124.85278288605332
epoch 13 train loss: 52.005, val loss: 1119.238, train acc: 0.998, val acc: 0.948
diff 109.1395253792466
epoch 14 train loss: 9.482, val loss: 1349.208, train acc: 1.000, val acc: 0.947
diff 229.96983140221187
epoch 15 train loss: 117.070, val loss: 1259.161, train acc: 0.996, val acc: 0.943
diff 90.04674783499172
epoch 16 train loss: 74.682, val loss: 1396.724, train acc: 0.998, val acc: 0.933
diff 137.56285231511174
epoch 17 train loss: 21.279, val loss: 1295.263, train acc: 0.999, val acc: 0.953
diff 101.460730348183
epoch 18 train loss: 115.279, val loss: 2388.364, train acc: 0.996, val acc: 0.919
diff 1093.1008960764614
epoch 19 train loss: 30.787, val loss: 1660.228, train acc: 0.999, val acc: 0.942
diff 728.1366871201155
epoch 20 train loss: 19.800, val loss: 1424.418, train acc: 1.000, val acc: 0.944
diff 235.8097459430519
epoch 21 train loss: 58.445, val loss: 1929.172, train acc: 0.997, val acc: 0.934
diff 504.75431643550814
epoch 22 train loss: 81.377, val loss: 1701.666, train acc: 0.997, val acc: 0.935
diff 227.5062286211637
epoch 23 train loss: 34.708, val loss: 1624.856, train acc: 0.999, val acc: 0.936
diff 76.81012192141588
epoch 24 train loss: 1.129, val loss: 1713.506, train acc: 1.000, val acc: 0.936
diff 88.6503531593869
epoch 25 train loss: 0.366, val loss: 1468.342, train acc: 1.000, val acc: 0.941
diff 245.16423210456242
epoch 26 train loss: 0.027, val loss: 1466.438, train acc: 1.000, val acc: 0.942
diff 1.9041869379850596
epoch 27 train loss: 0.012, val loss: 1461.165, train acc: 1.000, val acc: 0.943
diff 5.272887555041052
epoch 28 train loss: 0.008, val loss: 1457.588, train acc: 1.000, val acc: 0.944
diff 3.576540395541315
epoch 29 train loss: 0.006, val loss: 1453.973, train acc: 1.000, val acc: 0.944
diff 3.6158402016928903
epoch 30 train loss: 0.005, val loss: 1453.831, train acc: 1.000, val acc: 0.944
diff 0.14140924906860164
Training model M3
epoch 1 train loss: 67.534, val loss: 2680.692, train acc: 0.998, val acc: 0.923
diff inf
epoch 2 train loss: 0.084, val loss: 2883.008, train acc: 1.000, val acc: 0.923
diff 202.31588314061582
epoch 3 train loss: 0.001, val loss: 2811.072, train acc: 1.000, val acc: 0.925
diff 71.93581650400529
epoch 4 train loss: 0.000, val loss: 2843.164, train acc: 1.000, val acc: 0.926
diff 32.09172301940907
epoch 5 train loss: 0.000, val loss: 2855.673, train acc: 1.000, val acc: 0.926
diff 12.50872122418832
epoch 6 train loss: 0.000, val loss: 2858.790, train acc: 1.000, val acc: 0.926
diff 3.117762684988975
epoch 7 train loss: 0.000, val loss: 2862.374, train acc: 1.000, val acc: 0.926
diff 3.5840335575294375
epoch 8 train loss: 0.000, val loss: 2874.059, train acc: 1.000, val acc: 0.926
diff 11.68481221914135
epoch 9 train loss: 0.000, val loss: 2881.473, train acc: 1.000, val acc: 0.925
diff 7.4135719365681325
epoch 10 train loss: 0.000, val loss: 2894.721, train acc: 1.000, val acc: 0.925
diff 13.247748961482102
epoch 11 train loss: 0.000, val loss: 2892.706, train acc: 1.000, val acc: 0.925
diff 2.0141954873806753
epoch 12 train loss: 0.000, val loss: 2889.224, train acc: 1.000, val acc: 0.926
diff 3.4826880205000634
epoch 13 train loss: 0.000, val loss: 2916.329, train acc: 1.000, val acc: 0.925
diff 27.10542669031929
epoch 14 train loss: 0.000, val loss: 2898.338, train acc: 1.000, val acc: 0.926
diff 17.991078927429044
epoch 15 train loss: 0.000, val loss: 2931.711, train acc: 1.000, val acc: 0.925
diff 33.373446374556806
epoch 16 train loss: 0.000, val loss: 2939.609, train acc: 1.000, val acc: 0.925
diff 7.897349167328684
epoch 17 train loss: 0.000, val loss: 3007.665, train acc: 1.000, val acc: 0.924
diff 68.05638443867838
epoch 18 train loss: 0.000, val loss: 3040.322, train acc: 1.000, val acc: 0.924
diff 32.65660756400803
epoch 19 train loss: 0.000, val loss: 3013.186, train acc: 1.000, val acc: 0.924
diff 27.13596916280494
epoch 20 train loss: 0.000, val loss: 3056.502, train acc: 1.000, val acc: 0.924
diff 43.31610952983692
epoch 21 train loss: 0.000, val loss: 3063.629, train acc: 1.000, val acc: 0.925
diff 7.127148097879399
epoch 22 train loss: 0.000, val loss: 3101.652, train acc: 1.000, val acc: 0.924
diff 38.02294258866277
epoch 23 train loss: 0.000, val loss: 3085.316, train acc: 1.000, val acc: 0.925
diff 16.335575525916283
epoch 24 train loss: 0.000, val loss: 3138.920, train acc: 1.000, val acc: 0.923
diff 53.60350264265162
epoch 25 train loss: 0.000, val loss: 3148.397, train acc: 1.000, val acc: 0.922
diff 9.477192884635315
epoch 26 train loss: 0.000, val loss: 3163.307, train acc: 1.000, val acc: 0.922
diff 14.909451062627795
epoch 27 train loss: 0.000, val loss: 3199.837, train acc: 1.000, val acc: 0.922
diff 36.53049982848188
epoch 28 train loss: 0.000, val loss: 3220.728, train acc: 1.000, val acc: 0.921
diff 20.89094759786167
epoch 29 train loss: 0.000, val loss: 3262.140, train acc: 1.000, val acc: 0.921
diff 41.4121987681292
epoch 30 train loss: 0.000, val loss: 3257.193, train acc: 1.000, val acc: 0.920
diff 4.9468169403571665
Training model M3
epoch 1 train loss: 1241.193, val loss: 349.768, train acc: 0.965, val acc: 0.972
diff inf
epoch 2 train loss: 241.653, val loss: 283.395, train acc: 0.989, val acc: 0.978
diff 66.37277566892885
epoch 3 train loss: 62.513, val loss: 374.577, train acc: 0.998, val acc: 0.973
diff 91.18151251517827
epoch 4 train loss: 65.818, val loss: 405.269, train acc: 0.997, val acc: 0.977
diff 30.692022340020685
epoch 5 train loss: 10.638, val loss: 401.969, train acc: 1.000, val acc: 0.977
diff 3.300039073965081
epoch 6 train loss: 1.339, val loss: 436.613, train acc: 1.000, val acc: 0.978
diff 34.64415331466557
epoch 7 train loss: 0.330, val loss: 447.774, train acc: 1.000, val acc: 0.978
diff 11.16104808160685
epoch 8 train loss: 0.175, val loss: 457.061, train acc: 1.000, val acc: 0.978
diff 9.286907161526926
epoch 9 train loss: 0.114, val loss: 467.310, train acc: 1.000, val acc: 0.978
diff 10.249398698112543
epoch 10 train loss: 0.077, val loss: 478.745, train acc: 1.000, val acc: 0.978
diff 11.434309908791874
epoch 11 train loss: 0.053, val loss: 489.914, train acc: 1.000, val acc: 0.978
diff 11.1693080016301
epoch 12 train loss: 0.037, val loss: 500.965, train acc: 1.000, val acc: 0.978
diff 11.050584798915338
epoch 13 train loss: 0.025, val loss: 512.861, train acc: 1.000, val acc: 0.978
diff 11.89619310312861
epoch 14 train loss: 0.017, val loss: 523.122, train acc: 1.000, val acc: 0.978
diff 10.261144641154601
epoch 15 train loss: 0.012, val loss: 532.326, train acc: 1.000, val acc: 0.978
diff 9.203964554307618
epoch 16 train loss: 0.008, val loss: 544.544, train acc: 1.000, val acc: 0.978
diff 12.218172586547325
epoch 17 train loss: 0.006, val loss: 555.066, train acc: 1.000, val acc: 0.978
diff 10.522278353415118
epoch 18 train loss: 0.004, val loss: 566.895, train acc: 1.000, val acc: 0.978
diff 11.828897833766177
epoch 19 train loss: 0.003, val loss: 578.712, train acc: 1.000, val acc: 0.978
diff 11.816418677297861
epoch 20 train loss: 0.002, val loss: 589.245, train acc: 1.000, val acc: 0.978
diff 10.533428426468163
epoch 21 train loss: 0.001, val loss: 600.287, train acc: 1.000, val acc: 0.978
diff 11.04193293908395
epoch 22 train loss: 0.001, val loss: 612.039, train acc: 1.000, val acc: 0.979
diff 11.752151576810775
epoch 23 train loss: 0.001, val loss: 623.941, train acc: 1.000, val acc: 0.978
diff 11.901300821696736
epoch 24 train loss: 0.000, val loss: 636.615, train acc: 1.000, val acc: 0.978
diff 12.674438019896115
epoch 25 train loss: 0.000, val loss: 647.212, train acc: 1.000, val acc: 0.978
diff 10.59727359437727
epoch 26 train loss: 0.000, val loss: 658.924, train acc: 1.000, val acc: 0.979
diff 11.712181548302624
epoch 27 train loss: 0.000, val loss: 670.179, train acc: 1.000, val acc: 0.979
diff 11.254688867006166
epoch 28 train loss: 0.000, val loss: 679.819, train acc: 1.000, val acc: 0.979
diff 9.639635191521847
epoch 29 train loss: 0.000, val loss: 694.076, train acc: 1.000, val acc: 0.979
diff 14.2569295132472
epoch 30 train loss: 0.000, val loss: 705.875, train acc: 1.000, val acc: 0.979
diff 11.799005432707986
2
2
