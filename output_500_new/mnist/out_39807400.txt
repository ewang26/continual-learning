Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 6, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2451.660, val loss: 146.641, train acc: 0.966, val acc: 0.981
diff inf
epoch 2 train loss: 778.901, val loss: 141.387, train acc: 0.988, val acc: 0.984
diff 5.254285715479142
epoch 3 train loss: 507.966, val loss: 144.919, train acc: 0.993, val acc: 0.986
diff 3.531583102456807
epoch 4 train loss: 393.028, val loss: 122.485, train acc: 0.994, val acc: 0.989
diff 22.433843217687894
epoch 5 train loss: 269.025, val loss: 151.037, train acc: 0.996, val acc: 0.988
diff 28.552055462866946
epoch 6 train loss: 174.254, val loss: 118.633, train acc: 0.998, val acc: 0.992
diff 32.40401294542447
epoch 7 train loss: 246.464, val loss: 189.752, train acc: 0.997, val acc: 0.989
diff 71.1194139409305
epoch 8 train loss: 205.480, val loss: 154.008, train acc: 0.997, val acc: 0.992
diff 35.744080583370476
epoch 9 train loss: 219.939, val loss: 132.472, train acc: 0.997, val acc: 0.991
diff 21.5356713376392
epoch 10 train loss: 106.713, val loss: 201.307, train acc: 0.998, val acc: 0.992
diff 68.83431641035762
epoch 11 train loss: 204.991, val loss: 298.016, train acc: 0.998, val acc: 0.988
diff 96.70885117462066
epoch 12 train loss: 154.183, val loss: 243.552, train acc: 0.998, val acc: 0.990
diff 54.46310994787234
epoch 13 train loss: 140.375, val loss: 230.070, train acc: 0.998, val acc: 0.988
diff 13.48227351613832
epoch 14 train loss: 185.277, val loss: 238.247, train acc: 0.998, val acc: 0.989
diff 8.176363667617778
epoch 15 train loss: 119.369, val loss: 258.422, train acc: 0.999, val acc: 0.990
diff 20.175573935445897
epoch 16 train loss: 127.652, val loss: 265.328, train acc: 0.999, val acc: 0.991
diff 6.905752284244215
epoch 17 train loss: 127.908, val loss: 410.528, train acc: 0.999, val acc: 0.989
diff 145.19986935325272
epoch 18 train loss: 195.536, val loss: 302.080, train acc: 0.998, val acc: 0.988
diff 108.44764940141317
epoch 19 train loss: 199.193, val loss: 327.198, train acc: 0.999, val acc: 0.991
diff 25.118296976899956
epoch 20 train loss: 139.933, val loss: 345.919, train acc: 0.999, val acc: 0.992
diff 18.720242827075765
epoch 21 train loss: 193.775, val loss: 235.099, train acc: 0.999, val acc: 0.990
diff 110.81982870781701
epoch 22 train loss: 52.192, val loss: 275.508, train acc: 0.999, val acc: 0.992
diff 40.40923247875082
epoch 23 train loss: 101.436, val loss: 253.546, train acc: 0.999, val acc: 0.992
diff 21.962403695074272
epoch 24 train loss: 11.330, val loss: 346.073, train acc: 1.000, val acc: 0.990
diff 92.52782873253392
epoch 25 train loss: 200.486, val loss: 527.654, train acc: 0.999, val acc: 0.989
diff 181.58092673596258
epoch 26 train loss: 217.178, val loss: 404.939, train acc: 0.999, val acc: 0.991
diff 122.71497789839964
epoch 27 train loss: 82.811, val loss: 552.774, train acc: 1.000, val acc: 0.990
diff 147.83443165478673
epoch 28 train loss: 206.149, val loss: 563.299, train acc: 0.999, val acc: 0.988
diff 10.525302749563934
epoch 29 train loss: 169.322, val loss: 508.834, train acc: 0.999, val acc: 0.990
diff 54.46499709744285
epoch 30 train loss: 148.116, val loss: 409.056, train acc: 0.999, val acc: 0.992
diff 99.77821393861245
Training model M2
epoch 1 train loss: 3877.805, val loss: 164.181, train acc: 0.956, val acc: 0.984
diff inf
epoch 2 train loss: 1335.170, val loss: 179.662, train acc: 0.985, val acc: 0.984
diff 15.480194369093454
epoch 3 train loss: 772.336, val loss: 231.405, train acc: 0.991, val acc: 0.983
diff 51.74346272168282
epoch 4 train loss: 567.808, val loss: 180.829, train acc: 0.993, val acc: 0.986
diff 50.57574621039316
epoch 5 train loss: 446.097, val loss: 268.012, train acc: 0.995, val acc: 0.986
diff 87.18279230671845
epoch 6 train loss: 345.488, val loss: 235.843, train acc: 0.996, val acc: 0.987
diff 32.16892580724553
epoch 7 train loss: 404.800, val loss: 234.004, train acc: 0.996, val acc: 0.987
diff 1.8394548509030813
epoch 8 train loss: 254.258, val loss: 252.405, train acc: 0.998, val acc: 0.985
diff 18.401398763365222
epoch 9 train loss: 338.884, val loss: 289.359, train acc: 0.997, val acc: 0.982
diff 36.95357002393652
epoch 10 train loss: 219.657, val loss: 269.480, train acc: 0.998, val acc: 0.986
diff 19.87850429638121
epoch 11 train loss: 317.969, val loss: 372.280, train acc: 0.997, val acc: 0.988
diff 102.79984848548543
epoch 12 train loss: 250.352, val loss: 411.346, train acc: 0.998, val acc: 0.983
diff 39.06644440380114
epoch 13 train loss: 197.588, val loss: 305.886, train acc: 0.998, val acc: 0.989
diff 105.46077751884849
epoch 14 train loss: 300.338, val loss: 676.883, train acc: 0.998, val acc: 0.982
diff 370.99774931427356
epoch 15 train loss: 238.657, val loss: 301.021, train acc: 0.998, val acc: 0.988
diff 375.86277912221925
epoch 16 train loss: 267.882, val loss: 557.445, train acc: 0.998, val acc: 0.982
diff 256.42428225452915
epoch 17 train loss: 173.381, val loss: 450.749, train acc: 0.999, val acc: 0.989
diff 106.69634744371245
epoch 18 train loss: 272.466, val loss: 487.472, train acc: 0.998, val acc: 0.987
diff 36.72351693979505
epoch 19 train loss: 208.893, val loss: 466.600, train acc: 0.998, val acc: 0.986
diff 20.872387991376
epoch 20 train loss: 197.369, val loss: 519.838, train acc: 0.999, val acc: 0.988
diff 53.23843752767078
epoch 21 train loss: 185.220, val loss: 478.215, train acc: 0.999, val acc: 0.989
diff 41.6232019231424
epoch 22 train loss: 335.244, val loss: 571.942, train acc: 0.998, val acc: 0.988
diff 93.72752595410196
epoch 23 train loss: 170.326, val loss: 703.205, train acc: 0.999, val acc: 0.988
diff 131.2625141849636
epoch 24 train loss: 344.922, val loss: 724.781, train acc: 0.998, val acc: 0.985
diff 21.575827586534842
epoch 25 train loss: 184.783, val loss: 960.249, train acc: 0.999, val acc: 0.982
diff 235.46787537965963
epoch 26 train loss: 317.265, val loss: 645.589, train acc: 0.999, val acc: 0.985
diff 314.6596620468142
epoch 27 train loss: 233.494, val loss: 563.144, train acc: 0.999, val acc: 0.988
diff 82.4448591581355
epoch 28 train loss: 83.914, val loss: 784.287, train acc: 0.999, val acc: 0.987
diff 221.14274232241598
epoch 29 train loss: 238.801, val loss: 785.415, train acc: 0.999, val acc: 0.988
diff 1.128077411060758
epoch 30 train loss: 367.417, val loss: 804.053, train acc: 0.999, val acc: 0.988
diff 18.637593814414117
Training model M3
epoch 1 train loss: 1764.124, val loss: 809.726, train acc: 0.918, val acc: 0.919
diff inf
epoch 2 train loss: 444.508, val loss: 491.887, train acc: 0.980, val acc: 0.958
diff 317.83934498111427
epoch 3 train loss: 252.466, val loss: 639.256, train acc: 0.988, val acc: 0.944
diff 147.36906162063264
epoch 4 train loss: 153.398, val loss: 485.069, train acc: 0.993, val acc: 0.961
diff 154.18688400306831
epoch 5 train loss: 139.776, val loss: 760.292, train acc: 0.994, val acc: 0.951
diff 275.2228745438313
epoch 6 train loss: 48.308, val loss: 919.525, train acc: 0.998, val acc: 0.946
diff 159.23351344942716
epoch 7 train loss: 131.734, val loss: 977.717, train acc: 0.994, val acc: 0.933
diff 58.19179533121621
epoch 8 train loss: 94.430, val loss: 1485.668, train acc: 0.996, val acc: 0.910
diff 507.9509320275969
epoch 9 train loss: 45.510, val loss: 867.990, train acc: 0.998, val acc: 0.954
diff 617.6784870758022
epoch 10 train loss: 6.584, val loss: 886.256, train acc: 1.000, val acc: 0.959
diff 18.266051511829005
epoch 11 train loss: 200.982, val loss: 804.357, train acc: 0.992, val acc: 0.956
diff 81.89891109603775
epoch 12 train loss: 34.441, val loss: 1698.162, train acc: 0.998, val acc: 0.928
diff 893.804744721295
epoch 13 train loss: 71.101, val loss: 985.129, train acc: 0.997, val acc: 0.946
diff 713.0330487160371
epoch 14 train loss: 19.543, val loss: 1228.136, train acc: 0.999, val acc: 0.946
diff 243.0074908407447
epoch 15 train loss: 85.804, val loss: 1338.127, train acc: 0.996, val acc: 0.936
diff 109.99078429404722
epoch 16 train loss: 108.619, val loss: 1635.854, train acc: 0.995, val acc: 0.931
diff 297.7268844726757
epoch 17 train loss: 23.740, val loss: 1454.797, train acc: 0.999, val acc: 0.944
diff 181.05660312273653
epoch 18 train loss: 3.267, val loss: 1229.344, train acc: 1.000, val acc: 0.952
diff 225.45266809197915
epoch 19 train loss: 0.088, val loss: 1210.287, train acc: 1.000, val acc: 0.953
diff 19.05771655589365
epoch 20 train loss: 0.047, val loss: 1208.458, train acc: 1.000, val acc: 0.953
diff 1.828452596131001
epoch 21 train loss: 0.036, val loss: 1210.580, train acc: 1.000, val acc: 0.954
diff 2.1221258242353542
epoch 22 train loss: 0.027, val loss: 1214.156, train acc: 1.000, val acc: 0.954
diff 3.575964734641275
epoch 23 train loss: 0.020, val loss: 1219.469, train acc: 1.000, val acc: 0.954
diff 5.312929034316312
epoch 24 train loss: 0.016, val loss: 1228.139, train acc: 1.000, val acc: 0.954
diff 8.670122621231258
epoch 25 train loss: 0.012, val loss: 1238.467, train acc: 1.000, val acc: 0.954
diff 10.327599815540225
epoch 26 train loss: 0.009, val loss: 1250.771, train acc: 1.000, val acc: 0.954
diff 12.303628661397624
epoch 27 train loss: 0.006, val loss: 1265.270, train acc: 1.000, val acc: 0.954
diff 14.499229889794606
epoch 28 train loss: 0.005, val loss: 1279.706, train acc: 1.000, val acc: 0.954
diff 14.43568487198877
epoch 29 train loss: 0.003, val loss: 1296.364, train acc: 1.000, val acc: 0.954
diff 16.65829413172446
epoch 30 train loss: 0.003, val loss: 1312.661, train acc: 1.000, val acc: 0.954
diff 16.297556890974192
Training model M3
epoch 1 train loss: 23.379, val loss: 3049.019, train acc: 0.999, val acc: 0.919
diff inf
epoch 2 train loss: 0.002, val loss: 2361.222, train acc: 1.000, val acc: 0.939
diff 687.7973923226864
epoch 3 train loss: 0.000, val loss: 2415.016, train acc: 1.000, val acc: 0.938
diff 53.79378549535022
epoch 4 train loss: 0.000, val loss: 2441.697, train acc: 1.000, val acc: 0.938
diff 26.68109234728854
epoch 5 train loss: 0.000, val loss: 2455.782, train acc: 1.000, val acc: 0.937
diff 14.084790103008345
epoch 6 train loss: 0.000, val loss: 2473.247, train acc: 1.000, val acc: 0.938
diff 17.465569009450974
epoch 7 train loss: 0.000, val loss: 2494.922, train acc: 1.000, val acc: 0.938
diff 21.674981698919964
epoch 8 train loss: 0.000, val loss: 2515.955, train acc: 1.000, val acc: 0.938
diff 21.032350596916785
epoch 9 train loss: 0.000, val loss: 2538.515, train acc: 1.000, val acc: 0.938
diff 22.560108483537988
epoch 10 train loss: 0.000, val loss: 2558.849, train acc: 1.000, val acc: 0.938
diff 20.334192560281735
epoch 11 train loss: 0.000, val loss: 2584.542, train acc: 1.000, val acc: 0.938
diff 25.693156965527578
epoch 12 train loss: 0.000, val loss: 2606.470, train acc: 1.000, val acc: 0.938
diff 21.928346301848705
epoch 13 train loss: 0.000, val loss: 2626.832, train acc: 1.000, val acc: 0.937
diff 20.361996387250656
epoch 14 train loss: 0.000, val loss: 2656.614, train acc: 1.000, val acc: 0.937
diff 29.781249580318217
epoch 15 train loss: 0.000, val loss: 2674.199, train acc: 1.000, val acc: 0.937
diff 17.58503574103179
epoch 16 train loss: 0.000, val loss: 2700.294, train acc: 1.000, val acc: 0.936
diff 26.095688985680226
epoch 17 train loss: 0.000, val loss: 2717.567, train acc: 1.000, val acc: 0.936
diff 17.27241549550081
epoch 18 train loss: 0.000, val loss: 2740.606, train acc: 1.000, val acc: 0.936
diff 23.03906799636934
epoch 19 train loss: 0.000, val loss: 2753.282, train acc: 1.000, val acc: 0.936
diff 12.675654319330988
epoch 20 train loss: 0.000, val loss: 2776.133, train acc: 1.000, val acc: 0.936
diff 22.85160702498206
epoch 21 train loss: 0.000, val loss: 2784.166, train acc: 1.000, val acc: 0.935
diff 8.03247353744564
epoch 22 train loss: 0.000, val loss: 2799.568, train acc: 1.000, val acc: 0.935
diff 15.402424705572685
epoch 23 train loss: 0.000, val loss: 2817.789, train acc: 1.000, val acc: 0.935
diff 18.220520211956682
epoch 24 train loss: 0.000, val loss: 2829.965, train acc: 1.000, val acc: 0.936
diff 12.176409639723715
epoch 25 train loss: 0.000, val loss: 2842.488, train acc: 1.000, val acc: 0.936
diff 12.522838671382942
epoch 26 train loss: 0.000, val loss: 2845.947, train acc: 1.000, val acc: 0.937
diff 3.4589203644295594
epoch 27 train loss: 0.000, val loss: 2866.784, train acc: 1.000, val acc: 0.936
diff 20.83748758155525
epoch 28 train loss: 0.000, val loss: 2880.089, train acc: 1.000, val acc: 0.937
diff 13.304834957746607
epoch 29 train loss: 0.000, val loss: 2889.292, train acc: 1.000, val acc: 0.937
diff 9.202624246734558
epoch 30 train loss: 0.000, val loss: 2888.374, train acc: 1.000, val acc: 0.937
diff 0.9177032011916708
Training model M3
epoch 1 train loss: 1249.155, val loss: 212.097, train acc: 0.958, val acc: 0.977
diff inf
epoch 2 train loss: 251.649, val loss: 278.823, train acc: 0.988, val acc: 0.977
diff 66.72577964287058
epoch 3 train loss: 91.757, val loss: 258.296, train acc: 0.995, val acc: 0.980
diff 20.527133090968277
epoch 4 train loss: 28.647, val loss: 299.057, train acc: 0.999, val acc: 0.982
diff 40.76078668090878
epoch 5 train loss: 3.620, val loss: 298.013, train acc: 1.000, val acc: 0.985
diff 1.0438057879907774
epoch 6 train loss: 0.569, val loss: 312.618, train acc: 1.000, val acc: 0.986
diff 14.605007436041888
epoch 7 train loss: 0.239, val loss: 322.294, train acc: 1.000, val acc: 0.986
diff 9.67589236762808
epoch 8 train loss: 0.157, val loss: 331.869, train acc: 1.000, val acc: 0.986
diff 9.575586247431772
epoch 9 train loss: 0.108, val loss: 340.955, train acc: 1.000, val acc: 0.986
diff 9.085606829913672
epoch 10 train loss: 0.074, val loss: 349.573, train acc: 1.000, val acc: 0.986
diff 8.618132630847299
epoch 11 train loss: 0.051, val loss: 358.592, train acc: 1.000, val acc: 0.986
diff 9.018542866095459
epoch 12 train loss: 0.035, val loss: 366.536, train acc: 1.000, val acc: 0.986
diff 7.944019885713772
epoch 13 train loss: 0.023, val loss: 377.985, train acc: 1.000, val acc: 0.987
diff 11.449273114764765
epoch 14 train loss: 0.016, val loss: 385.302, train acc: 1.000, val acc: 0.987
diff 7.316785535004044
epoch 15 train loss: 0.010, val loss: 395.435, train acc: 1.000, val acc: 0.986
diff 10.133183768466154
epoch 16 train loss: 0.007, val loss: 409.251, train acc: 1.000, val acc: 0.986
diff 13.815957364153405
epoch 17 train loss: 0.004, val loss: 424.370, train acc: 1.000, val acc: 0.985
diff 15.118684970062873
epoch 18 train loss: 0.003, val loss: 432.916, train acc: 1.000, val acc: 0.985
diff 8.546727488262263
epoch 19 train loss: 0.002, val loss: 447.107, train acc: 1.000, val acc: 0.985
diff 14.19070313023542
epoch 20 train loss: 0.001, val loss: 460.497, train acc: 1.000, val acc: 0.985
diff 13.390305882360451
epoch 21 train loss: 0.001, val loss: 471.021, train acc: 1.000, val acc: 0.984
diff 10.524147300026414
epoch 22 train loss: 0.001, val loss: 481.896, train acc: 1.000, val acc: 0.984
diff 10.87487697183883
epoch 23 train loss: 0.000, val loss: 502.090, train acc: 1.000, val acc: 0.984
diff 20.194071045967917
epoch 24 train loss: 0.000, val loss: 508.158, train acc: 1.000, val acc: 0.983
diff 6.067185219457201
epoch 25 train loss: 0.000, val loss: 520.645, train acc: 1.000, val acc: 0.984
diff 12.48713340453827
epoch 26 train loss: 0.000, val loss: 532.377, train acc: 1.000, val acc: 0.984
diff 11.732365133939538
epoch 27 train loss: 0.000, val loss: 543.892, train acc: 1.000, val acc: 0.983
diff 11.514720855963219
epoch 28 train loss: 0.000, val loss: 553.530, train acc: 1.000, val acc: 0.983
diff 9.637980300758386
epoch 29 train loss: 0.000, val loss: 567.032, train acc: 1.000, val acc: 0.983
diff 13.502577979170269
epoch 30 train loss: 0.000, val loss: 592.274, train acc: 1.000, val acc: 0.983
diff 25.241225758981386
2
2
