Using CUDA
Running experiment mnist:
Results are stored in: output_500_new/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 0, 'class_balanced': True, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 2460.479, val loss: 123.867, train acc: 0.966, val acc: 0.985
diff inf
epoch 2 train loss: 751.943, val loss: 144.683, train acc: 0.989, val acc: 0.984
diff 20.81630358188832
epoch 3 train loss: 511.368, val loss: 79.854, train acc: 0.993, val acc: 0.992
diff 64.82912344685786
epoch 4 train loss: 335.965, val loss: 98.634, train acc: 0.996, val acc: 0.990
diff 18.779958518947694
epoch 5 train loss: 270.576, val loss: 176.650, train acc: 0.996, val acc: 0.984
diff 78.01574727013013
epoch 6 train loss: 248.534, val loss: 102.028, train acc: 0.997, val acc: 0.992
diff 74.62210952492491
epoch 7 train loss: 186.974, val loss: 217.516, train acc: 0.998, val acc: 0.983
diff 115.48791454690333
epoch 8 train loss: 187.995, val loss: 104.880, train acc: 0.998, val acc: 0.993
diff 112.63618134672296
epoch 9 train loss: 105.653, val loss: 207.513, train acc: 0.999, val acc: 0.990
diff 102.63371336295637
epoch 10 train loss: 238.589, val loss: 192.720, train acc: 0.997, val acc: 0.990
diff 14.793724677862798
epoch 11 train loss: 109.074, val loss: 192.341, train acc: 0.998, val acc: 0.988
diff 0.3787585096973203
epoch 12 train loss: 146.593, val loss: 235.447, train acc: 0.998, val acc: 0.988
diff 43.10576542588595
epoch 13 train loss: 169.000, val loss: 230.418, train acc: 0.998, val acc: 0.989
diff 5.028207785257678
epoch 14 train loss: 132.325, val loss: 149.656, train acc: 0.999, val acc: 0.993
diff 80.76241687755589
epoch 15 train loss: 176.239, val loss: 253.028, train acc: 0.998, val acc: 0.991
diff 103.37248617215067
epoch 16 train loss: 224.191, val loss: 220.455, train acc: 0.998, val acc: 0.988
diff 32.57297524898732
epoch 17 train loss: 83.563, val loss: 245.031, train acc: 0.999, val acc: 0.993
diff 24.57601439234449
epoch 18 train loss: 173.449, val loss: 429.874, train acc: 0.998, val acc: 0.983
diff 184.84254384309915
epoch 19 train loss: 131.923, val loss: 239.847, train acc: 0.999, val acc: 0.991
diff 190.02667134334376
epoch 20 train loss: 66.802, val loss: 293.522, train acc: 0.999, val acc: 0.991
diff 53.67450119463143
epoch 21 train loss: 145.397, val loss: 300.446, train acc: 0.999, val acc: 0.993
diff 6.924622797660504
epoch 22 train loss: 65.943, val loss: 219.236, train acc: 0.999, val acc: 0.993
diff 81.21065837135902
epoch 23 train loss: 154.884, val loss: 485.105, train acc: 0.999, val acc: 0.990
diff 265.86929289090074
epoch 24 train loss: 119.563, val loss: 347.153, train acc: 0.999, val acc: 0.993
diff 137.95195167568323
epoch 25 train loss: 53.499, val loss: 463.770, train acc: 1.000, val acc: 0.993
diff 116.61706645128987
epoch 26 train loss: 118.556, val loss: 543.743, train acc: 0.999, val acc: 0.990
diff 79.9731455244945
epoch 27 train loss: 184.565, val loss: 465.612, train acc: 0.999, val acc: 0.993
diff 78.13142717839287
epoch 28 train loss: 139.708, val loss: 414.508, train acc: 0.999, val acc: 0.993
diff 51.1040508953202
epoch 29 train loss: 42.346, val loss: 509.927, train acc: 1.000, val acc: 0.988
diff 95.41876322635915
epoch 30 train loss: 259.128, val loss: 689.539, train acc: 0.999, val acc: 0.990
diff 179.61226585042306
Training model M2
epoch 1 train loss: 3961.719, val loss: 195.544, train acc: 0.954, val acc: 0.982
diff inf
epoch 2 train loss: 1342.979, val loss: 182.945, train acc: 0.985, val acc: 0.980
diff 12.598877379213548
epoch 3 train loss: 806.433, val loss: 175.748, train acc: 0.990, val acc: 0.987
diff 7.197019188008397
epoch 4 train loss: 516.708, val loss: 252.243, train acc: 0.994, val acc: 0.983
diff 76.49493782697152
epoch 5 train loss: 448.004, val loss: 189.288, train acc: 0.995, val acc: 0.984
diff 62.95501305636623
epoch 6 train loss: 338.444, val loss: 208.393, train acc: 0.996, val acc: 0.988
diff 19.10450550824521
epoch 7 train loss: 318.691, val loss: 326.500, train acc: 0.997, val acc: 0.982
diff 118.1069705763125
epoch 8 train loss: 322.019, val loss: 302.493, train acc: 0.997, val acc: 0.985
diff 24.00687658684575
epoch 9 train loss: 350.785, val loss: 291.530, train acc: 0.997, val acc: 0.986
diff 10.962551214275095
epoch 10 train loss: 249.416, val loss: 285.837, train acc: 0.997, val acc: 0.987
diff 5.69360777487401
epoch 11 train loss: 277.474, val loss: 367.489, train acc: 0.997, val acc: 0.984
diff 81.65229146592878
epoch 12 train loss: 289.627, val loss: 348.853, train acc: 0.998, val acc: 0.986
diff 18.635888554603525
epoch 13 train loss: 309.080, val loss: 417.886, train acc: 0.997, val acc: 0.984
diff 69.03315738510878
epoch 14 train loss: 198.523, val loss: 391.277, train acc: 0.998, val acc: 0.985
diff 26.609371865250807
epoch 15 train loss: 254.119, val loss: 369.885, train acc: 0.998, val acc: 0.986
diff 21.39240351571624
epoch 16 train loss: 314.125, val loss: 352.788, train acc: 0.998, val acc: 0.987
diff 17.096436951261353
epoch 17 train loss: 272.765, val loss: 363.371, train acc: 0.998, val acc: 0.988
diff 10.582855819781514
epoch 18 train loss: 158.955, val loss: 500.804, train acc: 0.998, val acc: 0.984
diff 137.43320484993063
epoch 19 train loss: 282.369, val loss: 545.306, train acc: 0.998, val acc: 0.987
diff 44.50185719938344
epoch 20 train loss: 321.790, val loss: 615.602, train acc: 0.998, val acc: 0.984
diff 70.29579667558198
epoch 21 train loss: 213.896, val loss: 558.099, train acc: 0.998, val acc: 0.985
diff 57.50327483076478
epoch 22 train loss: 246.735, val loss: 704.736, train acc: 0.999, val acc: 0.986
diff 146.63778296260716
epoch 23 train loss: 306.876, val loss: 643.754, train acc: 0.999, val acc: 0.984
diff 60.98263926405434
epoch 24 train loss: 153.778, val loss: 558.054, train acc: 0.999, val acc: 0.987
diff 85.69994535812964
epoch 25 train loss: 199.010, val loss: 567.798, train acc: 0.999, val acc: 0.984
diff 9.743845894447759
epoch 26 train loss: 244.243, val loss: 821.600, train acc: 0.998, val acc: 0.982
diff 253.8026548850512
epoch 27 train loss: 254.232, val loss: 574.753, train acc: 0.999, val acc: 0.990
diff 246.84764061477915
epoch 28 train loss: 174.047, val loss: 684.736, train acc: 0.999, val acc: 0.982
diff 109.98336334336398
epoch 29 train loss: 258.359, val loss: 933.943, train acc: 0.999, val acc: 0.985
diff 249.2071675748382
epoch 30 train loss: 207.371, val loss: 1037.522, train acc: 0.999, val acc: 0.985
diff 103.57874493368331
Training model M3
epoch 1 train loss: 1827.147, val loss: 876.750, train acc: 0.914, val acc: 0.903
diff inf
epoch 2 train loss: 460.044, val loss: 615.089, train acc: 0.978, val acc: 0.944
diff 261.6607784470133
epoch 3 train loss: 239.887, val loss: 1421.715, train acc: 0.990, val acc: 0.884
diff 806.626155648185
epoch 4 train loss: 200.538, val loss: 743.945, train acc: 0.989, val acc: 0.947
diff 677.7702985917855
epoch 5 train loss: 153.083, val loss: 660.639, train acc: 0.992, val acc: 0.948
diff 83.30619839320684
epoch 6 train loss: 44.593, val loss: 608.402, train acc: 0.998, val acc: 0.956
diff 52.23676119580705
epoch 7 train loss: 120.740, val loss: 958.431, train acc: 0.994, val acc: 0.929
diff 350.029194621534
epoch 8 train loss: 11.753, val loss: 825.539, train acc: 1.000, val acc: 0.951
diff 132.8917230149424
epoch 9 train loss: 149.637, val loss: 1558.276, train acc: 0.992, val acc: 0.911
diff 732.7364963104402
epoch 10 train loss: 76.017, val loss: 798.616, train acc: 0.997, val acc: 0.955
diff 759.6594973230767
epoch 11 train loss: 23.253, val loss: 1266.956, train acc: 0.999, val acc: 0.938
diff 468.33936288425116
epoch 12 train loss: 61.893, val loss: 739.268, train acc: 0.997, val acc: 0.956
diff 527.6876730513183
epoch 13 train loss: 34.306, val loss: 1374.821, train acc: 0.998, val acc: 0.931
diff 635.5529259598208
epoch 14 train loss: 80.620, val loss: 1405.140, train acc: 0.997, val acc: 0.940
diff 30.319469707220605
epoch 15 train loss: 38.825, val loss: 1383.046, train acc: 0.998, val acc: 0.943
diff 22.094076013104768
epoch 16 train loss: 87.482, val loss: 1479.547, train acc: 0.997, val acc: 0.931
diff 96.5009313381147
epoch 17 train loss: 54.986, val loss: 1765.322, train acc: 0.998, val acc: 0.939
diff 285.7747289083743
epoch 18 train loss: 38.923, val loss: 1688.210, train acc: 0.998, val acc: 0.940
diff 77.11160780484352
epoch 19 train loss: 76.203, val loss: 1644.680, train acc: 0.997, val acc: 0.943
diff 43.53064030057203
epoch 20 train loss: 81.197, val loss: 1502.018, train acc: 0.996, val acc: 0.937
diff 142.6613649597807
epoch 21 train loss: 12.790, val loss: 1452.397, train acc: 0.999, val acc: 0.946
diff 49.62094025020701
epoch 22 train loss: 52.792, val loss: 1377.410, train acc: 0.998, val acc: 0.941
diff 74.98763214685505
epoch 23 train loss: 47.726, val loss: 1462.401, train acc: 0.999, val acc: 0.941
diff 84.99148483431509
epoch 24 train loss: 1.020, val loss: 1374.535, train acc: 1.000, val acc: 0.945
diff 87.86584602705375
epoch 25 train loss: 0.079, val loss: 1346.028, train acc: 1.000, val acc: 0.948
diff 28.507168911845383
epoch 26 train loss: 0.028, val loss: 1348.425, train acc: 1.000, val acc: 0.948
diff 2.396676989209709
epoch 27 train loss: 0.020, val loss: 1350.264, train acc: 1.000, val acc: 0.949
diff 1.8395128696640768
epoch 28 train loss: 0.015, val loss: 1353.212, train acc: 1.000, val acc: 0.949
diff 2.9477422405864218
epoch 29 train loss: 0.011, val loss: 1356.973, train acc: 1.000, val acc: 0.950
diff 3.7607777043940587
epoch 30 train loss: 0.008, val loss: 1365.308, train acc: 1.000, val acc: 0.950
diff 8.334966899983101
Training model M3
epoch 1 train loss: 18.859, val loss: 3532.303, train acc: 0.999, val acc: 0.904
diff inf
epoch 2 train loss: 47.419, val loss: 3748.468, train acc: 0.999, val acc: 0.910
diff 216.16569635959195
epoch 3 train loss: 99.898, val loss: 6740.636, train acc: 0.997, val acc: 0.843
diff 2992.1675860868863
epoch 4 train loss: 25.646, val loss: 5203.855, train acc: 0.999, val acc: 0.889
diff 1536.7805780048247
epoch 5 train loss: 26.210, val loss: 5905.263, train acc: 0.999, val acc: 0.882
diff 701.4077937726634
epoch 6 train loss: 62.158, val loss: 4310.307, train acc: 0.999, val acc: 0.901
diff 1594.956418849859
epoch 7 train loss: 0.157, val loss: 4720.107, train acc: 1.000, val acc: 0.901
diff 409.800230194066
epoch 8 train loss: 0.001, val loss: 4693.668, train acc: 1.000, val acc: 0.901
diff 26.439407080281853
epoch 9 train loss: 0.001, val loss: 4733.122, train acc: 1.000, val acc: 0.900
diff 39.454360077572346
epoch 10 train loss: 0.000, val loss: 4759.062, train acc: 1.000, val acc: 0.900
diff 25.940559945261157
epoch 11 train loss: 0.000, val loss: 4783.059, train acc: 1.000, val acc: 0.900
diff 23.996353674998318
epoch 12 train loss: 0.000, val loss: 4833.562, train acc: 1.000, val acc: 0.900
diff 50.503100712532614
epoch 13 train loss: 0.000, val loss: 4890.884, train acc: 1.000, val acc: 0.900
diff 57.32184667839738
epoch 14 train loss: 0.000, val loss: 4931.933, train acc: 1.000, val acc: 0.899
diff 41.04929801545677
epoch 15 train loss: 0.000, val loss: 4962.609, train acc: 1.000, val acc: 0.898
diff 30.67616001928309
epoch 16 train loss: 0.000, val loss: 5053.830, train acc: 1.000, val acc: 0.896
diff 91.22068756695899
epoch 17 train loss: 0.000, val loss: 5108.762, train acc: 1.000, val acc: 0.895
diff 54.93240532618711
epoch 18 train loss: 0.000, val loss: 5140.681, train acc: 1.000, val acc: 0.895
diff 31.9183365618037
epoch 19 train loss: 0.000, val loss: 5181.066, train acc: 1.000, val acc: 0.894
diff 40.38499551678706
epoch 20 train loss: 0.000, val loss: 5234.601, train acc: 1.000, val acc: 0.893
diff 53.53484045596724
epoch 21 train loss: 0.000, val loss: 5300.198, train acc: 1.000, val acc: 0.893
diff 65.59764556211849
epoch 22 train loss: 0.000, val loss: 5363.176, train acc: 1.000, val acc: 0.892
diff 62.978032695378715
epoch 23 train loss: 0.000, val loss: 5389.043, train acc: 1.000, val acc: 0.892
diff 25.866950074028864
epoch 24 train loss: 0.000, val loss: 5403.727, train acc: 1.000, val acc: 0.892
diff 14.683873403535472
epoch 25 train loss: 0.000, val loss: 5466.312, train acc: 1.000, val acc: 0.891
diff 62.584539936169676
epoch 26 train loss: 0.000, val loss: 5521.501, train acc: 1.000, val acc: 0.890
diff 55.18905897195509
epoch 27 train loss: 0.000, val loss: 5550.024, train acc: 1.000, val acc: 0.890
diff 28.52334375571263
epoch 28 train loss: 0.000, val loss: 5556.284, train acc: 1.000, val acc: 0.891
diff 6.260119289290742
epoch 29 train loss: 0.000, val loss: 5595.050, train acc: 1.000, val acc: 0.890
diff 38.76588260376229
epoch 30 train loss: 0.000, val loss: 5622.409, train acc: 1.000, val acc: 0.890
diff 27.359504511789055
Training model M3
epoch 1 train loss: 1682.629, val loss: 382.284, train acc: 0.948, val acc: 0.960
diff inf
epoch 2 train loss: 358.934, val loss: 405.323, train acc: 0.983, val acc: 0.964
diff 23.03908620497475
epoch 3 train loss: 82.994, val loss: 402.020, train acc: 0.997, val acc: 0.966
diff 3.3029642059257185
epoch 4 train loss: 14.015, val loss: 414.712, train acc: 1.000, val acc: 0.973
diff 12.69260719483708
epoch 5 train loss: 83.965, val loss: 916.218, train acc: 0.996, val acc: 0.942
diff 501.50596377486795
epoch 6 train loss: 113.322, val loss: 511.230, train acc: 0.996, val acc: 0.970
diff 404.98818948774334
epoch 7 train loss: 79.611, val loss: 486.766, train acc: 0.997, val acc: 0.967
diff 24.46373645782836
epoch 8 train loss: 31.559, val loss: 559.157, train acc: 0.999, val acc: 0.963
diff 72.3906153954398
epoch 9 train loss: 18.047, val loss: 721.302, train acc: 0.999, val acc: 0.958
diff 162.14529016078882
epoch 10 train loss: 0.681, val loss: 621.713, train acc: 1.000, val acc: 0.966
diff 99.58929938360029
epoch 11 train loss: 0.111, val loss: 605.146, train acc: 1.000, val acc: 0.967
diff 16.567150259364894
epoch 12 train loss: 0.063, val loss: 603.682, train acc: 1.000, val acc: 0.966
diff 1.4635832573349035
epoch 13 train loss: 0.042, val loss: 609.653, train acc: 1.000, val acc: 0.966
diff 5.970240439867553
epoch 14 train loss: 0.030, val loss: 610.464, train acc: 1.000, val acc: 0.967
diff 0.8115858327724936
epoch 15 train loss: 0.021, val loss: 610.150, train acc: 1.000, val acc: 0.967
diff 0.31373480660977293
epoch 16 train loss: 0.016, val loss: 613.735, train acc: 1.000, val acc: 0.966
diff 3.584438956261579
epoch 17 train loss: 0.011, val loss: 620.299, train acc: 1.000, val acc: 0.965
diff 6.564442890138594
epoch 18 train loss: 0.008, val loss: 625.528, train acc: 1.000, val acc: 0.966
diff 5.228842360656813
epoch 19 train loss: 0.006, val loss: 628.045, train acc: 1.000, val acc: 0.966
diff 2.5166885432297477
epoch 20 train loss: 0.004, val loss: 634.635, train acc: 1.000, val acc: 0.966
diff 6.590476212751014
epoch 21 train loss: 0.003, val loss: 640.508, train acc: 1.000, val acc: 0.966
diff 5.87251623702582
epoch 22 train loss: 0.002, val loss: 647.188, train acc: 1.000, val acc: 0.966
diff 6.680103054006963
epoch 23 train loss: 0.001, val loss: 651.461, train acc: 1.000, val acc: 0.966
diff 4.273317891675902
epoch 24 train loss: 0.001, val loss: 651.407, train acc: 1.000, val acc: 0.967
diff 0.05420491927623061
2
2
2
