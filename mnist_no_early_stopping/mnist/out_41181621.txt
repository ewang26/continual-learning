Using CPU
Running experiment mnist:
Results are stored in: mnist_no_early_stopping/mnist
with hyperparameters {'p': 0.002, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 100000, 'random_seed': 0, 'class_balanced': True, 'execute_early_stopping': False, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 6457.438, val loss: 677.027, train acc: 0.905, val acc: 0.916
diff inf
epoch 2 train loss: 3595.675, val loss: 360.441, train acc: 0.947, val acc: 0.956
diff 316.5862004202927
epoch 3 train loss: 2736.557, val loss: 382.301, train acc: 0.961, val acc: 0.958
diff 21.859961198077087
epoch 4 train loss: 2422.738, val loss: 308.849, train acc: 0.965, val acc: 0.963
diff 73.45111975543352
epoch 5 train loss: 2100.118, val loss: 301.023, train acc: 0.970, val acc: 0.966
diff 7.825973234251478
epoch 6 train loss: 1744.924, val loss: 403.866, train acc: 0.974, val acc: 0.962
diff 102.8420961312516
epoch 7 train loss: 1691.541, val loss: 326.148, train acc: 0.976, val acc: 0.965
diff 77.71782604696
epoch 8 train loss: 1504.997, val loss: 451.044, train acc: 0.979, val acc: 0.950
diff 124.89625834160984
epoch 9 train loss: 1509.100, val loss: 341.705, train acc: 0.978, val acc: 0.969
diff 109.33910839322272
epoch 10 train loss: 1364.019, val loss: 262.645, train acc: 0.980, val acc: 0.973
diff 79.06019408588776
epoch 11 train loss: 1270.026, val loss: 274.384, train acc: 0.982, val acc: 0.976
diff 11.739733994267112
epoch 12 train loss: 1293.527, val loss: 322.595, train acc: 0.981, val acc: 0.969
diff 48.21039393408773
epoch 13 train loss: 1076.606, val loss: 301.384, train acc: 0.984, val acc: 0.972
diff 21.211022767486384
epoch 14 train loss: 1179.293, val loss: 260.998, train acc: 0.983, val acc: 0.978
diff 40.38562102811528
epoch 15 train loss: 1103.260, val loss: 278.288, train acc: 0.984, val acc: 0.970
diff 17.289969433027807
epoch 16 train loss: 890.691, val loss: 357.530, train acc: 0.988, val acc: 0.973
diff 79.2418404448444
epoch 17 train loss: 1043.981, val loss: 305.970, train acc: 0.986, val acc: 0.977
diff 51.56034229155165
epoch 18 train loss: 1029.870, val loss: 385.352, train acc: 0.985, val acc: 0.972
diff 79.38274088935657
epoch 19 train loss: 884.392, val loss: 449.511, train acc: 0.987, val acc: 0.971
diff 64.15908804908997
epoch 20 train loss: 1029.071, val loss: 344.073, train acc: 0.986, val acc: 0.975
diff 105.43854558790946
epoch 21 train loss: 890.198, val loss: 461.230, train acc: 0.988, val acc: 0.966
diff 117.15667812042136
epoch 22 train loss: 962.585, val loss: 398.981, train acc: 0.987, val acc: 0.972
diff 62.24903226293242
epoch 23 train loss: 933.910, val loss: 471.129, train acc: 0.988, val acc: 0.966
diff 72.14891662132885
epoch 24 train loss: 810.500, val loss: 383.136, train acc: 0.990, val acc: 0.970
diff 87.99318465230152
epoch 25 train loss: 824.041, val loss: 675.571, train acc: 0.989, val acc: 0.971
diff 292.4351646484745
epoch 26 train loss: 857.855, val loss: 681.150, train acc: 0.990, val acc: 0.966
diff 5.578675631108695
epoch 27 train loss: 907.226, val loss: 586.180, train acc: 0.990, val acc: 0.972
diff 94.96964565546682
epoch 28 train loss: 760.053, val loss: 467.230, train acc: 0.990, val acc: 0.977
diff 118.95066882847811
epoch 29 train loss: 857.710, val loss: 396.621, train acc: 0.990, val acc: 0.977
diff 70.60890163241129
epoch 30 train loss: 694.303, val loss: 604.542, train acc: 0.991, val acc: 0.970
diff 207.9213732867288
Training model M2
epoch 1 train loss: 11075.761, val loss: 758.575, train acc: 0.870, val acc: 0.923
diff inf
epoch 2 train loss: 6176.702, val loss: 702.256, train acc: 0.930, val acc: 0.932
diff 56.31914123177205
epoch 3 train loss: 5028.183, val loss: 613.386, train acc: 0.943, val acc: 0.940
diff 88.8702974567218
epoch 4 train loss: 4441.998, val loss: 573.907, train acc: 0.950, val acc: 0.949
diff 39.47879037534733
epoch 5 train loss: 3909.573, val loss: 584.067, train acc: 0.955, val acc: 0.946
diff 10.159921679095646
epoch 6 train loss: 3531.865, val loss: 570.653, train acc: 0.958, val acc: 0.949
diff 13.41366533345331
epoch 7 train loss: 3246.356, val loss: 517.519, train acc: 0.963, val acc: 0.958
diff 53.13463585032605
epoch 8 train loss: 3059.168, val loss: 546.180, train acc: 0.965, val acc: 0.958
diff 28.661633277425153
epoch 9 train loss: 2851.237, val loss: 472.393, train acc: 0.967, val acc: 0.961
diff 73.78685875593493
epoch 10 train loss: 2725.139, val loss: 523.741, train acc: 0.969, val acc: 0.953
diff 51.3478571549021
epoch 11 train loss: 2603.965, val loss: 569.021, train acc: 0.969, val acc: 0.955
diff 45.28025081379792
epoch 12 train loss: 2414.437, val loss: 582.045, train acc: 0.972, val acc: 0.954
diff 13.023825798938333
epoch 13 train loss: 2335.872, val loss: 822.566, train acc: 0.972, val acc: 0.933
diff 240.52092634616815
epoch 14 train loss: 2230.964, val loss: 695.392, train acc: 0.974, val acc: 0.952
diff 127.17405293351703
epoch 15 train loss: 2132.495, val loss: 705.011, train acc: 0.977, val acc: 0.952
diff 9.61898121841375
epoch 16 train loss: 2213.002, val loss: 659.356, train acc: 0.975, val acc: 0.955
diff 45.654717819637085
epoch 17 train loss: 2000.468, val loss: 735.480, train acc: 0.977, val acc: 0.957
diff 76.1233336990316
epoch 18 train loss: 1917.729, val loss: 607.416, train acc: 0.978, val acc: 0.958
diff 128.06340252106418
epoch 19 train loss: 2150.215, val loss: 774.129, train acc: 0.976, val acc: 0.959
diff 166.71314686917412
epoch 20 train loss: 1996.051, val loss: 831.084, train acc: 0.978, val acc: 0.950
diff 56.95503639530102
epoch 21 train loss: 1889.011, val loss: 967.576, train acc: 0.978, val acc: 0.941
diff 136.49155959841926
epoch 22 train loss: 1979.687, val loss: 687.772, train acc: 0.978, val acc: 0.966
diff 279.8038273939384
epoch 23 train loss: 1695.017, val loss: 679.140, train acc: 0.981, val acc: 0.960
diff 8.632506093136612
epoch 24 train loss: 1854.427, val loss: 607.979, train acc: 0.980, val acc: 0.964
diff 71.16062507978188
epoch 25 train loss: 1813.531, val loss: 750.326, train acc: 0.980, val acc: 0.959
diff 142.34680527397813
epoch 26 train loss: 1630.902, val loss: 826.050, train acc: 0.982, val acc: 0.957
diff 75.72453197510708
epoch 27 train loss: 1848.937, val loss: 885.401, train acc: 0.981, val acc: 0.952
diff 59.35029771432846
epoch 28 train loss: 1586.371, val loss: 656.852, train acc: 0.983, val acc: 0.961
diff 228.54846190541593
epoch 29 train loss: 1580.958, val loss: 1012.197, train acc: 0.984, val acc: 0.954
diff 355.3447553975893
epoch 30 train loss: 1774.833, val loss: 801.724, train acc: 0.982, val acc: 0.957
diff 210.47349601491464
Training model M3
epoch 1 train loss: 1121.687, val loss: 14789.858, train acc: 0.937, val acc: 0.194
diff inf
epoch 2 train loss: 681.286, val loss: 11841.192, train acc: 0.966, val acc: 0.216
diff 2948.6654394584893
epoch 3 train loss: 518.036, val loss: 14205.500, train acc: 0.973, val acc: 0.189
diff 2364.307710253279
epoch 4 train loss: 517.801, val loss: 8098.548, train acc: 0.974, val acc: 0.275
diff 6106.952092606525
epoch 5 train loss: 390.886, val loss: 9953.724, train acc: 0.980, val acc: 0.283
diff 1855.175886200228
epoch 6 train loss: 379.896, val loss: 10135.315, train acc: 0.980, val acc: 0.257
diff 181.5908714075067
epoch 7 train loss: 305.697, val loss: 7742.880, train acc: 0.983, val acc: 0.356
diff 2392.4348251473566
epoch 8 train loss: 273.860, val loss: 8126.897, train acc: 0.986, val acc: 0.414
diff 384.01708859868813
epoch 9 train loss: 234.071, val loss: 14566.449, train acc: 0.985, val acc: 0.313
diff 6439.552129565174
epoch 10 train loss: 247.943, val loss: 10753.476, train acc: 0.987, val acc: 0.391
diff 3812.972620734823
epoch 11 train loss: 145.620, val loss: 12918.903, train acc: 0.992, val acc: 0.351
diff 2165.426476127952
epoch 12 train loss: 172.270, val loss: 18789.611, train acc: 0.990, val acc: 0.295
diff 5870.708174442059
epoch 13 train loss: 205.612, val loss: 12502.761, train acc: 0.987, val acc: 0.422
diff 6286.849771248735
epoch 14 train loss: 150.197, val loss: 12278.570, train acc: 0.990, val acc: 0.423
diff 224.19152677338207
epoch 15 train loss: 145.156, val loss: 16481.590, train acc: 0.992, val acc: 0.367
diff 4203.019691211235
epoch 16 train loss: 131.503, val loss: 14216.093, train acc: 0.992, val acc: 0.397
diff 2265.4965459193736
epoch 17 train loss: 82.584, val loss: 13809.998, train acc: 0.995, val acc: 0.469
diff 406.0947691083984
epoch 18 train loss: 143.118, val loss: 20244.673, train acc: 0.992, val acc: 0.346
diff 6434.674854680952
epoch 19 train loss: 71.040, val loss: 13741.759, train acc: 0.996, val acc: 0.455
diff 6502.913676184695
epoch 20 train loss: 120.910, val loss: 14248.439, train acc: 0.992, val acc: 0.427
diff 506.6792721194888
epoch 21 train loss: 82.790, val loss: 12497.413, train acc: 0.994, val acc: 0.491
diff 1751.0256144259874
epoch 22 train loss: 61.604, val loss: 23946.957, train acc: 0.996, val acc: 0.317
diff 11449.543641792116
epoch 23 train loss: 137.381, val loss: 13507.345, train acc: 0.993, val acc: 0.467
diff 10439.612144695342
epoch 24 train loss: 93.251, val loss: 17867.721, train acc: 0.994, val acc: 0.431
diff 4360.376197390697
epoch 25 train loss: 81.880, val loss: 22645.378, train acc: 0.996, val acc: 0.343
diff 4777.656979257401
epoch 26 train loss: 137.464, val loss: 17370.702, train acc: 0.994, val acc: 0.429
diff 5274.675743168322
epoch 27 train loss: 43.486, val loss: 18069.679, train acc: 0.998, val acc: 0.443
diff 698.9770929769948
epoch 28 train loss: 53.715, val loss: 21961.812, train acc: 0.998, val acc: 0.399
diff 3892.132435683543
epoch 29 train loss: 132.431, val loss: 19935.474, train acc: 0.992, val acc: 0.379
diff 2026.3370908904253
epoch 30 train loss: 35.825, val loss: 19970.619, train acc: 0.998, val acc: 0.411
diff 35.14477302137311
Training model M3
epoch 1 train loss: 229.620, val loss: 20562.980, train acc: 0.991, val acc: 0.443
diff inf
epoch 2 train loss: 214.176, val loss: 15543.291, train acc: 0.993, val acc: 0.529
diff 5019.688794970511
epoch 3 train loss: 71.740, val loss: 15967.109, train acc: 0.997, val acc: 0.556
diff 423.8179889251205
epoch 4 train loss: 82.278, val loss: 18245.086, train acc: 0.997, val acc: 0.510
diff 2277.9771897806277
epoch 5 train loss: 116.915, val loss: 25837.611, train acc: 0.994, val acc: 0.385
diff 7592.5240520550215
epoch 6 train loss: 43.416, val loss: 29414.615, train acc: 0.998, val acc: 0.358
diff 3577.004523909094
epoch 7 train loss: 139.165, val loss: 19630.221, train acc: 0.994, val acc: 0.454
diff 9784.393676350435
epoch 8 train loss: 57.209, val loss: 21806.109, train acc: 0.996, val acc: 0.461
diff 2175.888117268729
epoch 9 train loss: 184.330, val loss: 26673.913, train acc: 0.993, val acc: 0.429
diff 4867.803346329445
epoch 10 train loss: 58.088, val loss: 27036.539, train acc: 0.996, val acc: 0.379
diff 362.62598222298766
epoch 11 train loss: 65.129, val loss: 28617.809, train acc: 0.996, val acc: 0.375
diff 1581.2701054094468
epoch 12 train loss: 69.835, val loss: 40063.685, train acc: 0.996, val acc: 0.286
diff 11445.87611268077
epoch 13 train loss: 71.097, val loss: 33854.632, train acc: 0.997, val acc: 0.386
diff 6209.053498382884
epoch 14 train loss: 162.936, val loss: 37507.608, train acc: 0.995, val acc: 0.291
diff 3652.976711613672
epoch 15 train loss: 55.538, val loss: 26518.946, train acc: 0.997, val acc: 0.427
diff 10988.661740699528
epoch 16 train loss: 20.757, val loss: 24915.173, train acc: 1.000, val acc: 0.454
diff 1603.7736407843986
epoch 17 train loss: 46.629, val loss: 23321.588, train acc: 0.998, val acc: 0.478
diff 1593.5844183376576
epoch 18 train loss: 1.679, val loss: 24172.502, train acc: 1.000, val acc: 0.466
diff 850.9132365987753
epoch 19 train loss: 0.727, val loss: 25270.615, train acc: 1.000, val acc: 0.449
diff 1098.1128689652578
epoch 20 train loss: 0.284, val loss: 26337.095, train acc: 1.000, val acc: 0.447
diff 1066.480284253179
epoch 21 train loss: 0.158, val loss: 26747.581, train acc: 1.000, val acc: 0.450
diff 410.4859845333085
epoch 22 train loss: 0.104, val loss: 27192.716, train acc: 1.000, val acc: 0.449
diff 445.1350515925078
epoch 23 train loss: 0.086, val loss: 27798.658, train acc: 1.000, val acc: 0.448
diff 605.9424652524249
epoch 24 train loss: 0.060, val loss: 28239.593, train acc: 1.000, val acc: 0.448
diff 440.935164255141
epoch 25 train loss: 0.047, val loss: 28771.641, train acc: 1.000, val acc: 0.448
diff 532.0475978994
epoch 26 train loss: 0.037, val loss: 29241.446, train acc: 1.000, val acc: 0.445
diff 469.8048719911676
epoch 27 train loss: 0.027, val loss: 29697.387, train acc: 1.000, val acc: 0.444
diff 455.9409159329589
epoch 28 train loss: 0.020, val loss: 29930.572, train acc: 1.000, val acc: 0.443
diff 233.1848944425983
epoch 29 train loss: 0.016, val loss: 30375.725, train acc: 1.000, val acc: 0.448
diff 445.1535125332048
epoch 30 train loss: 0.012, val loss: 31059.150, train acc: 1.000, val acc: 0.444
diff 683.4250921035236
Training model M3
epoch 1 train loss: 987.613, val loss: 14554.890, train acc: 0.986, val acc: 0.446
diff inf
epoch 2 train loss: 462.788, val loss: 15730.688, train acc: 0.988, val acc: 0.323
diff 1175.798292480602
epoch 3 train loss: 263.387, val loss: 15209.880, train acc: 0.989, val acc: 0.383
diff 520.8080499908137
epoch 4 train loss: 293.125, val loss: 15568.792, train acc: 0.990, val acc: 0.314
diff 358.91174942267753
epoch 5 train loss: 196.926, val loss: 16568.765, train acc: 0.991, val acc: 0.335
diff 999.9735808656824
epoch 6 train loss: 227.681, val loss: 16105.855, train acc: 0.991, val acc: 0.359
diff 462.9100639100325
epoch 7 train loss: 171.018, val loss: 20012.596, train acc: 0.992, val acc: 0.331
diff 3906.7407907480774
epoch 8 train loss: 132.220, val loss: 20321.402, train acc: 0.993, val acc: 0.287
diff 308.8062864731219
epoch 9 train loss: 173.180, val loss: 19986.387, train acc: 0.990, val acc: 0.297
diff 335.015239090837
epoch 10 train loss: 168.904, val loss: 26822.636, train acc: 0.992, val acc: 0.310
diff 6836.248394340764
epoch 11 train loss: 145.926, val loss: 21619.710, train acc: 0.992, val acc: 0.324
diff 5202.925921477148
epoch 12 train loss: 132.274, val loss: 23864.800, train acc: 0.994, val acc: 0.287
diff 2245.0904238400253
epoch 13 train loss: 128.962, val loss: 29133.365, train acc: 0.993, val acc: 0.290
diff 5268.5651019587385
epoch 14 train loss: 131.653, val loss: 26254.419, train acc: 0.993, val acc: 0.306
diff 2878.9462425751517
epoch 15 train loss: 81.820, val loss: 28492.277, train acc: 0.995, val acc: 0.299
diff 2237.85830622886
epoch 16 train loss: 85.057, val loss: 25482.114, train acc: 0.995, val acc: 0.314
diff 3010.162796567194
epoch 17 train loss: 101.924, val loss: 30082.681, train acc: 0.995, val acc: 0.324
diff 4600.566416458849
epoch 18 train loss: 159.313, val loss: 33360.455, train acc: 0.993, val acc: 0.274
diff 3277.7740493485544
epoch 19 train loss: 106.116, val loss: 31589.010, train acc: 0.995, val acc: 0.293
diff 1771.4450130763253
epoch 20 train loss: 111.229, val loss: 33794.974, train acc: 0.995, val acc: 0.330
diff 2205.964062729585
epoch 21 train loss: 66.572, val loss: 31985.989, train acc: 0.997, val acc: 0.325
diff 1808.9848255773832
epoch 22 train loss: 137.556, val loss: 29178.564, train acc: 0.994, val acc: 0.367
diff 2807.4246594052274
epoch 23 train loss: 133.533, val loss: 37159.019, train acc: 0.992, val acc: 0.270
diff 7980.4549324707
epoch 24 train loss: 102.725, val loss: 33403.753, train acc: 0.994, val acc: 0.300
diff 3755.266781003629
epoch 25 train loss: 34.365, val loss: 33336.809, train acc: 0.998, val acc: 0.300
diff 66.94315806656232
epoch 26 train loss: 24.306, val loss: 34044.478, train acc: 0.999, val acc: 0.313
diff 707.668591372465
epoch 27 train loss: 35.890, val loss: 39533.563, train acc: 0.998, val acc: 0.319
diff 5489.085322083192
epoch 28 train loss: 151.846, val loss: 30379.725, train acc: 0.994, val acc: 0.299
diff 9153.838861013104
epoch 29 train loss: 85.991, val loss: 43345.340, train acc: 0.996, val acc: 0.268
diff 12965.615772674279
epoch 30 train loss: 32.647, val loss: 47892.918, train acc: 0.998, val acc: 0.259
diff 4547.578028986485
training representation using icarl loss
training representation using icarl loss
training representation using icarl loss
training representation using icarl loss
Training model M3
epoch 1 train loss: 789.635, val loss: 27834.275, train acc: 0.988, val acc: 0.304
diff inf
epoch 2 train loss: 297.957, val loss: 20857.948, train acc: 0.993, val acc: 0.297
diff 6976.327528319329
epoch 3 train loss: 164.015, val loss: 16262.149, train acc: 0.994, val acc: 0.404
diff 4595.798617973211
epoch 4 train loss: 188.044, val loss: 17421.354, train acc: 0.992, val acc: 0.400
diff 1159.2044561446673
epoch 5 train loss: 119.678, val loss: 16462.045, train acc: 0.993, val acc: 0.409
diff 959.3089921203573
epoch 6 train loss: 112.898, val loss: 23756.550, train acc: 0.994, val acc: 0.377
diff 7294.505241759474
epoch 7 train loss: 164.840, val loss: 14715.227, train acc: 0.993, val acc: 0.425
diff 9041.322630372433
epoch 8 train loss: 71.766, val loss: 19097.377, train acc: 0.996, val acc: 0.415
diff 4382.149619129701
epoch 9 train loss: 191.677, val loss: 18169.546, train acc: 0.994, val acc: 0.339
diff 927.8309215065856
epoch 10 train loss: 67.142, val loss: 16939.134, train acc: 0.997, val acc: 0.383
diff 1230.4123690952292
epoch 11 train loss: 73.485, val loss: 24039.447, train acc: 0.996, val acc: 0.394
diff 7100.313472107675
epoch 12 train loss: 128.596, val loss: 23777.412, train acc: 0.994, val acc: 0.348
diff 262.03491341571134
epoch 13 train loss: 73.253, val loss: 18991.693, train acc: 0.997, val acc: 0.384
diff 4785.719332547309
epoch 14 train loss: 82.220, val loss: 18068.616, train acc: 0.995, val acc: 0.455
diff 923.0765880743529
epoch 15 train loss: 80.000, val loss: 27561.661, train acc: 0.995, val acc: 0.364
diff 9493.045047786098
epoch 16 train loss: 36.223, val loss: 18437.106, train acc: 0.997, val acc: 0.480
diff 9124.554952277893
epoch 17 train loss: 70.327, val loss: 19685.547, train acc: 0.996, val acc: 0.474
diff 1248.4403415090128
epoch 18 train loss: 138.559, val loss: 24503.590, train acc: 0.995, val acc: 0.389
diff 4818.042896301555
epoch 19 train loss: 91.770, val loss: 29655.772, train acc: 0.996, val acc: 0.385
diff 5152.182614604357
epoch 20 train loss: 122.665, val loss: 28895.225, train acc: 0.994, val acc: 0.363
diff 760.5477487856515
epoch 21 train loss: 29.944, val loss: 25061.570, train acc: 0.998, val acc: 0.423
diff 3833.6544590974045
epoch 22 train loss: 18.623, val loss: 30877.755, train acc: 0.999, val acc: 0.330
diff 5816.1844995341235
epoch 23 train loss: 47.926, val loss: 23804.787, train acc: 0.997, val acc: 0.455
diff 7072.967256872056
epoch 24 train loss: 41.703, val loss: 30603.714, train acc: 0.997, val acc: 0.397
diff 6798.9263584863365
epoch 25 train loss: 38.335, val loss: 30021.181, train acc: 0.998, val acc: 0.404
diff 582.5328008749057
epoch 26 train loss: 47.004, val loss: 33042.192, train acc: 0.997, val acc: 0.433
diff 3021.0109958018984
epoch 27 train loss: 98.513, val loss: 33262.118, train acc: 0.996, val acc: 0.431
diff 219.92651820676838
epoch 28 train loss: 32.225, val loss: 27792.611, train acc: 0.999, val acc: 0.447
diff 5469.506964798977
epoch 29 train loss: 2.903, val loss: 31378.497, train acc: 1.000, val acc: 0.428
diff 3585.8850707236597
epoch 30 train loss: 1.450, val loss: 31574.083, train acc: 1.000, val acc: 0.426
diff 195.58667828042599
training representation using replay loss
