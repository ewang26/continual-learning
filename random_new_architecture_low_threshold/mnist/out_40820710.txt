Using CPU
Running experiment mnist:
Results are stored in: random_new_architecture_low_threshold/mnist
with hyperparameters {'p': 0.9, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.001, 'random_seed': 3, 'class_balanced': True, 'max_data_size': 6000, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 6544.706, val loss: 529.270, train acc: 0.902, val acc: 0.929
diff inf
epoch 2 train loss: 3598.274, val loss: 356.767, train acc: 0.949, val acc: 0.958
diff 172.502918485186
epoch 3 train loss: 2865.322, val loss: 326.673, train acc: 0.960, val acc: 0.963
diff 30.093525699260283
epoch 4 train loss: 2434.285, val loss: 325.554, train acc: 0.965, val acc: 0.965
diff 1.1196443550580284
epoch 5 train loss: 2124.135, val loss: 370.508, train acc: 0.970, val acc: 0.959
diff 44.95381532711468
epoch 6 train loss: 1896.747, val loss: 340.304, train acc: 0.973, val acc: 0.967
diff 30.203918904497925
epoch 7 train loss: 1825.603, val loss: 348.021, train acc: 0.973, val acc: 0.963
diff 7.717271263609916
epoch 8 train loss: 1550.792, val loss: 353.684, train acc: 0.977, val acc: 0.961
diff 5.662952542066023
epoch 9 train loss: 1425.594, val loss: 413.720, train acc: 0.979, val acc: 0.966
diff 60.03564486992025
epoch 10 train loss: 1499.523, val loss: 265.443, train acc: 0.978, val acc: 0.974
diff 148.2767500721406
epoch 11 train loss: 1283.842, val loss: 314.927, train acc: 0.982, val acc: 0.973
diff 49.48387406740392
epoch 12 train loss: 1249.339, val loss: 341.353, train acc: 0.983, val acc: 0.977
diff 26.426196772515937
epoch 13 train loss: 1189.309, val loss: 403.903, train acc: 0.983, val acc: 0.967
diff 62.55012311248777
epoch 14 train loss: 1192.046, val loss: 396.305, train acc: 0.984, val acc: 0.966
diff 7.598415699227303
epoch 15 train loss: 1123.997, val loss: 437.911, train acc: 0.984, val acc: 0.972
diff 41.60600492501317
epoch 16 train loss: 1008.327, val loss: 430.852, train acc: 0.986, val acc: 0.967
diff 7.05860511572422
epoch 17 train loss: 1067.609, val loss: 398.000, train acc: 0.985, val acc: 0.973
diff 32.85170925877475
epoch 18 train loss: 869.089, val loss: 390.318, train acc: 0.988, val acc: 0.975
diff 7.68269074729551
epoch 19 train loss: 1093.116, val loss: 468.987, train acc: 0.986, val acc: 0.966
diff 78.66897891026474
epoch 20 train loss: 867.340, val loss: 649.596, train acc: 0.987, val acc: 0.964
diff 180.60940969808246
epoch 21 train loss: 1073.541, val loss: 505.019, train acc: 0.986, val acc: 0.960
diff 144.577090650007
epoch 22 train loss: 959.907, val loss: 485.509, train acc: 0.987, val acc: 0.964
diff 19.50982314070086
epoch 23 train loss: 833.350, val loss: 438.610, train acc: 0.989, val acc: 0.975
diff 46.89892994802307
epoch 24 train loss: 987.605, val loss: 444.300, train acc: 0.987, val acc: 0.975
diff 5.689819287525324
epoch 25 train loss: 799.887, val loss: 591.264, train acc: 0.990, val acc: 0.968
diff 146.96419110801452
epoch 26 train loss: 938.811, val loss: 595.185, train acc: 0.988, val acc: 0.965
diff 3.9211678152887544
epoch 27 train loss: 715.676, val loss: 545.163, train acc: 0.991, val acc: 0.972
diff 50.02228763544872
epoch 28 train loss: 1079.359, val loss: 608.802, train acc: 0.987, val acc: 0.975
diff 63.638945825063274
epoch 29 train loss: 804.691, val loss: 732.528, train acc: 0.990, val acc: 0.964
diff 123.72640735376694
epoch 30 train loss: 819.538, val loss: 653.866, train acc: 0.990, val acc: 0.969
diff 78.66208605781515
Training model M2
epoch 1 train loss: 11237.635, val loss: 841.679, train acc: 0.871, val acc: 0.914
diff inf
epoch 2 train loss: 6493.976, val loss: 982.655, train acc: 0.927, val acc: 0.907
diff 140.97652050907357
epoch 3 train loss: 5351.387, val loss: 584.284, train acc: 0.938, val acc: 0.949
diff 398.3717295044946
epoch 4 train loss: 4481.642, val loss: 584.103, train acc: 0.949, val acc: 0.944
diff 0.1802703339327536
epoch 5 train loss: 4113.361, val loss: 641.608, train acc: 0.953, val acc: 0.940
diff 57.504985794019035
epoch 6 train loss: 3789.238, val loss: 504.561, train acc: 0.955, val acc: 0.952
diff 137.04729410531348
epoch 7 train loss: 3468.960, val loss: 650.498, train acc: 0.960, val acc: 0.942
diff 145.93649462035995
epoch 8 train loss: 3267.131, val loss: 584.894, train acc: 0.962, val acc: 0.949
diff 65.60391641661636
epoch 9 train loss: 3020.075, val loss: 502.961, train acc: 0.965, val acc: 0.958
diff 81.93283983250035
epoch 10 train loss: 2883.664, val loss: 616.665, train acc: 0.966, val acc: 0.945
diff 113.70394937373965
epoch 11 train loss: 2832.236, val loss: 726.084, train acc: 0.968, val acc: 0.945
diff 109.41960617196128
epoch 12 train loss: 2766.657, val loss: 686.877, train acc: 0.968, val acc: 0.952
diff 39.207687427432916
epoch 13 train loss: 2531.464, val loss: 655.357, train acc: 0.972, val acc: 0.952
diff 31.51974965284012
epoch 14 train loss: 2440.746, val loss: 565.081, train acc: 0.972, val acc: 0.962
diff 90.27585870242103
epoch 15 train loss: 2242.833, val loss: 659.933, train acc: 0.975, val acc: 0.952
diff 94.85226462542471
epoch 16 train loss: 2312.620, val loss: 594.868, train acc: 0.974, val acc: 0.961
diff 65.06532037267027
epoch 17 train loss: 2137.338, val loss: 606.834, train acc: 0.976, val acc: 0.963
diff 11.965669270731382
epoch 18 train loss: 2173.769, val loss: 958.944, train acc: 0.975, val acc: 0.941
diff 352.1103316746925
epoch 19 train loss: 2131.403, val loss: 710.765, train acc: 0.977, val acc: 0.955
diff 248.179399686196
epoch 20 train loss: 2331.233, val loss: 640.375, train acc: 0.974, val acc: 0.959
diff 70.38961500027597
epoch 21 train loss: 2157.563, val loss: 659.614, train acc: 0.977, val acc: 0.961
diff 19.239032302506303
epoch 22 train loss: 2025.770, val loss: 816.561, train acc: 0.977, val acc: 0.955
diff 156.94650876273442
epoch 23 train loss: 2019.137, val loss: 721.421, train acc: 0.978, val acc: 0.954
diff 95.14005571866892
epoch 24 train loss: 1965.444, val loss: 764.942, train acc: 0.978, val acc: 0.958
diff 43.5213267496614
epoch 25 train loss: 1942.587, val loss: 665.789, train acc: 0.979, val acc: 0.959
diff 99.1528843388262
epoch 26 train loss: 2090.170, val loss: 945.358, train acc: 0.978, val acc: 0.951
diff 279.56858806405523
epoch 27 train loss: 1936.574, val loss: 1002.976, train acc: 0.980, val acc: 0.939
diff 57.61804330422285
epoch 28 train loss: 1872.361, val loss: 857.493, train acc: 0.980, val acc: 0.953
diff 145.48304395346236
epoch 29 train loss: 1849.368, val loss: 753.334, train acc: 0.980, val acc: 0.958
diff 104.15869145240367
epoch 30 train loss: 1759.022, val loss: 943.875, train acc: 0.982, val acc: 0.952
diff 190.54104994963882
Training model M3
epoch 1 train loss: 11413.184, val loss: 829.282, train acc: 0.869, val acc: 0.913
diff inf
epoch 2 train loss: 6647.851, val loss: 659.745, train acc: 0.923, val acc: 0.929
diff 169.53691274273478
epoch 3 train loss: 5206.965, val loss: 565.944, train acc: 0.940, val acc: 0.946
diff 93.80100501993161
epoch 4 train loss: 4600.642, val loss: 444.699, train acc: 0.947, val acc: 0.951
diff 121.24415383583562
epoch 5 train loss: 4144.827, val loss: 540.218, train acc: 0.951, val acc: 0.941
diff 95.51825671305687
epoch 6 train loss: 3924.509, val loss: 403.413, train acc: 0.954, val acc: 0.963
diff 136.80510312754558
epoch 7 train loss: 3543.111, val loss: 315.381, train acc: 0.958, val acc: 0.969
diff 88.03139587556063
epoch 8 train loss: 3435.685, val loss: 419.188, train acc: 0.961, val acc: 0.955
diff 103.8071416297484
epoch 9 train loss: 3136.113, val loss: 493.153, train acc: 0.963, val acc: 0.949
diff 73.9645682318939
epoch 10 train loss: 2999.175, val loss: 327.804, train acc: 0.965, val acc: 0.968
diff 165.34872058396184
epoch 11 train loss: 2985.639, val loss: 260.056, train acc: 0.967, val acc: 0.973
diff 67.748125979284
epoch 12 train loss: 2800.617, val loss: 519.326, train acc: 0.967, val acc: 0.951
diff 259.2695058176921
epoch 13 train loss: 2500.830, val loss: 299.827, train acc: 0.971, val acc: 0.973
diff 219.49867696949383
epoch 14 train loss: 2740.054, val loss: 393.110, train acc: 0.970, val acc: 0.962
diff 93.28340111618292
epoch 15 train loss: 2597.700, val loss: 304.944, train acc: 0.970, val acc: 0.974
diff 88.16623653413387
epoch 16 train loss: 2430.982, val loss: 281.743, train acc: 0.973, val acc: 0.973
diff 23.200570246590644
epoch 17 train loss: 2252.001, val loss: 318.946, train acc: 0.974, val acc: 0.971
diff 37.20258693998511
epoch 18 train loss: 2419.413, val loss: 355.350, train acc: 0.973, val acc: 0.965
diff 36.40425085655181
epoch 19 train loss: 2387.507, val loss: 339.963, train acc: 0.974, val acc: 0.972
diff 15.387798799222423
epoch 20 train loss: 2210.462, val loss: 315.529, train acc: 0.975, val acc: 0.972
diff 24.433459533205166
epoch 21 train loss: 2195.876, val loss: 296.779, train acc: 0.977, val acc: 0.972
diff 18.749954235743814
epoch 22 train loss: 2114.904, val loss: 321.791, train acc: 0.977, val acc: 0.977
diff 25.01140705862241
epoch 23 train loss: 2104.745, val loss: 527.399, train acc: 0.977, val acc: 0.955
diff 205.60820363296085
epoch 24 train loss: 2129.713, val loss: 562.013, train acc: 0.976, val acc: 0.951
diff 34.61461590324734
epoch 25 train loss: 2001.705, val loss: 300.702, train acc: 0.977, val acc: 0.975
diff 261.3109541483037
epoch 26 train loss: 2010.844, val loss: 324.727, train acc: 0.979, val acc: 0.977
diff 24.02416789360143
epoch 27 train loss: 2001.095, val loss: 337.218, train acc: 0.979, val acc: 0.969
diff 12.490979248321992
epoch 28 train loss: 2049.829, val loss: 298.112, train acc: 0.978, val acc: 0.980
diff 39.105851378372336
epoch 29 train loss: 1990.869, val loss: 466.114, train acc: 0.978, val acc: 0.970
diff 168.0024547817003
epoch 30 train loss: 1946.947, val loss: 299.014, train acc: 0.980, val acc: 0.972
diff 167.10009459053805
Training model M3
epoch 1 train loss: 2069.738, val loss: 306.799, train acc: 0.981, val acc: 0.980
diff inf
epoch 2 train loss: 1690.571, val loss: 456.296, train acc: 0.983, val acc: 0.975
diff 149.4972386144355
epoch 3 train loss: 1633.204, val loss: 597.030, train acc: 0.984, val acc: 0.966
diff 140.73403445356485
epoch 4 train loss: 1597.966, val loss: 604.066, train acc: 0.984, val acc: 0.962
diff 7.035784401807632
epoch 5 train loss: 1624.304, val loss: 652.621, train acc: 0.984, val acc: 0.964
diff 48.55575808368758
epoch 6 train loss: 1641.007, val loss: 671.857, train acc: 0.984, val acc: 0.964
diff 19.235980700147365
epoch 7 train loss: 1568.071, val loss: 827.226, train acc: 0.985, val acc: 0.966
diff 155.3686492023147
epoch 8 train loss: 1425.020, val loss: 913.213, train acc: 0.985, val acc: 0.955
diff 85.98732810035403
epoch 9 train loss: 1565.965, val loss: 570.063, train acc: 0.985, val acc: 0.973
diff 343.1508580421538
epoch 10 train loss: 1398.417, val loss: 594.498, train acc: 0.987, val acc: 0.964
diff 24.434998993259228
epoch 11 train loss: 1461.837, val loss: 735.530, train acc: 0.986, val acc: 0.960
diff 141.0328943262217
epoch 12 train loss: 1335.853, val loss: 783.418, train acc: 0.987, val acc: 0.966
diff 47.887109636306604
epoch 13 train loss: 1395.023, val loss: 827.513, train acc: 0.986, val acc: 0.964
diff 44.09509546142624
epoch 14 train loss: 1494.632, val loss: 1056.015, train acc: 0.986, val acc: 0.954
diff 228.50207603971626
epoch 15 train loss: 1524.276, val loss: 652.032, train acc: 0.986, val acc: 0.971
diff 403.98222403626323
epoch 16 train loss: 1258.556, val loss: 760.228, train acc: 0.988, val acc: 0.968
diff 108.19512599009431
epoch 17 train loss: 1644.525, val loss: 876.093, train acc: 0.986, val acc: 0.966
diff 115.86523777105481
epoch 18 train loss: 1170.678, val loss: 1102.610, train acc: 0.988, val acc: 0.961
diff 226.51730281872528
epoch 19 train loss: 1143.062, val loss: 1469.579, train acc: 0.989, val acc: 0.957
diff 366.9685617095847
epoch 20 train loss: 1487.229, val loss: 1062.977, train acc: 0.987, val acc: 0.961
diff 406.6015877297425
epoch 21 train loss: 1265.560, val loss: 1129.118, train acc: 0.989, val acc: 0.965
diff 66.14127407360547
epoch 22 train loss: 1260.052, val loss: 1244.174, train acc: 0.988, val acc: 0.961
diff 115.05514634352062
epoch 23 train loss: 1288.585, val loss: 1255.244, train acc: 0.988, val acc: 0.959
diff 11.06998830899829
epoch 24 train loss: 1264.820, val loss: 1276.110, train acc: 0.989, val acc: 0.957
diff 20.866233301207103
epoch 25 train loss: 1267.786, val loss: 1077.339, train acc: 0.990, val acc: 0.963
diff 198.7708378096513
epoch 26 train loss: 1148.519, val loss: 1288.177, train acc: 0.990, val acc: 0.964
diff 210.83836622918966
epoch 27 train loss: 1353.480, val loss: 1458.628, train acc: 0.988, val acc: 0.962
diff 170.45116870266975
epoch 28 train loss: 1222.325, val loss: 1374.707, train acc: 0.990, val acc: 0.965
diff 83.9214253462685
epoch 29 train loss: 1289.023, val loss: 1173.481, train acc: 0.989, val acc: 0.966
diff 201.22623930188115
epoch 30 train loss: 1239.142, val loss: 1469.029, train acc: 0.990, val acc: 0.964
diff 295.54789058255415
Training model M3
epoch 1 train loss: 5688.919, val loss: 572.887, train acc: 0.973, val acc: 0.965
diff inf
epoch 2 train loss: 3450.618, val loss: 427.627, train acc: 0.975, val acc: 0.978
diff 145.26010118396073
epoch 3 train loss: 2830.113, val loss: 486.664, train acc: 0.977, val acc: 0.971
diff 59.03745500677758
epoch 4 train loss: 2529.917, val loss: 423.084, train acc: 0.979, val acc: 0.968
diff 63.58062475878751
epoch 5 train loss: 2232.122, val loss: 469.240, train acc: 0.979, val acc: 0.971
diff 46.15665514969686
epoch 6 train loss: 2426.619, val loss: 367.694, train acc: 0.979, val acc: 0.974
diff 101.54592418309267
epoch 7 train loss: 2145.344, val loss: 477.061, train acc: 0.980, val acc: 0.967
diff 109.36686623100775
epoch 8 train loss: 2040.178, val loss: 326.642, train acc: 0.981, val acc: 0.980
diff 150.4190939928995
epoch 9 train loss: 2276.317, val loss: 339.781, train acc: 0.980, val acc: 0.976
diff 13.138841685227646
epoch 10 train loss: 2010.462, val loss: 378.259, train acc: 0.981, val acc: 0.980
diff 38.47815091762112
epoch 11 train loss: 1940.007, val loss: 411.749, train acc: 0.982, val acc: 0.974
diff 33.489582767131196
epoch 12 train loss: 1840.741, val loss: 307.844, train acc: 0.983, val acc: 0.977
diff 103.90440826032403
epoch 13 train loss: 1996.926, val loss: 361.918, train acc: 0.982, val acc: 0.978
diff 54.07379145043933
epoch 14 train loss: 1798.532, val loss: 451.792, train acc: 0.984, val acc: 0.975
diff 89.87413879832388
epoch 15 train loss: 1767.377, val loss: 292.435, train acc: 0.984, val acc: 0.982
diff 159.35684384987047
epoch 16 train loss: 1832.572, val loss: 330.690, train acc: 0.983, val acc: 0.981
diff 38.254849206161225
epoch 17 train loss: 1742.181, val loss: 375.954, train acc: 0.984, val acc: 0.979
diff 45.26412435599531
epoch 18 train loss: 1965.522, val loss: 381.597, train acc: 0.983, val acc: 0.972
diff 5.643102550707738
epoch 19 train loss: 1943.454, val loss: 506.438, train acc: 0.984, val acc: 0.975
diff 124.84092335614275
epoch 20 train loss: 1874.819, val loss: 687.092, train acc: 0.984, val acc: 0.969
diff 180.65407757369064
epoch 21 train loss: 1933.675, val loss: 331.178, train acc: 0.983, val acc: 0.978
diff 355.9147029452121
epoch 22 train loss: 1855.580, val loss: 331.377, train acc: 0.983, val acc: 0.984
diff 0.19875149315788576
epoch 23 train loss: 1693.960, val loss: 334.700, train acc: 0.985, val acc: 0.984
diff 3.3233369326380284
epoch 24 train loss: 1857.172, val loss: 357.252, train acc: 0.984, val acc: 0.979
diff 22.552073027175595
epoch 25 train loss: 1887.233, val loss: 242.821, train acc: 0.985, val acc: 0.984
diff 114.43064506243994
epoch 26 train loss: 1895.997, val loss: 550.474, train acc: 0.986, val acc: 0.977
diff 307.6527150512745
epoch 27 train loss: 1700.977, val loss: 288.052, train acc: 0.986, val acc: 0.984
diff 262.42245282523623
epoch 28 train loss: 1698.924, val loss: 297.006, train acc: 0.986, val acc: 0.984
diff 8.9549242040992
epoch 29 train loss: 1805.871, val loss: 259.174, train acc: 0.985, val acc: 0.987
diff 37.83207899867415
epoch 30 train loss: 1690.388, val loss: 400.096, train acc: 0.985, val acc: 0.978
diff 140.92153834524413
training representation using icarl loss
training representation using icarl loss
