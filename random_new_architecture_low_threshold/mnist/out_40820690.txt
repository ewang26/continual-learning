Using CPU
Running experiment mnist:
Results are stored in: random_new_architecture_low_threshold/mnist
with hyperparameters {'p': 0.2, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.001, 'random_seed': 4, 'class_balanced': True, 'max_data_size': 6000, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 6346.257, val loss: 524.697, train acc: 0.908, val acc: 0.932
diff inf
epoch 2 train loss: 3526.833, val loss: 352.165, train acc: 0.948, val acc: 0.957
diff 172.53181481284304
epoch 3 train loss: 2853.400, val loss: 356.926, train acc: 0.959, val acc: 0.956
diff 4.761417214120911
epoch 4 train loss: 2357.192, val loss: 298.681, train acc: 0.966, val acc: 0.968
diff 58.244707854412354
epoch 5 train loss: 2048.086, val loss: 315.725, train acc: 0.971, val acc: 0.963
diff 17.043988375709716
epoch 6 train loss: 1850.673, val loss: 359.747, train acc: 0.973, val acc: 0.968
diff 44.02180887088798
epoch 7 train loss: 1741.574, val loss: 356.018, train acc: 0.974, val acc: 0.960
diff 3.729557415687907
epoch 8 train loss: 1673.385, val loss: 316.747, train acc: 0.976, val acc: 0.966
diff 39.27058034856515
epoch 9 train loss: 1471.840, val loss: 284.985, train acc: 0.979, val acc: 0.974
diff 31.76194097323804
epoch 10 train loss: 1531.501, val loss: 295.490, train acc: 0.979, val acc: 0.974
diff 10.505207275188525
epoch 11 train loss: 1224.543, val loss: 341.147, train acc: 0.982, val acc: 0.973
diff 45.6566016502415
epoch 12 train loss: 1240.388, val loss: 398.917, train acc: 0.981, val acc: 0.965
diff 57.76951407069356
epoch 13 train loss: 1212.409, val loss: 379.070, train acc: 0.982, val acc: 0.972
diff 19.846723325450796
epoch 14 train loss: 1292.740, val loss: 342.477, train acc: 0.982, val acc: 0.970
diff 36.59276563676207
epoch 15 train loss: 1072.005, val loss: 320.578, train acc: 0.984, val acc: 0.970
diff 21.898870412607778
epoch 16 train loss: 1071.659, val loss: 363.456, train acc: 0.985, val acc: 0.971
diff 42.878034418912534
epoch 17 train loss: 1035.882, val loss: 354.481, train acc: 0.984, val acc: 0.969
diff 8.974939940417812
epoch 18 train loss: 1096.481, val loss: 453.749, train acc: 0.985, val acc: 0.964
diff 99.26749143898132
epoch 19 train loss: 1050.807, val loss: 490.040, train acc: 0.986, val acc: 0.958
diff 36.29114551047667
epoch 20 train loss: 836.123, val loss: 465.786, train acc: 0.988, val acc: 0.966
diff 24.25389968512917
epoch 21 train loss: 1070.807, val loss: 458.245, train acc: 0.986, val acc: 0.968
diff 7.541428992910767
epoch 22 train loss: 981.378, val loss: 548.052, train acc: 0.988, val acc: 0.968
diff 89.80742186202798
epoch 23 train loss: 948.288, val loss: 396.682, train acc: 0.987, val acc: 0.973
diff 151.3697100898549
epoch 24 train loss: 951.577, val loss: 439.052, train acc: 0.988, val acc: 0.971
diff 42.36961184039359
epoch 25 train loss: 876.708, val loss: 562.593, train acc: 0.988, val acc: 0.964
diff 123.54067614582095
epoch 26 train loss: 845.559, val loss: 371.951, train acc: 0.989, val acc: 0.978
diff 190.64197092881045
epoch 27 train loss: 805.899, val loss: 618.872, train acc: 0.990, val acc: 0.966
diff 246.92146520673987
epoch 28 train loss: 781.318, val loss: 562.027, train acc: 0.990, val acc: 0.969
diff 56.845230255657384
epoch 29 train loss: 773.377, val loss: 468.716, train acc: 0.989, val acc: 0.969
diff 93.31110017140116
epoch 30 train loss: 761.449, val loss: 544.143, train acc: 0.990, val acc: 0.971
diff 75.4272536615594
Training model M2
epoch 1 train loss: 11123.883, val loss: 762.668, train acc: 0.871, val acc: 0.925
diff inf
epoch 2 train loss: 6305.916, val loss: 667.822, train acc: 0.928, val acc: 0.931
diff 94.84616058711913
epoch 3 train loss: 5148.517, val loss: 637.993, train acc: 0.942, val acc: 0.934
diff 29.82843260923198
epoch 4 train loss: 4493.907, val loss: 540.583, train acc: 0.949, val acc: 0.950
diff 97.41014899651441
epoch 5 train loss: 4025.675, val loss: 657.915, train acc: 0.953, val acc: 0.937
diff 117.33157922845271
epoch 6 train loss: 3738.128, val loss: 504.705, train acc: 0.956, val acc: 0.955
diff 153.20929497857333
epoch 7 train loss: 3413.753, val loss: 532.016, train acc: 0.960, val acc: 0.952
diff 27.310398091791058
epoch 8 train loss: 3026.509, val loss: 579.174, train acc: 0.965, val acc: 0.952
diff 47.15832488181832
epoch 9 train loss: 3043.579, val loss: 728.916, train acc: 0.965, val acc: 0.940
diff 149.74221571013197
epoch 10 train loss: 2872.319, val loss: 511.234, train acc: 0.967, val acc: 0.963
diff 217.68185210505186
epoch 11 train loss: 2587.671, val loss: 652.968, train acc: 0.970, val acc: 0.946
diff 141.73371758726972
epoch 12 train loss: 2577.901, val loss: 799.169, train acc: 0.970, val acc: 0.944
diff 146.20086250159898
epoch 13 train loss: 2522.917, val loss: 649.404, train acc: 0.971, val acc: 0.949
diff 149.7654382675978
epoch 14 train loss: 2458.581, val loss: 679.937, train acc: 0.972, val acc: 0.956
diff 30.533867535537524
epoch 15 train loss: 2245.019, val loss: 713.346, train acc: 0.974, val acc: 0.953
diff 33.408628930278496
epoch 16 train loss: 2380.093, val loss: 588.847, train acc: 0.973, val acc: 0.957
diff 124.49952576976955
epoch 17 train loss: 2132.756, val loss: 857.750, train acc: 0.975, val acc: 0.948
diff 268.90321267862544
epoch 18 train loss: 2150.530, val loss: 1003.410, train acc: 0.976, val acc: 0.938
diff 145.66035476662887
epoch 19 train loss: 2275.186, val loss: 736.736, train acc: 0.974, val acc: 0.948
diff 266.674448782112
epoch 20 train loss: 1971.111, val loss: 647.376, train acc: 0.977, val acc: 0.958
diff 89.35960751051368
epoch 21 train loss: 2145.082, val loss: 632.811, train acc: 0.977, val acc: 0.960
diff 14.565510568949776
epoch 22 train loss: 1979.613, val loss: 692.642, train acc: 0.978, val acc: 0.957
diff 59.831536745494645
epoch 23 train loss: 1897.390, val loss: 660.168, train acc: 0.979, val acc: 0.956
diff 32.47400934556845
epoch 24 train loss: 1895.000, val loss: 691.891, train acc: 0.980, val acc: 0.960
diff 31.722507128970165
epoch 25 train loss: 1805.027, val loss: 828.354, train acc: 0.980, val acc: 0.953
diff 136.4632430613475
epoch 26 train loss: 1819.487, val loss: 941.818, train acc: 0.981, val acc: 0.951
diff 113.46415362483515
epoch 27 train loss: 1718.922, val loss: 796.149, train acc: 0.982, val acc: 0.950
diff 145.66882876707655
epoch 28 train loss: 1832.299, val loss: 742.646, train acc: 0.980, val acc: 0.961
diff 53.50296589737047
epoch 29 train loss: 1842.423, val loss: 829.988, train acc: 0.981, val acc: 0.958
diff 87.34142011851827
epoch 30 train loss: 1939.607, val loss: 1050.431, train acc: 0.980, val acc: 0.954
diff 220.44375767260806
Training model M3
epoch 1 train loss: 5526.102, val loss: 1182.399, train acc: 0.831, val acc: 0.879
diff inf
epoch 2 train loss: 3149.407, val loss: 945.622, train acc: 0.903, val acc: 0.909
diff 236.77707131982766
epoch 3 train loss: 2416.686, val loss: 965.030, train acc: 0.925, val acc: 0.902
diff 19.408415882297163
epoch 4 train loss: 2055.832, val loss: 773.561, train acc: 0.933, val acc: 0.922
diff 191.4690611569887
epoch 5 train loss: 1787.620, val loss: 746.952, train acc: 0.945, val acc: 0.925
diff 26.60926730512176
epoch 6 train loss: 1502.389, val loss: 992.825, train acc: 0.951, val acc: 0.907
diff 245.87256411190538
epoch 7 train loss: 1359.175, val loss: 683.315, train acc: 0.958, val acc: 0.939
diff 309.5096118931765
epoch 8 train loss: 1233.329, val loss: 711.409, train acc: 0.960, val acc: 0.933
diff 28.09407557680629
epoch 9 train loss: 1126.667, val loss: 842.393, train acc: 0.964, val acc: 0.920
diff 130.98423817817047
epoch 10 train loss: 1046.290, val loss: 837.115, train acc: 0.967, val acc: 0.933
diff 5.278031428851818
epoch 11 train loss: 937.323, val loss: 750.807, train acc: 0.969, val acc: 0.942
diff 86.30821595248165
epoch 12 train loss: 923.431, val loss: 816.556, train acc: 0.970, val acc: 0.937
diff 65.74883148124275
epoch 13 train loss: 780.421, val loss: 771.288, train acc: 0.973, val acc: 0.937
diff 45.26768870091223
epoch 14 train loss: 759.356, val loss: 929.252, train acc: 0.976, val acc: 0.927
diff 157.96345005454805
epoch 15 train loss: 784.884, val loss: 895.755, train acc: 0.977, val acc: 0.928
diff 33.4969000354954
epoch 16 train loss: 763.440, val loss: 881.052, train acc: 0.975, val acc: 0.934
diff 14.70316168184877
epoch 17 train loss: 642.312, val loss: 1166.271, train acc: 0.980, val acc: 0.909
diff 285.218960137424
epoch 18 train loss: 599.057, val loss: 976.712, train acc: 0.980, val acc: 0.928
diff 189.55869145476868
epoch 19 train loss: 776.850, val loss: 1108.318, train acc: 0.976, val acc: 0.924
diff 131.60617085319655
epoch 20 train loss: 534.186, val loss: 1036.302, train acc: 0.983, val acc: 0.929
diff 72.01638987308957
epoch 21 train loss: 603.437, val loss: 881.901, train acc: 0.980, val acc: 0.947
diff 154.40114132896747
epoch 22 train loss: 643.908, val loss: 1123.587, train acc: 0.981, val acc: 0.935
diff 241.68624911276333
epoch 23 train loss: 502.655, val loss: 808.932, train acc: 0.985, val acc: 0.950
diff 314.6550986407701
epoch 24 train loss: 606.101, val loss: 1088.528, train acc: 0.983, val acc: 0.936
diff 279.59656349466854
epoch 25 train loss: 708.839, val loss: 1019.099, train acc: 0.979, val acc: 0.941
diff 69.42903877335971
epoch 26 train loss: 285.665, val loss: 882.943, train acc: 0.990, val acc: 0.945
diff 136.15588069960268
epoch 27 train loss: 663.452, val loss: 1155.599, train acc: 0.981, val acc: 0.939
diff 272.6560437778619
epoch 28 train loss: 500.904, val loss: 969.700, train acc: 0.985, val acc: 0.949
diff 185.89993009218313
epoch 29 train loss: 539.460, val loss: 1205.115, train acc: 0.986, val acc: 0.929
diff 235.41583398886144
epoch 30 train loss: 466.229, val loss: 1327.705, train acc: 0.986, val acc: 0.930
diff 122.59002002551392
Training model M3
epoch 1 train loss: 561.698, val loss: 1843.313, train acc: 0.987, val acc: 0.918
diff inf
epoch 2 train loss: 371.704, val loss: 2222.357, train acc: 0.990, val acc: 0.917
diff 379.04319810372
epoch 3 train loss: 342.695, val loss: 3319.367, train acc: 0.991, val acc: 0.879
diff 1097.0107501365105
epoch 4 train loss: 300.109, val loss: 2597.687, train acc: 0.993, val acc: 0.899
diff 721.680629677413
epoch 5 train loss: 460.568, val loss: 3756.565, train acc: 0.989, val acc: 0.886
diff 1158.878164219233
epoch 6 train loss: 444.526, val loss: 3146.057, train acc: 0.990, val acc: 0.899
diff 610.5078324277652
epoch 7 train loss: 178.483, val loss: 3910.433, train acc: 0.995, val acc: 0.883
diff 764.3762224030042
epoch 8 train loss: 421.873, val loss: 5058.039, train acc: 0.990, val acc: 0.872
diff 1147.6052638120964
epoch 9 train loss: 303.864, val loss: 3257.503, train acc: 0.994, val acc: 0.896
diff 1800.5358713361466
epoch 10 train loss: 273.376, val loss: 3543.407, train acc: 0.993, val acc: 0.886
diff 285.90403555627154
epoch 11 train loss: 330.130, val loss: 5917.327, train acc: 0.992, val acc: 0.830
diff 2373.920359176542
epoch 12 train loss: 264.109, val loss: 5344.987, train acc: 0.993, val acc: 0.853
diff 572.3398631606487
epoch 13 train loss: 261.367, val loss: 3886.045, train acc: 0.994, val acc: 0.883
diff 1458.9420835468513
epoch 14 train loss: 162.901, val loss: 5752.767, train acc: 0.996, val acc: 0.832
diff 1866.7221036508022
epoch 15 train loss: 263.756, val loss: 5648.618, train acc: 0.994, val acc: 0.857
diff 104.14969283295522
epoch 16 train loss: 334.140, val loss: 3961.395, train acc: 0.993, val acc: 0.899
diff 1687.2227699456325
epoch 17 train loss: 124.449, val loss: 5030.413, train acc: 0.997, val acc: 0.878
diff 1069.0186244881634
epoch 18 train loss: 327.323, val loss: 4787.135, train acc: 0.992, val acc: 0.881
diff 243.27812101812015
epoch 19 train loss: 244.528, val loss: 7435.503, train acc: 0.993, val acc: 0.839
diff 2648.3681791823537
epoch 20 train loss: 189.779, val loss: 4681.436, train acc: 0.996, val acc: 0.890
diff 2754.067148379637
epoch 21 train loss: 129.010, val loss: 6338.398, train acc: 0.996, val acc: 0.847
diff 1656.96156215281
epoch 22 train loss: 403.938, val loss: 6285.487, train acc: 0.991, val acc: 0.856
diff 52.91105310837884
epoch 23 train loss: 177.679, val loss: 6678.404, train acc: 0.996, val acc: 0.865
diff 392.9169744421206
epoch 24 train loss: 175.126, val loss: 6613.804, train acc: 0.995, val acc: 0.869
diff 64.60006479883668
epoch 25 train loss: 5.737, val loss: 6920.040, train acc: 1.000, val acc: 0.865
diff 306.23650175303464
epoch 26 train loss: 569.717, val loss: 7149.650, train acc: 0.988, val acc: 0.858
diff 229.61013853252553
epoch 27 train loss: 78.312, val loss: 6853.152, train acc: 0.998, val acc: 0.867
diff 296.4983881461885
epoch 28 train loss: 309.193, val loss: 6578.753, train acc: 0.994, val acc: 0.876
diff 274.3990600371808
epoch 29 train loss: 299.213, val loss: 8821.148, train acc: 0.994, val acc: 0.852
diff 2242.395473067413
epoch 30 train loss: 115.510, val loss: 7644.994, train acc: 0.998, val acc: 0.866
diff 1176.154252020914
Training model M3
epoch 1 train loss: 9757.982, val loss: 1351.974, train acc: 0.879, val acc: 0.860
diff inf
epoch 2 train loss: 4148.575, val loss: 1023.167, train acc: 0.898, val acc: 0.906
diff 328.8072381723689
epoch 3 train loss: 3126.566, val loss: 857.020, train acc: 0.915, val acc: 0.923
diff 166.14635360798752
epoch 4 train loss: 2669.803, val loss: 796.950, train acc: 0.923, val acc: 0.927
diff 60.07043625610402
epoch 5 train loss: 2369.335, val loss: 712.679, train acc: 0.932, val acc: 0.929
diff 84.27139070156147
epoch 6 train loss: 2243.062, val loss: 640.470, train acc: 0.935, val acc: 0.940
diff 72.20832330896906
epoch 7 train loss: 1734.360, val loss: 845.510, train acc: 0.946, val acc: 0.919
diff 205.03978766716295
epoch 8 train loss: 1708.853, val loss: 688.796, train acc: 0.950, val acc: 0.933
diff 156.71389850265507
epoch 9 train loss: 1484.362, val loss: 852.832, train acc: 0.952, val acc: 0.929
diff 164.0358638591058
epoch 10 train loss: 1525.751, val loss: 879.332, train acc: 0.951, val acc: 0.924
diff 26.50045654857763
epoch 11 train loss: 1505.674, val loss: 890.329, train acc: 0.954, val acc: 0.928
diff 10.99667777252489
epoch 12 train loss: 1232.165, val loss: 855.512, train acc: 0.959, val acc: 0.924
diff 34.81686964035532
epoch 13 train loss: 1133.640, val loss: 701.110, train acc: 0.964, val acc: 0.944
diff 154.4020668543759
epoch 14 train loss: 1214.423, val loss: 620.880, train acc: 0.962, val acc: 0.950
diff 80.22997970779727
epoch 15 train loss: 1109.522, val loss: 694.855, train acc: 0.968, val acc: 0.945
diff 73.97500327163232
epoch 16 train loss: 914.194, val loss: 772.654, train acc: 0.971, val acc: 0.950
diff 77.79874319461578
epoch 17 train loss: 915.021, val loss: 826.928, train acc: 0.970, val acc: 0.945
diff 54.27366231369888
epoch 18 train loss: 964.634, val loss: 1089.971, train acc: 0.969, val acc: 0.924
diff 263.04355934208195
epoch 19 train loss: 902.831, val loss: 1206.518, train acc: 0.971, val acc: 0.930
diff 116.54635595026798
epoch 20 train loss: 906.847, val loss: 710.201, train acc: 0.971, val acc: 0.956
diff 496.31690841734064
epoch 21 train loss: 789.947, val loss: 809.296, train acc: 0.975, val acc: 0.952
diff 99.09536382142687
epoch 22 train loss: 874.596, val loss: 1056.373, train acc: 0.974, val acc: 0.938
diff 247.07692197988047
epoch 23 train loss: 801.479, val loss: 1329.247, train acc: 0.975, val acc: 0.935
diff 272.87391460156095
epoch 24 train loss: 937.987, val loss: 896.819, train acc: 0.972, val acc: 0.951
diff 432.4281221866015
epoch 25 train loss: 572.096, val loss: 1371.546, train acc: 0.981, val acc: 0.939
diff 474.72706759572884
epoch 26 train loss: 696.526, val loss: 852.507, train acc: 0.978, val acc: 0.957
diff 519.0383929924667
epoch 27 train loss: 626.347, val loss: 1009.239, train acc: 0.981, val acc: 0.948
diff 156.73133121051512
epoch 28 train loss: 908.507, val loss: 982.518, train acc: 0.975, val acc: 0.949
diff 26.72070259548093
epoch 29 train loss: 702.673, val loss: 1040.248, train acc: 0.979, val acc: 0.948
diff 57.72975102050577
epoch 30 train loss: 824.828, val loss: 1030.439, train acc: 0.977, val acc: 0.941
diff 9.809001681972632
training representation using icarl loss
training representation using icarl loss
training representation using icarl loss
training representation using icarl loss
Training model M3
epoch 1 train loss: 1591.780, val loss: 649.563, train acc: 0.968, val acc: 0.958
diff inf
epoch 2 train loss: 1021.245, val loss: 732.808, train acc: 0.977, val acc: 0.955
diff 83.24555864234515
epoch 3 train loss: 814.875, val loss: 882.770, train acc: 0.979, val acc: 0.948
diff 149.9619023687702
epoch 4 train loss: 668.728, val loss: 858.540, train acc: 0.982, val acc: 0.954
diff 24.23019950845992
epoch 5 train loss: 553.618, val loss: 870.592, train acc: 0.984, val acc: 0.954
diff 12.052158767336437
epoch 6 train loss: 651.508, val loss: 803.659, train acc: 0.982, val acc: 0.947
diff 66.93297384529887
epoch 7 train loss: 602.686, val loss: 1055.495, train acc: 0.984, val acc: 0.951
diff 251.8363369794156
epoch 8 train loss: 377.812, val loss: 1085.734, train acc: 0.989, val acc: 0.949
diff 30.23906113924204
epoch 9 train loss: 596.790, val loss: 865.360, train acc: 0.985, val acc: 0.959
diff 220.37431003428162
epoch 10 train loss: 446.330, val loss: 906.262, train acc: 0.988, val acc: 0.953
diff 40.90211289354022
epoch 11 train loss: 415.542, val loss: 1075.393, train acc: 0.988, val acc: 0.959
diff 169.1311850770985
epoch 12 train loss: 745.504, val loss: 963.857, train acc: 0.984, val acc: 0.952
diff 111.53647941429938
epoch 13 train loss: 507.904, val loss: 777.043, train acc: 0.987, val acc: 0.963
diff 186.81374792546
epoch 14 train loss: 357.653, val loss: 1433.130, train acc: 0.991, val acc: 0.938
diff 656.0863583061196
epoch 15 train loss: 506.793, val loss: 982.974, train acc: 0.988, val acc: 0.958
diff 450.1552699982715
epoch 16 train loss: 427.837, val loss: 946.856, train acc: 0.990, val acc: 0.964
diff 36.118781677551056
epoch 17 train loss: 450.809, val loss: 1331.380, train acc: 0.988, val acc: 0.947
diff 384.52432251935795
epoch 18 train loss: 492.895, val loss: 1150.303, train acc: 0.988, val acc: 0.949
diff 181.07674906010357
epoch 19 train loss: 524.388, val loss: 910.960, train acc: 0.988, val acc: 0.957
diff 239.34339197771624
epoch 20 train loss: 247.533, val loss: 878.731, train acc: 0.993, val acc: 0.963
diff 32.22883124035741
epoch 21 train loss: 570.333, val loss: 854.776, train acc: 0.988, val acc: 0.961
diff 23.95493334301034
epoch 22 train loss: 294.103, val loss: 1057.765, train acc: 0.992, val acc: 0.957
diff 202.98900393525696
epoch 23 train loss: 318.675, val loss: 1016.005, train acc: 0.993, val acc: 0.964
diff 41.75953627628758
epoch 24 train loss: 517.332, val loss: 1113.601, train acc: 0.988, val acc: 0.958
diff 97.59557024703633
epoch 25 train loss: 444.669, val loss: 1476.898, train acc: 0.989, val acc: 0.952
diff 363.29725905585315
epoch 26 train loss: 531.145, val loss: 1133.448, train acc: 0.990, val acc: 0.962
diff 343.4506811533986
epoch 27 train loss: 302.044, val loss: 975.468, train acc: 0.992, val acc: 0.961
diff 157.9799674854404
epoch 28 train loss: 604.696, val loss: 1189.877, train acc: 0.988, val acc: 0.959
diff 214.40984370845956
epoch 29 train loss: 302.230, val loss: 1212.855, train acc: 0.993, val acc: 0.956
diff 22.977930427864976
epoch 30 train loss: 568.803, val loss: 1251.516, train acc: 0.990, val acc: 0.955
diff 38.66022550379489
training representation using replay loss
training representation using replay loss
training representation using replay loss
