Using CPU
Running experiment mnist:
Results are stored in: random_new_architecture_low_threshold/mnist
with hyperparameters {'p': 0.5, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.001, 'random_seed': 4, 'class_balanced': True, 'max_data_size': 6000, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 6346.257, val loss: 524.697, train acc: 0.908, val acc: 0.932
diff inf
epoch 2 train loss: 3526.833, val loss: 352.165, train acc: 0.948, val acc: 0.957
diff 172.53181481284304
epoch 3 train loss: 2853.400, val loss: 356.926, train acc: 0.959, val acc: 0.956
diff 4.761417214120911
epoch 4 train loss: 2357.192, val loss: 298.681, train acc: 0.966, val acc: 0.968
diff 58.244707854412354
epoch 5 train loss: 2048.086, val loss: 315.725, train acc: 0.971, val acc: 0.963
diff 17.043988375709716
epoch 6 train loss: 1850.673, val loss: 359.747, train acc: 0.973, val acc: 0.968
diff 44.02180887088798
epoch 7 train loss: 1741.574, val loss: 356.018, train acc: 0.974, val acc: 0.960
diff 3.729557415687907
epoch 8 train loss: 1673.385, val loss: 316.747, train acc: 0.976, val acc: 0.966
diff 39.27058034856515
epoch 9 train loss: 1471.840, val loss: 284.985, train acc: 0.979, val acc: 0.974
diff 31.76194097323804
epoch 10 train loss: 1531.501, val loss: 295.490, train acc: 0.979, val acc: 0.974
diff 10.505207275188525
epoch 11 train loss: 1224.543, val loss: 341.147, train acc: 0.982, val acc: 0.973
diff 45.6566016502415
epoch 12 train loss: 1240.388, val loss: 398.917, train acc: 0.981, val acc: 0.965
diff 57.76951407069356
epoch 13 train loss: 1212.409, val loss: 379.070, train acc: 0.982, val acc: 0.972
diff 19.846723325450796
epoch 14 train loss: 1292.740, val loss: 342.477, train acc: 0.982, val acc: 0.970
diff 36.59276563676207
epoch 15 train loss: 1072.005, val loss: 320.578, train acc: 0.984, val acc: 0.970
diff 21.898870412607778
epoch 16 train loss: 1071.659, val loss: 363.456, train acc: 0.985, val acc: 0.971
diff 42.878034418912534
epoch 17 train loss: 1035.882, val loss: 354.481, train acc: 0.984, val acc: 0.969
diff 8.974939940417812
epoch 18 train loss: 1096.481, val loss: 453.749, train acc: 0.985, val acc: 0.964
diff 99.26749143898132
epoch 19 train loss: 1050.807, val loss: 490.040, train acc: 0.986, val acc: 0.958
diff 36.29114551047667
epoch 20 train loss: 836.123, val loss: 465.786, train acc: 0.988, val acc: 0.966
diff 24.25389968512917
epoch 21 train loss: 1070.807, val loss: 458.245, train acc: 0.986, val acc: 0.968
diff 7.541428992910767
epoch 22 train loss: 981.378, val loss: 548.052, train acc: 0.988, val acc: 0.968
diff 89.80742186202798
epoch 23 train loss: 948.288, val loss: 396.682, train acc: 0.987, val acc: 0.973
diff 151.3697100898549
epoch 24 train loss: 951.577, val loss: 439.052, train acc: 0.988, val acc: 0.971
diff 42.36961184039359
epoch 25 train loss: 876.708, val loss: 562.593, train acc: 0.988, val acc: 0.964
diff 123.54067614582095
epoch 26 train loss: 845.559, val loss: 371.951, train acc: 0.989, val acc: 0.978
diff 190.64197092881045
epoch 27 train loss: 805.899, val loss: 618.872, train acc: 0.990, val acc: 0.966
diff 246.92146520673987
epoch 28 train loss: 781.318, val loss: 562.027, train acc: 0.990, val acc: 0.969
diff 56.845230255657384
epoch 29 train loss: 773.377, val loss: 468.716, train acc: 0.989, val acc: 0.969
diff 93.31110017140116
epoch 30 train loss: 761.449, val loss: 544.143, train acc: 0.990, val acc: 0.971
diff 75.4272536615594
Training model M2
epoch 1 train loss: 11123.883, val loss: 762.668, train acc: 0.871, val acc: 0.925
diff inf
epoch 2 train loss: 6305.916, val loss: 667.822, train acc: 0.928, val acc: 0.931
diff 94.84616058711913
epoch 3 train loss: 5148.517, val loss: 637.993, train acc: 0.942, val acc: 0.934
diff 29.82843260923198
epoch 4 train loss: 4493.907, val loss: 540.583, train acc: 0.949, val acc: 0.950
diff 97.41014899651441
epoch 5 train loss: 4025.675, val loss: 657.915, train acc: 0.953, val acc: 0.937
diff 117.33157922845271
epoch 6 train loss: 3738.128, val loss: 504.705, train acc: 0.956, val acc: 0.955
diff 153.20929497857333
epoch 7 train loss: 3413.753, val loss: 532.016, train acc: 0.960, val acc: 0.952
diff 27.310398091791058
epoch 8 train loss: 3026.509, val loss: 579.174, train acc: 0.965, val acc: 0.952
diff 47.15832488181832
epoch 9 train loss: 3043.579, val loss: 728.916, train acc: 0.965, val acc: 0.940
diff 149.74221571013197
epoch 10 train loss: 2872.319, val loss: 511.234, train acc: 0.967, val acc: 0.963
diff 217.68185210505186
epoch 11 train loss: 2587.671, val loss: 652.968, train acc: 0.970, val acc: 0.946
diff 141.73371758726972
epoch 12 train loss: 2577.901, val loss: 799.169, train acc: 0.970, val acc: 0.944
diff 146.20086250159898
epoch 13 train loss: 2522.917, val loss: 649.404, train acc: 0.971, val acc: 0.949
diff 149.7654382675978
epoch 14 train loss: 2458.581, val loss: 679.937, train acc: 0.972, val acc: 0.956
diff 30.533867535537524
epoch 15 train loss: 2245.019, val loss: 713.346, train acc: 0.974, val acc: 0.953
diff 33.408628930278496
epoch 16 train loss: 2380.093, val loss: 588.847, train acc: 0.973, val acc: 0.957
diff 124.49952576976955
epoch 17 train loss: 2132.756, val loss: 857.750, train acc: 0.975, val acc: 0.948
diff 268.90321267862544
epoch 18 train loss: 2150.530, val loss: 1003.410, train acc: 0.976, val acc: 0.938
diff 145.66035476662887
epoch 19 train loss: 2275.186, val loss: 736.736, train acc: 0.974, val acc: 0.948
diff 266.674448782112
epoch 20 train loss: 1971.111, val loss: 647.376, train acc: 0.977, val acc: 0.958
diff 89.35960751051368
epoch 21 train loss: 2145.082, val loss: 632.811, train acc: 0.977, val acc: 0.960
diff 14.565510568949776
epoch 22 train loss: 1979.613, val loss: 692.642, train acc: 0.978, val acc: 0.957
diff 59.831536745494645
epoch 23 train loss: 1897.390, val loss: 660.168, train acc: 0.979, val acc: 0.956
diff 32.47400934556845
epoch 24 train loss: 1895.000, val loss: 691.891, train acc: 0.980, val acc: 0.960
diff 31.722507128970165
epoch 25 train loss: 1805.027, val loss: 828.354, train acc: 0.980, val acc: 0.953
diff 136.4632430613475
epoch 26 train loss: 1819.487, val loss: 941.818, train acc: 0.981, val acc: 0.951
diff 113.46415362483515
epoch 27 train loss: 1718.922, val loss: 796.149, train acc: 0.982, val acc: 0.950
diff 145.66882876707655
epoch 28 train loss: 1832.299, val loss: 742.646, train acc: 0.980, val acc: 0.961
diff 53.50296589737047
epoch 29 train loss: 1842.423, val loss: 829.988, train acc: 0.981, val acc: 0.958
diff 87.34142011851827
epoch 30 train loss: 1939.607, val loss: 1050.431, train acc: 0.980, val acc: 0.954
diff 220.44375767260806
Training model M3
epoch 1 train loss: 8423.754, val loss: 805.151, train acc: 0.844, val acc: 0.918
diff inf
epoch 2 train loss: 4653.048, val loss: 787.915, train acc: 0.916, val acc: 0.918
diff 17.235532270833232
epoch 3 train loss: 3528.134, val loss: 569.101, train acc: 0.938, val acc: 0.945
diff 218.8138206635649
epoch 4 train loss: 3112.618, val loss: 571.299, train acc: 0.942, val acc: 0.940
diff 2.197601200801955
epoch 5 train loss: 2792.988, val loss: 669.164, train acc: 0.949, val acc: 0.934
diff 97.86490947993593
epoch 6 train loss: 2579.557, val loss: 473.479, train acc: 0.952, val acc: 0.951
diff 195.68494944114184
epoch 7 train loss: 2248.965, val loss: 494.774, train acc: 0.958, val acc: 0.952
diff 21.29465459340861
epoch 8 train loss: 2120.875, val loss: 598.964, train acc: 0.960, val acc: 0.944
diff 104.19057209320476
epoch 9 train loss: 1918.483, val loss: 489.041, train acc: 0.964, val acc: 0.952
diff 109.92319536761045
epoch 10 train loss: 1808.296, val loss: 646.753, train acc: 0.966, val acc: 0.946
diff 157.71183171123425
epoch 11 train loss: 1851.546, val loss: 536.342, train acc: 0.966, val acc: 0.949
diff 110.41047536643646
epoch 12 train loss: 1548.077, val loss: 527.203, train acc: 0.972, val acc: 0.956
diff 9.139206421602694
epoch 13 train loss: 1524.140, val loss: 651.907, train acc: 0.974, val acc: 0.952
diff 124.70389500768033
epoch 14 train loss: 1450.230, val loss: 555.234, train acc: 0.974, val acc: 0.959
diff 96.67337054082088
epoch 15 train loss: 1440.613, val loss: 372.191, train acc: 0.975, val acc: 0.973
diff 183.04258370079992
epoch 16 train loss: 1330.873, val loss: 524.951, train acc: 0.975, val acc: 0.956
diff 152.7595620188016
epoch 17 train loss: 1153.009, val loss: 506.775, train acc: 0.978, val acc: 0.963
diff 18.17596792046703
epoch 18 train loss: 1289.827, val loss: 472.027, train acc: 0.978, val acc: 0.969
diff 34.7477556353744
epoch 19 train loss: 1327.248, val loss: 510.092, train acc: 0.977, val acc: 0.966
diff 38.06550660003188
epoch 20 train loss: 1270.032, val loss: 793.199, train acc: 0.979, val acc: 0.952
diff 283.1068071999355
epoch 21 train loss: 1207.897, val loss: 750.588, train acc: 0.979, val acc: 0.957
diff 42.61158943708995
epoch 22 train loss: 1238.933, val loss: 468.793, train acc: 0.980, val acc: 0.973
diff 281.79430411026954
epoch 23 train loss: 1039.380, val loss: 450.062, train acc: 0.982, val acc: 0.976
diff 18.731165903656233
epoch 24 train loss: 1040.883, val loss: 632.405, train acc: 0.983, val acc: 0.964
diff 182.34261814684874
epoch 25 train loss: 1194.915, val loss: 664.136, train acc: 0.982, val acc: 0.961
diff 31.731237119343973
epoch 26 train loss: 926.608, val loss: 587.877, train acc: 0.984, val acc: 0.966
diff 76.25870800879375
epoch 27 train loss: 1249.024, val loss: 478.776, train acc: 0.980, val acc: 0.974
diff 109.1015571165508
epoch 28 train loss: 1095.244, val loss: 688.607, train acc: 0.982, val acc: 0.959
diff 209.8309528411429
epoch 29 train loss: 1034.846, val loss: 565.534, train acc: 0.982, val acc: 0.963
diff 123.07256589303745
epoch 30 train loss: 939.950, val loss: 846.042, train acc: 0.984, val acc: 0.944
diff 280.508055922831
Training model M3
epoch 1 train loss: 924.476, val loss: 1176.859, train acc: 0.986, val acc: 0.947
diff inf
epoch 2 train loss: 886.452, val loss: 1227.688, train acc: 0.988, val acc: 0.947
diff 50.82883688664447
epoch 3 train loss: 851.197, val loss: 1512.007, train acc: 0.987, val acc: 0.938
diff 284.3190115608261
epoch 4 train loss: 690.035, val loss: 1899.731, train acc: 0.990, val acc: 0.935
diff 387.7242379541017
epoch 5 train loss: 714.915, val loss: 1562.838, train acc: 0.989, val acc: 0.948
diff 336.89324933186117
epoch 6 train loss: 618.909, val loss: 1836.830, train acc: 0.991, val acc: 0.939
diff 273.9923958057798
epoch 7 train loss: 583.009, val loss: 1767.844, train acc: 0.991, val acc: 0.934
diff 68.98584819364396
epoch 8 train loss: 642.450, val loss: 2341.457, train acc: 0.991, val acc: 0.925
diff 573.6124083836096
epoch 9 train loss: 601.600, val loss: 1752.639, train acc: 0.991, val acc: 0.943
diff 588.8180046054488
epoch 10 train loss: 615.397, val loss: 2126.774, train acc: 0.991, val acc: 0.932
diff 374.13477352023733
epoch 11 train loss: 600.096, val loss: 1942.819, train acc: 0.991, val acc: 0.942
diff 183.95448126078418
epoch 12 train loss: 480.789, val loss: 3214.494, train acc: 0.994, val acc: 0.910
diff 1271.6744846817
epoch 13 train loss: 649.368, val loss: 1931.152, train acc: 0.991, val acc: 0.937
diff 1283.3419066403019
epoch 14 train loss: 536.811, val loss: 2276.705, train acc: 0.992, val acc: 0.936
diff 345.5527911581951
epoch 15 train loss: 589.247, val loss: 3264.578, train acc: 0.993, val acc: 0.920
diff 987.8729773502228
epoch 16 train loss: 518.901, val loss: 2206.115, train acc: 0.993, val acc: 0.936
diff 1058.462059131778
epoch 17 train loss: 392.300, val loss: 2661.013, train acc: 0.993, val acc: 0.927
diff 454.89794701726714
epoch 18 train loss: 667.855, val loss: 2797.185, train acc: 0.991, val acc: 0.931
diff 136.17209422894575
epoch 19 train loss: 489.872, val loss: 3153.712, train acc: 0.993, val acc: 0.930
diff 356.5264946159473
epoch 20 train loss: 481.997, val loss: 4645.044, train acc: 0.994, val acc: 0.893
diff 1491.332241280918
epoch 21 train loss: 472.128, val loss: 3204.624, train acc: 0.994, val acc: 0.932
diff 1440.4202707465488
epoch 22 train loss: 527.086, val loss: 3599.492, train acc: 0.993, val acc: 0.919
diff 394.8678249078266
epoch 23 train loss: 441.727, val loss: 3222.205, train acc: 0.994, val acc: 0.931
diff 377.28698877431043
epoch 24 train loss: 481.030, val loss: 3543.730, train acc: 0.993, val acc: 0.934
diff 321.52535619546416
epoch 25 train loss: 417.658, val loss: 3393.870, train acc: 0.995, val acc: 0.931
diff 149.86020125640925
epoch 26 train loss: 531.320, val loss: 3277.719, train acc: 0.994, val acc: 0.932
diff 116.15079886380363
epoch 27 train loss: 569.591, val loss: 4254.404, train acc: 0.994, val acc: 0.927
diff 976.6844373333552
epoch 28 train loss: 530.805, val loss: 3782.499, train acc: 0.994, val acc: 0.923
diff 471.904786026118
epoch 29 train loss: 491.084, val loss: 5512.086, train acc: 0.994, val acc: 0.904
diff 1729.5871631737964
epoch 30 train loss: 474.098, val loss: 4224.087, train acc: 0.994, val acc: 0.930
diff 1287.9985790627597
Training model M3
epoch 1 train loss: 9686.665, val loss: 730.178, train acc: 0.918, val acc: 0.939
diff inf
epoch 2 train loss: 4535.051, val loss: 612.737, train acc: 0.937, val acc: 0.948
diff 117.44029302092258
epoch 3 train loss: 3567.284, val loss: 656.236, train acc: 0.947, val acc: 0.944
diff 43.49859806769416
epoch 4 train loss: 3005.522, val loss: 400.029, train acc: 0.953, val acc: 0.967
diff 256.2071135818333
epoch 5 train loss: 2677.162, val loss: 488.859, train acc: 0.959, val acc: 0.956
diff 88.83013280185412
epoch 6 train loss: 2447.669, val loss: 410.131, train acc: 0.963, val acc: 0.965
diff 78.72845634336028
epoch 7 train loss: 2206.370, val loss: 438.923, train acc: 0.964, val acc: 0.965
diff 28.79238941845051
epoch 8 train loss: 1976.582, val loss: 361.095, train acc: 0.969, val acc: 0.969
diff 77.82834204047049
epoch 9 train loss: 1994.298, val loss: 448.497, train acc: 0.967, val acc: 0.968
diff 87.40279305675972
epoch 10 train loss: 1824.299, val loss: 397.281, train acc: 0.970, val acc: 0.967
diff 51.21614539754614
epoch 11 train loss: 1625.526, val loss: 371.211, train acc: 0.974, val acc: 0.977
diff 26.070300578629087
epoch 12 train loss: 1631.725, val loss: 427.276, train acc: 0.974, val acc: 0.968
diff 56.06477206736338
epoch 13 train loss: 1470.576, val loss: 437.563, train acc: 0.975, val acc: 0.966
diff 10.287701822804024
epoch 14 train loss: 1488.887, val loss: 377.410, train acc: 0.976, val acc: 0.976
diff 60.15376961164179
epoch 15 train loss: 1446.683, val loss: 310.549, train acc: 0.977, val acc: 0.974
diff 66.86037346970755
epoch 16 train loss: 1498.099, val loss: 498.163, train acc: 0.976, val acc: 0.969
diff 187.61397487123628
epoch 17 train loss: 1417.474, val loss: 564.700, train acc: 0.977, val acc: 0.962
diff 66.53676336257496
epoch 18 train loss: 1340.232, val loss: 439.433, train acc: 0.978, val acc: 0.975
diff 125.26711076705152
epoch 19 train loss: 1389.096, val loss: 422.680, train acc: 0.977, val acc: 0.973
diff 16.753387656351038
epoch 20 train loss: 1356.028, val loss: 459.185, train acc: 0.979, val acc: 0.969
diff 36.505154272687264
epoch 21 train loss: 1288.475, val loss: 390.996, train acc: 0.979, val acc: 0.977
diff 68.18850813586386
epoch 22 train loss: 1211.599, val loss: 462.813, train acc: 0.982, val acc: 0.973
diff 71.81658949549478
epoch 23 train loss: 1432.217, val loss: 426.561, train acc: 0.978, val acc: 0.974
diff 36.25155345285668
epoch 24 train loss: 1371.868, val loss: 304.115, train acc: 0.980, val acc: 0.978
diff 122.44652121663324
epoch 25 train loss: 1265.333, val loss: 301.310, train acc: 0.981, val acc: 0.980
diff 2.804649892971952
epoch 26 train loss: 1221.358, val loss: 345.913, train acc: 0.983, val acc: 0.974
diff 44.60262156134212
epoch 27 train loss: 1095.569, val loss: 639.114, train acc: 0.984, val acc: 0.962
diff 293.2009536782947
epoch 28 train loss: 1207.650, val loss: 485.939, train acc: 0.982, val acc: 0.977
diff 153.17488446685775
epoch 29 train loss: 1182.034, val loss: 324.823, train acc: 0.983, val acc: 0.980
diff 161.11550890890402
epoch 30 train loss: 1218.254, val loss: 538.673, train acc: 0.982, val acc: 0.973
diff 213.84923841462813
training representation using icarl loss
training representation using icarl loss
training representation using icarl loss
training representation using icarl loss
