Using CPU
Running experiment mnist:
Results are stored in: random_new_architecture_low_threshold/mnist
with hyperparameters {'p': 0.9, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.001, 'random_seed': 4, 'class_balanced': True, 'max_data_size': 6000, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 6346.257, val loss: 524.697, train acc: 0.908, val acc: 0.932
diff inf
epoch 2 train loss: 3526.833, val loss: 352.165, train acc: 0.948, val acc: 0.957
diff 172.53181481284304
epoch 3 train loss: 2853.400, val loss: 356.926, train acc: 0.959, val acc: 0.956
diff 4.761417214120911
epoch 4 train loss: 2357.192, val loss: 298.681, train acc: 0.966, val acc: 0.968
diff 58.244707854412354
epoch 5 train loss: 2048.086, val loss: 315.725, train acc: 0.971, val acc: 0.963
diff 17.043988375709716
epoch 6 train loss: 1850.673, val loss: 359.747, train acc: 0.973, val acc: 0.968
diff 44.02180887088798
epoch 7 train loss: 1741.574, val loss: 356.018, train acc: 0.974, val acc: 0.960
diff 3.729557415687907
epoch 8 train loss: 1673.385, val loss: 316.747, train acc: 0.976, val acc: 0.966
diff 39.27058034856515
epoch 9 train loss: 1471.840, val loss: 284.985, train acc: 0.979, val acc: 0.974
diff 31.76194097323804
epoch 10 train loss: 1531.501, val loss: 295.490, train acc: 0.979, val acc: 0.974
diff 10.505207275188525
epoch 11 train loss: 1224.543, val loss: 341.147, train acc: 0.982, val acc: 0.973
diff 45.6566016502415
epoch 12 train loss: 1240.388, val loss: 398.917, train acc: 0.981, val acc: 0.965
diff 57.76951407069356
epoch 13 train loss: 1212.409, val loss: 379.070, train acc: 0.982, val acc: 0.972
diff 19.846723325450796
epoch 14 train loss: 1292.740, val loss: 342.477, train acc: 0.982, val acc: 0.970
diff 36.59276563676207
epoch 15 train loss: 1072.005, val loss: 320.578, train acc: 0.984, val acc: 0.970
diff 21.898870412607778
epoch 16 train loss: 1071.659, val loss: 363.456, train acc: 0.985, val acc: 0.971
diff 42.878034418912534
epoch 17 train loss: 1035.882, val loss: 354.481, train acc: 0.984, val acc: 0.969
diff 8.974939940417812
epoch 18 train loss: 1096.481, val loss: 453.749, train acc: 0.985, val acc: 0.964
diff 99.26749143898132
epoch 19 train loss: 1050.807, val loss: 490.040, train acc: 0.986, val acc: 0.958
diff 36.29114551047667
epoch 20 train loss: 836.123, val loss: 465.786, train acc: 0.988, val acc: 0.966
diff 24.25389968512917
epoch 21 train loss: 1070.807, val loss: 458.245, train acc: 0.986, val acc: 0.968
diff 7.541428992910767
epoch 22 train loss: 981.378, val loss: 548.052, train acc: 0.988, val acc: 0.968
diff 89.80742186202798
epoch 23 train loss: 948.288, val loss: 396.682, train acc: 0.987, val acc: 0.973
diff 151.3697100898549
epoch 24 train loss: 951.577, val loss: 439.052, train acc: 0.988, val acc: 0.971
diff 42.36961184039359
epoch 25 train loss: 876.708, val loss: 562.593, train acc: 0.988, val acc: 0.964
diff 123.54067614582095
epoch 26 train loss: 845.559, val loss: 371.951, train acc: 0.989, val acc: 0.978
diff 190.64197092881045
epoch 27 train loss: 805.899, val loss: 618.872, train acc: 0.990, val acc: 0.966
diff 246.92146520673987
epoch 28 train loss: 781.318, val loss: 562.027, train acc: 0.990, val acc: 0.969
diff 56.845230255657384
epoch 29 train loss: 773.377, val loss: 468.716, train acc: 0.989, val acc: 0.969
diff 93.31110017140116
epoch 30 train loss: 761.449, val loss: 544.143, train acc: 0.990, val acc: 0.971
diff 75.4272536615594
Training model M2
epoch 1 train loss: 11123.883, val loss: 762.668, train acc: 0.871, val acc: 0.925
diff inf
epoch 2 train loss: 6305.916, val loss: 667.822, train acc: 0.928, val acc: 0.931
diff 94.84616058711913
epoch 3 train loss: 5148.517, val loss: 637.993, train acc: 0.942, val acc: 0.934
diff 29.82843260923198
epoch 4 train loss: 4493.907, val loss: 540.583, train acc: 0.949, val acc: 0.950
diff 97.41014899651441
epoch 5 train loss: 4025.675, val loss: 657.915, train acc: 0.953, val acc: 0.937
diff 117.33157922845271
epoch 6 train loss: 3738.128, val loss: 504.705, train acc: 0.956, val acc: 0.955
diff 153.20929497857333
epoch 7 train loss: 3413.753, val loss: 532.016, train acc: 0.960, val acc: 0.952
diff 27.310398091791058
epoch 8 train loss: 3026.509, val loss: 579.174, train acc: 0.965, val acc: 0.952
diff 47.15832488181832
epoch 9 train loss: 3043.579, val loss: 728.916, train acc: 0.965, val acc: 0.940
diff 149.74221571013197
epoch 10 train loss: 2872.319, val loss: 511.234, train acc: 0.967, val acc: 0.963
diff 217.68185210505186
epoch 11 train loss: 2587.671, val loss: 652.968, train acc: 0.970, val acc: 0.946
diff 141.73371758726972
epoch 12 train loss: 2577.901, val loss: 799.169, train acc: 0.970, val acc: 0.944
diff 146.20086250159898
epoch 13 train loss: 2522.917, val loss: 649.404, train acc: 0.971, val acc: 0.949
diff 149.7654382675978
epoch 14 train loss: 2458.581, val loss: 679.937, train acc: 0.972, val acc: 0.956
diff 30.533867535537524
epoch 15 train loss: 2245.019, val loss: 713.346, train acc: 0.974, val acc: 0.953
diff 33.408628930278496
epoch 16 train loss: 2380.093, val loss: 588.847, train acc: 0.973, val acc: 0.957
diff 124.49952576976955
epoch 17 train loss: 2132.756, val loss: 857.750, train acc: 0.975, val acc: 0.948
diff 268.90321267862544
epoch 18 train loss: 2150.530, val loss: 1003.410, train acc: 0.976, val acc: 0.938
diff 145.66035476662887
epoch 19 train loss: 2275.186, val loss: 736.736, train acc: 0.974, val acc: 0.948
diff 266.674448782112
epoch 20 train loss: 1971.111, val loss: 647.376, train acc: 0.977, val acc: 0.958
diff 89.35960751051368
epoch 21 train loss: 2145.082, val loss: 632.811, train acc: 0.977, val acc: 0.960
diff 14.565510568949776
epoch 22 train loss: 1979.613, val loss: 692.642, train acc: 0.978, val acc: 0.957
diff 59.831536745494645
epoch 23 train loss: 1897.390, val loss: 660.168, train acc: 0.979, val acc: 0.956
diff 32.47400934556845
epoch 24 train loss: 1895.000, val loss: 691.891, train acc: 0.980, val acc: 0.960
diff 31.722507128970165
epoch 25 train loss: 1805.027, val loss: 828.354, train acc: 0.980, val acc: 0.953
diff 136.4632430613475
epoch 26 train loss: 1819.487, val loss: 941.818, train acc: 0.981, val acc: 0.951
diff 113.46415362483515
epoch 27 train loss: 1718.922, val loss: 796.149, train acc: 0.982, val acc: 0.950
diff 145.66882876707655
epoch 28 train loss: 1832.299, val loss: 742.646, train acc: 0.980, val acc: 0.961
diff 53.50296589737047
epoch 29 train loss: 1842.423, val loss: 829.988, train acc: 0.981, val acc: 0.958
diff 87.34142011851827
epoch 30 train loss: 1939.607, val loss: 1050.431, train acc: 0.980, val acc: 0.954
diff 220.44375767260806
Training model M3
epoch 1 train loss: 11246.384, val loss: 784.408, train acc: 0.870, val acc: 0.922
diff inf
epoch 2 train loss: 6369.356, val loss: 542.440, train acc: 0.927, val acc: 0.945
diff 241.9675622404784
epoch 3 train loss: 5193.808, val loss: 553.710, train acc: 0.941, val acc: 0.937
diff 11.27008739077155
epoch 4 train loss: 4377.955, val loss: 464.125, train acc: 0.951, val acc: 0.957
diff 89.5855681729144
epoch 5 train loss: 4018.775, val loss: 396.037, train acc: 0.953, val acc: 0.963
diff 68.08741459063287
epoch 6 train loss: 3702.996, val loss: 452.640, train acc: 0.958, val acc: 0.953
diff 56.602956331876385
epoch 7 train loss: 3300.944, val loss: 337.587, train acc: 0.963, val acc: 0.966
diff 115.05317578547897
epoch 8 train loss: 3228.934, val loss: 262.330, train acc: 0.963, val acc: 0.974
diff 75.25732815247727
epoch 9 train loss: 2920.642, val loss: 272.358, train acc: 0.966, val acc: 0.973
diff 10.028338468568734
epoch 10 train loss: 2706.986, val loss: 319.214, train acc: 0.969, val acc: 0.969
diff 46.85585837665258
epoch 11 train loss: 2675.499, val loss: 289.223, train acc: 0.969, val acc: 0.969
diff 29.991268459401567
epoch 12 train loss: 2548.160, val loss: 281.534, train acc: 0.971, val acc: 0.975
diff 7.688462788353263
epoch 13 train loss: 2457.875, val loss: 330.378, train acc: 0.972, val acc: 0.971
diff 48.84429860077688
epoch 14 train loss: 2366.613, val loss: 255.042, train acc: 0.973, val acc: 0.977
diff 75.33671423241486
epoch 15 train loss: 2343.904, val loss: 237.015, train acc: 0.973, val acc: 0.977
diff 18.026641464377462
epoch 16 train loss: 2159.065, val loss: 226.846, train acc: 0.975, val acc: 0.980
diff 10.169195752433524
epoch 17 train loss: 2305.129, val loss: 360.383, train acc: 0.973, val acc: 0.965
diff 133.53691253216104
epoch 18 train loss: 2188.202, val loss: 209.014, train acc: 0.976, val acc: 0.981
diff 151.36860576839683
epoch 19 train loss: 2059.451, val loss: 323.510, train acc: 0.977, val acc: 0.974
diff 114.49615026699223
epoch 20 train loss: 1942.621, val loss: 406.810, train acc: 0.980, val acc: 0.967
diff 83.29982335462432
epoch 21 train loss: 2163.808, val loss: 394.639, train acc: 0.977, val acc: 0.967
diff 12.171290863933052
epoch 22 train loss: 1901.548, val loss: 356.599, train acc: 0.980, val acc: 0.972
diff 38.03937536463218
epoch 23 train loss: 1955.241, val loss: 357.331, train acc: 0.979, val acc: 0.973
diff 0.7316420563707311
epoch 24 train loss: 1982.534, val loss: 310.076, train acc: 0.979, val acc: 0.970
diff 47.25463915974683
epoch 25 train loss: 1876.957, val loss: 337.514, train acc: 0.980, val acc: 0.969
diff 27.43708307249392
epoch 26 train loss: 1773.447, val loss: 267.236, train acc: 0.980, val acc: 0.979
diff 70.27775707454657
epoch 27 train loss: 1950.706, val loss: 288.420, train acc: 0.980, val acc: 0.977
diff 21.184261047491532
epoch 28 train loss: 1729.440, val loss: 380.951, train acc: 0.982, val acc: 0.972
diff 92.53095143942056
epoch 29 train loss: 1730.344, val loss: 292.659, train acc: 0.982, val acc: 0.979
diff 88.29211179702969
epoch 30 train loss: 1700.231, val loss: 229.959, train acc: 0.982, val acc: 0.980
diff 62.700088670236795
Training model M3
epoch 1 train loss: 1907.308, val loss: 388.366, train acc: 0.983, val acc: 0.974
diff inf
epoch 2 train loss: 1707.398, val loss: 391.817, train acc: 0.983, val acc: 0.973
diff 3.4500455064716107
epoch 3 train loss: 1575.571, val loss: 571.080, train acc: 0.984, val acc: 0.971
diff 179.2635414107445
epoch 4 train loss: 1521.261, val loss: 617.404, train acc: 0.986, val acc: 0.962
diff 46.324085927354645
epoch 5 train loss: 1496.459, val loss: 468.164, train acc: 0.985, val acc: 0.977
diff 149.2402190754242
epoch 6 train loss: 1526.923, val loss: 626.091, train acc: 0.985, val acc: 0.968
diff 157.9274741460623
epoch 7 train loss: 1318.153, val loss: 528.960, train acc: 0.987, val acc: 0.972
diff 97.13168624138325
epoch 8 train loss: 1588.054, val loss: 776.236, train acc: 0.986, val acc: 0.959
diff 247.27585361739636
epoch 9 train loss: 1290.561, val loss: 634.405, train acc: 0.987, val acc: 0.965
diff 141.83067996475268
epoch 10 train loss: 1291.074, val loss: 657.355, train acc: 0.986, val acc: 0.972
diff 22.949865148406616
epoch 11 train loss: 1336.619, val loss: 808.319, train acc: 0.987, val acc: 0.970
diff 150.96449911466368
epoch 12 train loss: 1449.352, val loss: 787.483, train acc: 0.986, val acc: 0.969
diff 20.836431394709507
epoch 13 train loss: 1361.072, val loss: 787.799, train acc: 0.988, val acc: 0.966
diff 0.3160782245313385
epoch 14 train loss: 1536.076, val loss: 579.987, train acc: 0.986, val acc: 0.970
diff 207.81204659153366
epoch 15 train loss: 1152.534, val loss: 705.134, train acc: 0.989, val acc: 0.969
diff 125.1471760692516
epoch 16 train loss: 1081.742, val loss: 698.993, train acc: 0.989, val acc: 0.971
diff 6.141141171317258
epoch 17 train loss: 1443.888, val loss: 1029.067, train acc: 0.987, val acc: 0.966
diff 330.0742429125322
epoch 18 train loss: 1251.531, val loss: 991.058, train acc: 0.989, val acc: 0.967
diff 38.008774447827705
epoch 19 train loss: 1300.840, val loss: 1367.363, train acc: 0.989, val acc: 0.959
diff 376.304827072703
epoch 20 train loss: 1515.486, val loss: 967.022, train acc: 0.988, val acc: 0.962
diff 400.34130204615644
epoch 21 train loss: 1178.064, val loss: 809.492, train acc: 0.989, val acc: 0.971
diff 157.52964147182945
epoch 22 train loss: 1093.762, val loss: 1020.603, train acc: 0.991, val acc: 0.966
diff 211.11036382764996
epoch 23 train loss: 1340.708, val loss: 1019.128, train acc: 0.989, val acc: 0.963
diff 1.4747663478381128
epoch 24 train loss: 1139.101, val loss: 1170.924, train acc: 0.990, val acc: 0.962
diff 151.79619482960914
epoch 25 train loss: 1152.862, val loss: 1211.798, train acc: 0.991, val acc: 0.962
diff 40.87414638195878
epoch 26 train loss: 1505.498, val loss: 1093.446, train acc: 0.988, val acc: 0.972
diff 118.35199731160856
epoch 27 train loss: 1086.706, val loss: 1112.036, train acc: 0.991, val acc: 0.967
diff 18.589773632901142
epoch 28 train loss: 1445.625, val loss: 1251.156, train acc: 0.989, val acc: 0.955
diff 139.12045348762717
epoch 29 train loss: 1275.202, val loss: 1102.014, train acc: 0.990, val acc: 0.966
diff 149.1425336376342
epoch 30 train loss: 1040.635, val loss: 3266.151, train acc: 0.991, val acc: 0.913
diff 2164.1372516046354
Training model M3
epoch 1 train loss: 5886.216, val loss: 472.015, train acc: 0.971, val acc: 0.964
diff inf
epoch 2 train loss: 3286.895, val loss: 394.335, train acc: 0.976, val acc: 0.975
diff 77.68019093735404
epoch 3 train loss: 2837.767, val loss: 633.894, train acc: 0.978, val acc: 0.966
diff 239.55899230475666
epoch 4 train loss: 2213.227, val loss: 468.194, train acc: 0.981, val acc: 0.976
diff 165.69990243938167
epoch 5 train loss: 2400.625, val loss: 424.205, train acc: 0.980, val acc: 0.979
diff 43.98938151937415
epoch 6 train loss: 2138.834, val loss: 293.028, train acc: 0.982, val acc: 0.981
diff 131.1764087992629
epoch 7 train loss: 1966.151, val loss: 357.113, train acc: 0.983, val acc: 0.978
diff 64.08444164163137
epoch 8 train loss: 2046.233, val loss: 181.508, train acc: 0.982, val acc: 0.984
diff 175.60453646250238
epoch 9 train loss: 2096.883, val loss: 471.855, train acc: 0.982, val acc: 0.971
diff 290.3461500240853
epoch 10 train loss: 2084.589, val loss: 347.037, train acc: 0.982, val acc: 0.978
diff 124.81764356345775
epoch 11 train loss: 1874.093, val loss: 380.867, train acc: 0.984, val acc: 0.982
diff 33.82976928368896
epoch 12 train loss: 2131.339, val loss: 591.586, train acc: 0.982, val acc: 0.969
diff 210.71953725182203
epoch 13 train loss: 2031.056, val loss: 504.752, train acc: 0.982, val acc: 0.976
diff 86.83451497428723
epoch 14 train loss: 1953.933, val loss: 334.159, train acc: 0.984, val acc: 0.980
diff 170.59241761145904
epoch 15 train loss: 1509.470, val loss: 329.372, train acc: 0.986, val acc: 0.981
diff 4.787697143590549
epoch 16 train loss: 1841.370, val loss: 259.781, train acc: 0.984, val acc: 0.983
diff 69.59104959351782
epoch 17 train loss: 1696.595, val loss: 357.762, train acc: 0.985, val acc: 0.981
diff 97.98132566217225
epoch 18 train loss: 1769.017, val loss: 369.482, train acc: 0.986, val acc: 0.977
diff 11.72059683724325
epoch 19 train loss: 2000.726, val loss: 351.280, train acc: 0.985, val acc: 0.978
diff 18.202238221874325
epoch 20 train loss: 1542.468, val loss: 700.015, train acc: 0.986, val acc: 0.968
diff 348.7348667092391
epoch 21 train loss: 1900.863, val loss: 264.343, train acc: 0.985, val acc: 0.985
diff 435.67245437565765
epoch 22 train loss: 1718.584, val loss: 600.192, train acc: 0.987, val acc: 0.977
diff 335.84932232118007
epoch 23 train loss: 1690.948, val loss: 518.231, train acc: 0.986, val acc: 0.975
diff 81.9613874581081
epoch 24 train loss: 1614.659, val loss: 485.438, train acc: 0.986, val acc: 0.981
diff 32.79274086785256
epoch 25 train loss: 1770.690, val loss: 463.398, train acc: 0.986, val acc: 0.981
diff 22.039901175837826
epoch 26 train loss: 1679.905, val loss: 337.030, train acc: 0.987, val acc: 0.978
diff 126.36755532802232
epoch 27 train loss: 1609.485, val loss: 283.109, train acc: 0.987, val acc: 0.987
diff 53.92089181920994
epoch 28 train loss: 1419.951, val loss: 299.287, train acc: 0.988, val acc: 0.986
diff 16.177260856984162
epoch 29 train loss: 1826.431, val loss: 418.964, train acc: 0.986, val acc: 0.984
diff 119.67771465674667
epoch 30 train loss: 1495.966, val loss: 476.674, train acc: 0.988, val acc: 0.976
diff 57.70959557392689
training representation using icarl loss
training representation using icarl loss
