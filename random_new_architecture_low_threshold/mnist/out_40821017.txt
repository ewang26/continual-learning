Using CPU
Running experiment mnist:
Results are stored in: random_new_architecture_low_threshold/mnist
with hyperparameters {'p': 0.2, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.001, 'random_seed': 1, 'class_balanced': True, 'max_data_size': 6000, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 6372.800, val loss: 595.340, train acc: 0.907, val acc: 0.923
diff inf
epoch 2 train loss: 3612.034, val loss: 342.224, train acc: 0.949, val acc: 0.958
diff 253.11630836440912
epoch 3 train loss: 2827.761, val loss: 301.437, train acc: 0.958, val acc: 0.967
diff 40.786721637049084
epoch 4 train loss: 2412.087, val loss: 372.647, train acc: 0.965, val acc: 0.954
diff 71.21025445538766
epoch 5 train loss: 2195.649, val loss: 269.439, train acc: 0.968, val acc: 0.969
diff 103.20838576951382
epoch 6 train loss: 1874.679, val loss: 386.547, train acc: 0.973, val acc: 0.963
diff 117.10808481871061
epoch 7 train loss: 1769.282, val loss: 354.835, train acc: 0.974, val acc: 0.963
diff 31.71221579150364
epoch 8 train loss: 1660.265, val loss: 308.048, train acc: 0.976, val acc: 0.972
diff 46.786191989307326
epoch 9 train loss: 1541.527, val loss: 293.325, train acc: 0.978, val acc: 0.971
diff 14.723507406319186
epoch 10 train loss: 1397.296, val loss: 362.009, train acc: 0.979, val acc: 0.968
diff 68.68409299838805
epoch 11 train loss: 1424.914, val loss: 324.305, train acc: 0.979, val acc: 0.965
diff 37.70370366342081
epoch 12 train loss: 1361.551, val loss: 270.491, train acc: 0.980, val acc: 0.975
diff 53.81479405715754
epoch 13 train loss: 1349.623, val loss: 347.629, train acc: 0.981, val acc: 0.966
diff 77.13863978547192
epoch 14 train loss: 1096.996, val loss: 504.107, train acc: 0.983, val acc: 0.960
diff 156.47730542930833
epoch 15 train loss: 1246.715, val loss: 341.399, train acc: 0.982, val acc: 0.972
diff 162.70705718150964
epoch 16 train loss: 1082.788, val loss: 390.503, train acc: 0.984, val acc: 0.964
diff 49.10316923986636
epoch 17 train loss: 1154.129, val loss: 386.796, train acc: 0.983, val acc: 0.968
diff 3.7070824222886927
epoch 18 train loss: 1033.966, val loss: 502.001, train acc: 0.984, val acc: 0.969
diff 115.20510537397575
epoch 19 train loss: 1078.563, val loss: 411.805, train acc: 0.986, val acc: 0.965
diff 90.19551131443086
epoch 20 train loss: 1042.866, val loss: 493.285, train acc: 0.985, val acc: 0.961
diff 81.47997488948744
epoch 21 train loss: 1130.040, val loss: 491.422, train acc: 0.985, val acc: 0.964
diff 1.8628662369216613
epoch 22 train loss: 1042.324, val loss: 365.336, train acc: 0.985, val acc: 0.976
diff 126.08642874054186
epoch 23 train loss: 824.409, val loss: 460.459, train acc: 0.989, val acc: 0.965
diff 95.12295834160903
epoch 24 train loss: 1040.852, val loss: 388.029, train acc: 0.986, val acc: 0.975
diff 72.43003595586663
epoch 25 train loss: 899.864, val loss: 505.985, train acc: 0.988, val acc: 0.964
diff 117.95664994457195
epoch 26 train loss: 873.826, val loss: 413.386, train acc: 0.988, val acc: 0.968
diff 92.59901952576553
epoch 27 train loss: 1007.220, val loss: 484.668, train acc: 0.988, val acc: 0.971
diff 71.28193592066174
epoch 28 train loss: 862.806, val loss: 488.865, train acc: 0.988, val acc: 0.971
diff 4.196895371578194
epoch 29 train loss: 904.769, val loss: 398.186, train acc: 0.989, val acc: 0.974
diff 90.67877577677143
epoch 30 train loss: 700.103, val loss: 388.322, train acc: 0.990, val acc: 0.979
diff 9.864852594786214
Training model M2
epoch 1 train loss: 11219.902, val loss: 808.624, train acc: 0.869, val acc: 0.920
diff inf
epoch 2 train loss: 6357.246, val loss: 668.495, train acc: 0.927, val acc: 0.928
diff 140.12869321741732
epoch 3 train loss: 5387.568, val loss: 498.881, train acc: 0.939, val acc: 0.950
diff 169.6140738455694
epoch 4 train loss: 4504.745, val loss: 510.582, train acc: 0.949, val acc: 0.947
diff 11.700669552416173
epoch 5 train loss: 4157.476, val loss: 476.799, train acc: 0.954, val acc: 0.951
diff 33.7822862480088
epoch 6 train loss: 3800.633, val loss: 480.654, train acc: 0.958, val acc: 0.953
diff 3.8542586164947465
epoch 7 train loss: 3622.170, val loss: 514.697, train acc: 0.958, val acc: 0.955
diff 34.04346492309264
epoch 8 train loss: 3429.363, val loss: 683.594, train acc: 0.961, val acc: 0.934
diff 168.89676848352065
epoch 9 train loss: 3276.268, val loss: 480.837, train acc: 0.963, val acc: 0.958
diff 202.75701701877892
epoch 10 train loss: 2879.669, val loss: 707.969, train acc: 0.967, val acc: 0.936
diff 227.13228080774684
epoch 11 train loss: 2785.342, val loss: 478.755, train acc: 0.967, val acc: 0.956
diff 229.21415936092706
epoch 12 train loss: 2846.880, val loss: 700.972, train acc: 0.968, val acc: 0.944
diff 222.21669577795376
epoch 13 train loss: 2686.292, val loss: 528.980, train acc: 0.970, val acc: 0.957
diff 171.9914653554623
epoch 14 train loss: 2427.450, val loss: 597.987, train acc: 0.972, val acc: 0.955
diff 69.00631431535032
epoch 15 train loss: 2535.035, val loss: 556.457, train acc: 0.972, val acc: 0.961
diff 41.52949481832968
epoch 16 train loss: 2332.286, val loss: 572.263, train acc: 0.973, val acc: 0.961
diff 15.806318231973137
epoch 17 train loss: 2170.122, val loss: 715.459, train acc: 0.975, val acc: 0.952
diff 143.19535985489438
epoch 18 train loss: 2204.885, val loss: 764.775, train acc: 0.976, val acc: 0.951
diff 49.316045572917346
epoch 19 train loss: 2183.606, val loss: 712.716, train acc: 0.975, val acc: 0.954
diff 52.058976531658914
epoch 20 train loss: 2165.573, val loss: 618.017, train acc: 0.976, val acc: 0.961
diff 94.69912422100606
epoch 21 train loss: 1978.973, val loss: 666.167, train acc: 0.977, val acc: 0.960
diff 48.14983380868671
epoch 22 train loss: 1990.814, val loss: 673.903, train acc: 0.978, val acc: 0.953
diff 7.736262868782546
epoch 23 train loss: 2176.843, val loss: 643.730, train acc: 0.977, val acc: 0.955
diff 30.173288987436763
epoch 24 train loss: 1924.334, val loss: 794.368, train acc: 0.978, val acc: 0.955
diff 150.6384703043085
epoch 25 train loss: 2030.594, val loss: 630.751, train acc: 0.978, val acc: 0.957
diff 163.6166480167086
epoch 26 train loss: 1840.452, val loss: 726.796, train acc: 0.979, val acc: 0.958
diff 96.0443224448129
epoch 27 train loss: 1898.279, val loss: 736.220, train acc: 0.980, val acc: 0.964
diff 9.423942251262133
epoch 28 train loss: 1830.364, val loss: 639.133, train acc: 0.981, val acc: 0.960
diff 97.0862138395189
epoch 29 train loss: 1983.231, val loss: 889.909, train acc: 0.979, val acc: 0.950
diff 250.77520819820984
epoch 30 train loss: 1858.447, val loss: 831.463, train acc: 0.980, val acc: 0.958
diff 58.44602216405099
Training model M3
epoch 1 train loss: 5608.589, val loss: 1319.693, train acc: 0.826, val acc: 0.860
diff inf
epoch 2 train loss: 3191.105, val loss: 1042.257, train acc: 0.902, val acc: 0.896
diff 277.43585290617784
epoch 3 train loss: 2507.483, val loss: 848.164, train acc: 0.922, val acc: 0.914
diff 194.09341208693047
epoch 4 train loss: 2137.337, val loss: 694.442, train acc: 0.930, val acc: 0.935
diff 153.72242803736515
epoch 5 train loss: 1689.040, val loss: 858.209, train acc: 0.946, val acc: 0.919
diff 163.76736630324933
epoch 6 train loss: 1637.583, val loss: 856.159, train acc: 0.949, val acc: 0.918
diff 2.0498891161025767
epoch 7 train loss: 1385.850, val loss: 743.202, train acc: 0.957, val acc: 0.928
diff 112.95666597124762
epoch 8 train loss: 1267.671, val loss: 692.941, train acc: 0.961, val acc: 0.936
diff 50.261218981633306
epoch 9 train loss: 1272.644, val loss: 840.090, train acc: 0.957, val acc: 0.929
diff 147.14891497134147
epoch 10 train loss: 1129.615, val loss: 755.552, train acc: 0.964, val acc: 0.934
diff 84.53810933911814
epoch 11 train loss: 971.481, val loss: 827.780, train acc: 0.970, val acc: 0.935
diff 72.22754402027442
epoch 12 train loss: 930.441, val loss: 778.774, train acc: 0.970, val acc: 0.938
diff 49.005818525684504
epoch 13 train loss: 1008.901, val loss: 1093.243, train acc: 0.969, val acc: 0.910
diff 314.4692011910922
epoch 14 train loss: 801.470, val loss: 962.322, train acc: 0.975, val acc: 0.930
diff 130.92124980645656
epoch 15 train loss: 842.691, val loss: 1074.107, train acc: 0.972, val acc: 0.916
diff 111.78514678356316
epoch 16 train loss: 716.155, val loss: 1105.124, train acc: 0.977, val acc: 0.923
diff 31.017018262797365
epoch 17 train loss: 654.565, val loss: 1092.618, train acc: 0.979, val acc: 0.919
diff 12.505839615567538
epoch 18 train loss: 654.296, val loss: 1148.623, train acc: 0.979, val acc: 0.920
diff 56.004740234290466
epoch 19 train loss: 841.992, val loss: 970.446, train acc: 0.973, val acc: 0.943
diff 178.1763709013876
epoch 20 train loss: 545.221, val loss: 848.902, train acc: 0.983, val acc: 0.944
diff 121.54449917148168
epoch 21 train loss: 717.061, val loss: 955.343, train acc: 0.978, val acc: 0.940
diff 106.44146856317138
epoch 22 train loss: 488.291, val loss: 1091.727, train acc: 0.983, val acc: 0.931
diff 136.38336719159793
epoch 23 train loss: 604.559, val loss: 947.919, train acc: 0.982, val acc: 0.944
diff 143.8080059097938
epoch 24 train loss: 435.939, val loss: 1293.733, train acc: 0.985, val acc: 0.925
diff 345.8142502280825
epoch 25 train loss: 635.632, val loss: 1055.637, train acc: 0.980, val acc: 0.944
diff 238.09589603463223
epoch 26 train loss: 385.430, val loss: 939.518, train acc: 0.988, val acc: 0.952
diff 116.11911421098057
epoch 27 train loss: 622.348, val loss: 1178.229, train acc: 0.982, val acc: 0.939
diff 238.71069781224583
epoch 28 train loss: 440.168, val loss: 1186.186, train acc: 0.987, val acc: 0.951
diff 7.957727858490443
epoch 29 train loss: 583.618, val loss: 1142.646, train acc: 0.983, val acc: 0.947
diff 43.54039861064598
epoch 30 train loss: 484.035, val loss: 909.267, train acc: 0.986, val acc: 0.949
diff 233.37940054376247
Training model M3
epoch 1 train loss: 554.409, val loss: 2394.391, train acc: 0.986, val acc: 0.899
diff inf
epoch 2 train loss: 295.000, val loss: 2284.411, train acc: 0.993, val acc: 0.915
diff 109.9799250663259
epoch 3 train loss: 402.821, val loss: 2261.716, train acc: 0.990, val acc: 0.910
diff 22.69498116175737
epoch 4 train loss: 346.798, val loss: 2453.208, train acc: 0.993, val acc: 0.895
diff 191.49226422263473
epoch 5 train loss: 343.778, val loss: 2205.857, train acc: 0.991, val acc: 0.914
diff 247.35088673411792
epoch 6 train loss: 190.987, val loss: 2300.510, train acc: 0.995, val acc: 0.909
diff 94.65254348020153
epoch 7 train loss: 445.084, val loss: 2921.804, train acc: 0.989, val acc: 0.892
diff 621.2946260195304
epoch 8 train loss: 161.514, val loss: 3503.156, train acc: 0.996, val acc: 0.887
diff 581.351936118976
epoch 9 train loss: 306.346, val loss: 3970.903, train acc: 0.991, val acc: 0.879
diff 467.74711701242086
epoch 10 train loss: 222.360, val loss: 3826.346, train acc: 0.995, val acc: 0.877
diff 144.5569171173438
epoch 11 train loss: 366.940, val loss: 5475.218, train acc: 0.992, val acc: 0.844
diff 1648.871734366297
epoch 12 train loss: 183.533, val loss: 3806.092, train acc: 0.995, val acc: 0.894
diff 1669.1261826130858
epoch 13 train loss: 262.472, val loss: 4715.874, train acc: 0.994, val acc: 0.865
diff 909.7821778837733
epoch 14 train loss: 322.705, val loss: 4481.251, train acc: 0.992, val acc: 0.871
diff 234.62335303762848
