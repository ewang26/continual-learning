Using CPU
Running experiment mnist:
Results are stored in: experiment_cpu/mnist
with hyperparameters {'p': 0.01, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 0, 'class_balanced': True, 'max_data_size': 500, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 821.071, val loss: 44.597, train acc: 0.849, val acc: 0.945
diff inf
epoch 2 train loss: 181.741, val loss: 67.523, train acc: 0.968, val acc: 0.915
diff 22.92568313413502
epoch 3 train loss: 87.270, val loss: 54.659, train acc: 0.982, val acc: 0.940
diff 12.863422493772198
epoch 4 train loss: 29.384, val loss: 24.121, train acc: 0.997, val acc: 0.965
diff 30.53806665805496
epoch 5 train loss: 16.249, val loss: 30.226, train acc: 0.997, val acc: 0.955
diff 6.10428861953762
epoch 6 train loss: 3.492, val loss: 31.518, train acc: 1.000, val acc: 0.960
diff 1.2922433099691304
epoch 7 train loss: 0.572, val loss: 30.886, train acc: 1.000, val acc: 0.960
diff 0.6321428986964328
epoch 8 train loss: 0.290, val loss: 31.023, train acc: 1.000, val acc: 0.960
diff 0.13734987357892692
epoch 9 train loss: 0.205, val loss: 32.133, train acc: 1.000, val acc: 0.960
diff 1.109700627127932
epoch 10 train loss: 0.153, val loss: 32.951, train acc: 1.000, val acc: 0.960
diff 0.8179017484399438
epoch 11 train loss: 0.122, val loss: 33.902, train acc: 1.000, val acc: 0.960
diff 0.9516544097840978
epoch 12 train loss: 0.099, val loss: 34.460, train acc: 1.000, val acc: 0.960
diff 0.5580517457065994
epoch 13 train loss: 0.083, val loss: 34.960, train acc: 1.000, val acc: 0.960
diff 0.4996694479239494
epoch 14 train loss: 0.069, val loss: 35.487, train acc: 1.000, val acc: 0.960
diff 0.5268342719079513
epoch 15 train loss: 0.058, val loss: 36.154, train acc: 1.000, val acc: 0.960
diff 0.6670585721714417
epoch 16 train loss: 0.050, val loss: 36.330, train acc: 1.000, val acc: 0.960
diff 0.1762460537937045
epoch 17 train loss: 0.043, val loss: 37.125, train acc: 1.000, val acc: 0.960
diff 0.794569013099462
epoch 18 train loss: 0.037, val loss: 37.239, train acc: 1.000, val acc: 0.960
diff 0.11438877289612037
epoch 19 train loss: 0.033, val loss: 38.003, train acc: 1.000, val acc: 0.960
diff 0.763662031185298
epoch 20 train loss: 0.029, val loss: 38.194, train acc: 1.000, val acc: 0.960
diff 0.1907559239909915
epoch 21 train loss: 0.025, val loss: 38.936, train acc: 1.000, val acc: 0.960
diff 0.7424030388565512
epoch 22 train loss: 0.022, val loss: 39.367, train acc: 1.000, val acc: 0.960
diff 0.4312719563726617
epoch 23 train loss: 0.019, val loss: 39.428, train acc: 1.000, val acc: 0.960
diff 0.06041286157457648
Training model M2
epoch 1 train loss: 1211.053, val loss: 83.002, train acc: 0.821, val acc: 0.892
diff inf
epoch 2 train loss: 282.802, val loss: 53.739, train acc: 0.964, val acc: 0.948
diff 29.263187214102523
epoch 3 train loss: 145.881, val loss: 89.543, train acc: 0.979, val acc: 0.900
diff 35.803971515494304
epoch 4 train loss: 55.095, val loss: 59.636, train acc: 0.992, val acc: 0.952
diff 29.906696988146564
epoch 5 train loss: 28.058, val loss: 84.889, train acc: 0.996, val acc: 0.944
diff 25.253249583299166
epoch 6 train loss: 81.533, val loss: 83.483, train acc: 0.987, val acc: 0.924
diff 1.405971154310933
epoch 7 train loss: 34.277, val loss: 84.691, train acc: 0.997, val acc: 0.932
diff 1.2078330510402253
epoch 8 train loss: 23.750, val loss: 70.980, train acc: 0.999, val acc: 0.948
diff 13.710855142478607
epoch 9 train loss: 9.869, val loss: 71.239, train acc: 0.999, val acc: 0.944
diff 0.2589955568885216
epoch 10 train loss: 0.501, val loss: 73.690, train acc: 1.000, val acc: 0.944
diff 2.451026726084109
epoch 11 train loss: 0.256, val loss: 73.865, train acc: 1.000, val acc: 0.944
diff 0.17476861586808923
epoch 12 train loss: 0.179, val loss: 75.687, train acc: 1.000, val acc: 0.944
diff 1.8217713603905992
epoch 13 train loss: 0.137, val loss: 77.238, train acc: 1.000, val acc: 0.944
diff 1.5513845956872387
epoch 14 train loss: 0.109, val loss: 78.342, train acc: 1.000, val acc: 0.944
diff 1.104001157913899
epoch 15 train loss: 0.089, val loss: 79.430, train acc: 1.000, val acc: 0.944
diff 1.0883021531048485
epoch 16 train loss: 0.073, val loss: 80.615, train acc: 1.000, val acc: 0.944
diff 1.1847408172221066
epoch 17 train loss: 0.061, val loss: 81.799, train acc: 1.000, val acc: 0.944
diff 1.1836556264889992
epoch 18 train loss: 0.052, val loss: 82.906, train acc: 1.000, val acc: 0.944
diff 1.1076183730515794
epoch 19 train loss: 0.044, val loss: 83.851, train acc: 1.000, val acc: 0.944
diff 0.9441321602239015
epoch 20 train loss: 0.038, val loss: 85.086, train acc: 1.000, val acc: 0.944
diff 1.2358047549731594
epoch 21 train loss: 0.032, val loss: 86.104, train acc: 1.000, val acc: 0.944
diff 1.0178511763357676
epoch 22 train loss: 0.028, val loss: 87.071, train acc: 1.000, val acc: 0.944
diff 0.9668567571899729
epoch 23 train loss: 0.024, val loss: 87.934, train acc: 1.000, val acc: 0.944
diff 0.8624097917494566
epoch 24 train loss: 0.021, val loss: 88.878, train acc: 1.000, val acc: 0.944
diff 0.9442852981769221
epoch 25 train loss: 0.018, val loss: 90.056, train acc: 1.000, val acc: 0.944
diff 1.178022280984095
epoch 26 train loss: 0.016, val loss: 91.022, train acc: 1.000, val acc: 0.944
diff 0.9664954449855969
epoch 27 train loss: 0.014, val loss: 91.763, train acc: 1.000, val acc: 0.944
diff 0.7401645678055502
epoch 28 train loss: 0.012, val loss: 92.787, train acc: 1.000, val acc: 0.944
diff 1.024526980766936
epoch 29 train loss: 0.011, val loss: 93.818, train acc: 1.000, val acc: 0.944
diff 1.0310914158242355
epoch 30 train loss: 0.009, val loss: 94.842, train acc: 1.000, val acc: 0.944
diff 1.0241045457956375
Training model M3
epoch 1 train loss: 267.545, val loss: 1001.635, train acc: 0.828, val acc: 0.188
diff inf
epoch 2 train loss: 83.686, val loss: 763.309, train acc: 0.957, val acc: 0.192
diff 238.32634424349465
epoch 3 train loss: 42.466, val loss: 736.255, train acc: 0.966, val acc: 0.312
diff 27.05305999856546
epoch 4 train loss: 12.601, val loss: 698.471, train acc: 0.991, val acc: 0.440
diff 37.784299513371366
epoch 5 train loss: 7.450, val loss: 699.020, train acc: 0.994, val acc: 0.424
diff 0.5484357543074339
epoch 6 train loss: 3.045, val loss: 1086.133, train acc: 1.000, val acc: 0.372
diff 387.1134042573391
epoch 7 train loss: 0.558, val loss: 1051.562, train acc: 1.000, val acc: 0.384
diff 34.571365633080404
epoch 8 train loss: 0.285, val loss: 1050.253, train acc: 1.000, val acc: 0.388
diff 1.3088754513053118
epoch 9 train loss: 0.201, val loss: 1105.824, train acc: 1.000, val acc: 0.376
diff 55.57101292818902
epoch 10 train loss: 0.157, val loss: 1127.798, train acc: 1.000, val acc: 0.384
diff 21.974693608849975
epoch 11 train loss: 0.126, val loss: 1153.168, train acc: 1.000, val acc: 0.388
diff 25.369691535029006
epoch 12 train loss: 0.101, val loss: 1176.199, train acc: 1.000, val acc: 0.380
diff 23.031206742765335
epoch 13 train loss: 0.088, val loss: 1190.672, train acc: 1.000, val acc: 0.380
diff 14.47231456474924
epoch 14 train loss: 0.075, val loss: 1208.168, train acc: 1.000, val acc: 0.380
diff 17.496270600532625
epoch 15 train loss: 0.065, val loss: 1219.807, train acc: 1.000, val acc: 0.380
diff 11.63894511445369
epoch 16 train loss: 0.057, val loss: 1234.096, train acc: 1.000, val acc: 0.384
diff 14.289337447398566
epoch 17 train loss: 0.051, val loss: 1244.786, train acc: 1.000, val acc: 0.388
diff 10.690092094951524
epoch 18 train loss: 0.046, val loss: 1256.864, train acc: 1.000, val acc: 0.388
diff 12.077784481474055
epoch 19 train loss: 0.041, val loss: 1269.972, train acc: 1.000, val acc: 0.388
diff 13.10790532929991
epoch 20 train loss: 0.037, val loss: 1278.771, train acc: 1.000, val acc: 0.392
diff 8.799460332772242
epoch 21 train loss: 0.034, val loss: 1287.110, train acc: 1.000, val acc: 0.396
diff 8.338447350252636
epoch 22 train loss: 0.031, val loss: 1302.509, train acc: 1.000, val acc: 0.396
diff 15.398636147002208
epoch 23 train loss: 0.028, val loss: 1308.420, train acc: 1.000, val acc: 0.396
diff 5.911132512603444
epoch 24 train loss: 0.026, val loss: 1316.925, train acc: 1.000, val acc: 0.392
diff 8.505240480387101
epoch 25 train loss: 0.023, val loss: 1326.844, train acc: 1.000, val acc: 0.396
diff 9.918614429099534
epoch 26 train loss: 0.022, val loss: 1335.269, train acc: 1.000, val acc: 0.392
diff 8.42585486517578
epoch 27 train loss: 0.020, val loss: 1342.587, train acc: 1.000, val acc: 0.392
diff 7.317083451015833
epoch 28 train loss: 0.019, val loss: 1349.983, train acc: 1.000, val acc: 0.392
diff 7.3963078112294625
epoch 29 train loss: 0.017, val loss: 1354.836, train acc: 1.000, val acc: 0.396
diff 4.853276832520123
epoch 30 train loss: 0.016, val loss: 1363.414, train acc: 1.000, val acc: 0.392
diff 8.577565432158735
Training model M3
epoch 1 train loss: 63.116, val loss: 602.379, train acc: 0.976, val acc: 0.468
diff inf
epoch 2 train loss: 6.285, val loss: 727.591, train acc: 0.996, val acc: 0.500
diff 125.21141654215648
epoch 3 train loss: 0.759, val loss: 847.326, train acc: 1.000, val acc: 0.484
diff 119.73556889361942
epoch 4 train loss: 0.205, val loss: 883.567, train acc: 1.000, val acc: 0.476
diff 36.24079301195832
epoch 5 train loss: 0.134, val loss: 911.196, train acc: 1.000, val acc: 0.480
diff 27.628860426074084
epoch 6 train loss: 0.097, val loss: 929.654, train acc: 1.000, val acc: 0.484
diff 18.45843717771504
epoch 7 train loss: 0.072, val loss: 950.047, train acc: 1.000, val acc: 0.488
diff 20.392428625420735
epoch 8 train loss: 0.054, val loss: 985.631, train acc: 1.000, val acc: 0.488
diff 35.58452235469065
epoch 9 train loss: 0.041, val loss: 1014.231, train acc: 1.000, val acc: 0.484
diff 28.59976843800689
epoch 10 train loss: 0.031, val loss: 1054.228, train acc: 1.000, val acc: 0.492
diff 39.996981560710424
epoch 11 train loss: 0.025, val loss: 1064.702, train acc: 1.000, val acc: 0.500
diff 10.474479863679335
epoch 12 train loss: 0.019, val loss: 1101.238, train acc: 1.000, val acc: 0.504
diff 36.53553183881286
epoch 13 train loss: 0.016, val loss: 1088.092, train acc: 1.000, val acc: 0.492
diff 13.146066613476023
epoch 14 train loss: 0.012, val loss: 1105.658, train acc: 1.000, val acc: 0.504
diff 17.565598115707417
epoch 15 train loss: 0.010, val loss: 1149.874, train acc: 1.000, val acc: 0.504
diff 44.216419421206865
epoch 16 train loss: 0.008, val loss: 1153.338, train acc: 1.000, val acc: 0.508
diff 3.464236923395447
epoch 17 train loss: 0.007, val loss: 1170.372, train acc: 1.000, val acc: 0.512
diff 17.034192941403262
epoch 18 train loss: 0.006, val loss: 1182.999, train acc: 1.000, val acc: 0.508
diff 12.626899628846786
epoch 19 train loss: 0.005, val loss: 1197.943, train acc: 1.000, val acc: 0.508
diff 14.943437035833085
epoch 20 train loss: 0.004, val loss: 1208.347, train acc: 1.000, val acc: 0.500
diff 10.404308123371038
epoch 21 train loss: 0.004, val loss: 1238.653, train acc: 1.000, val acc: 0.496
diff 30.305636542494312
epoch 22 train loss: 0.003, val loss: 1239.194, train acc: 1.000, val acc: 0.500
diff 0.5414784904655789
epoch 23 train loss: 0.003, val loss: 1257.157, train acc: 1.000, val acc: 0.496
diff 17.9627857437913
epoch 24 train loss: 0.002, val loss: 1272.220, train acc: 1.000, val acc: 0.492
diff 15.062961505148905
epoch 25 train loss: 0.002, val loss: 1262.787, train acc: 1.000, val acc: 0.496
diff 9.433380090105857
epoch 26 train loss: 0.002, val loss: 1281.656, train acc: 1.000, val acc: 0.492
diff 18.869707469664263
epoch 27 train loss: 0.002, val loss: 1290.047, train acc: 1.000, val acc: 0.492
diff 8.390896169943971
epoch 28 train loss: 0.002, val loss: 1302.967, train acc: 1.000, val acc: 0.488
diff 12.920286924889979
epoch 29 train loss: 0.001, val loss: 1311.308, train acc: 1.000, val acc: 0.492
diff 8.340305331678564
epoch 30 train loss: 0.001, val loss: 1323.398, train acc: 1.000, val acc: 0.488
diff 12.090475706285815
Training model M3
epoch 1 train loss: 165.826, val loss: 367.063, train acc: 0.968, val acc: 0.604
diff inf
epoch 2 train loss: 30.393, val loss: 501.720, train acc: 0.981, val acc: 0.524
diff 134.6568652407566
epoch 3 train loss: 8.690, val loss: 611.561, train acc: 0.996, val acc: 0.532
diff 109.84124980180007
epoch 4 train loss: 1.339, val loss: 650.184, train acc: 1.000, val acc: 0.528
diff 38.62267055659572
epoch 5 train loss: 0.543, val loss: 734.569, train acc: 1.000, val acc: 0.508
diff 84.3857904904753
epoch 6 train loss: 0.303, val loss: 790.919, train acc: 1.000, val acc: 0.508
diff 56.349878565604854
epoch 7 train loss: 0.199, val loss: 813.035, train acc: 1.000, val acc: 0.504
diff 22.115685419275565
epoch 8 train loss: 0.424, val loss: 684.571, train acc: 1.000, val acc: 0.548
diff 128.4641612896969
epoch 9 train loss: 0.142, val loss: 837.142, train acc: 1.000, val acc: 0.512
diff 152.57142944702287
epoch 10 train loss: 0.089, val loss: 883.942, train acc: 1.000, val acc: 0.504
diff 46.79970434365953
epoch 11 train loss: 0.063, val loss: 924.499, train acc: 1.000, val acc: 0.496
diff 40.5567906577204
epoch 12 train loss: 0.049, val loss: 951.656, train acc: 1.000, val acc: 0.484
diff 27.157361909648444
epoch 13 train loss: 0.040, val loss: 962.070, train acc: 1.000, val acc: 0.484
diff 10.414168709841647
epoch 14 train loss: 0.033, val loss: 986.136, train acc: 1.000, val acc: 0.484
diff 24.065733879141135
epoch 15 train loss: 0.028, val loss: 1010.111, train acc: 1.000, val acc: 0.480
diff 23.974679446077857
epoch 16 train loss: 0.024, val loss: 1017.745, train acc: 1.000, val acc: 0.476
diff 7.633847028700984
epoch 17 train loss: 0.020, val loss: 1044.748, train acc: 1.000, val acc: 0.480
diff 27.003109371563255
epoch 18 train loss: 0.018, val loss: 1050.601, train acc: 1.000, val acc: 0.484
diff 5.853060404290545
epoch 19 train loss: 0.016, val loss: 1048.897, train acc: 1.000, val acc: 0.480
diff 1.703621062749562
epoch 20 train loss: 0.014, val loss: 1071.128, train acc: 1.000, val acc: 0.480
diff 22.230786265338338
epoch 21 train loss: 0.012, val loss: 1086.392, train acc: 1.000, val acc: 0.480
diff 15.26458413650721
epoch 22 train loss: 0.011, val loss: 1108.410, train acc: 1.000, val acc: 0.476
diff 22.017845787262786
epoch 23 train loss: 0.010, val loss: 1115.610, train acc: 1.000, val acc: 0.476
diff 7.20013035463171
epoch 24 train loss: 0.009, val loss: 1127.080, train acc: 1.000, val acc: 0.476
diff 11.469199442860372
epoch 25 train loss: 0.008, val loss: 1103.452, train acc: 1.000, val acc: 0.476
diff 23.628088954770874
epoch 26 train loss: 0.007, val loss: 1140.750, train acc: 1.000, val acc: 0.476
diff 37.298630123134444
epoch 27 train loss: 0.007, val loss: 1139.328, train acc: 1.000, val acc: 0.476
diff 1.4225945866453458
epoch 28 train loss: 0.006, val loss: 1151.665, train acc: 1.000, val acc: 0.480
diff 12.337860018298443
epoch 29 train loss: 0.006, val loss: 1170.794, train acc: 1.000, val acc: 0.476
diff 19.128146810187673
epoch 30 train loss: 0.005, val loss: 1170.629, train acc: 1.000, val acc: 0.476
diff 0.16448295714144479
Training model M3
epoch 1 train loss: 109.947, val loss: 437.522, train acc: 0.966, val acc: 0.576
diff inf
epoch 2 train loss: 14.508, val loss: 515.359, train acc: 0.987, val acc: 0.572
diff 77.83678205182366
epoch 3 train loss: 3.438, val loss: 578.078, train acc: 0.998, val acc: 0.560
diff 62.71897929489751
epoch 4 train loss: 0.681, val loss: 663.399, train acc: 1.000, val acc: 0.568
diff 85.32171323070622
epoch 5 train loss: 0.293, val loss: 698.782, train acc: 1.000, val acc: 0.548
diff 35.38213941968263
epoch 6 train loss: 0.182, val loss: 736.552, train acc: 1.000, val acc: 0.544
diff 37.770125302904034
epoch 7 train loss: 0.131, val loss: 768.804, train acc: 1.000, val acc: 0.544
diff 32.25218242142262
epoch 8 train loss: 0.099, val loss: 795.859, train acc: 1.000, val acc: 0.540
diff 27.054669756102612
epoch 9 train loss: 0.075, val loss: 818.344, train acc: 1.000, val acc: 0.532
diff 22.48498017113036
epoch 10 train loss: 0.064, val loss: 839.432, train acc: 1.000, val acc: 0.528
diff 21.08841222496801
epoch 11 train loss: 0.050, val loss: 858.758, train acc: 1.000, val acc: 0.528
diff 19.325915219551007
epoch 12 train loss: 0.041, val loss: 872.377, train acc: 1.000, val acc: 0.528
diff 13.618914132361738
epoch 13 train loss: 0.035, val loss: 884.195, train acc: 1.000, val acc: 0.528
diff 11.81797125172659
epoch 14 train loss: 0.030, val loss: 900.797, train acc: 1.000, val acc: 0.528
diff 16.601802377886656
epoch 15 train loss: 0.026, val loss: 914.234, train acc: 1.000, val acc: 0.528
diff 13.437651449702003
epoch 16 train loss: 0.022, val loss: 925.310, train acc: 1.000, val acc: 0.528
diff 11.075393301118766
epoch 17 train loss: 0.020, val loss: 933.772, train acc: 1.000, val acc: 0.524
diff 8.462067629714966
epoch 18 train loss: 0.018, val loss: 943.053, train acc: 1.000, val acc: 0.524
diff 9.280935520826006
epoch 19 train loss: 0.015, val loss: 957.832, train acc: 1.000, val acc: 0.524
diff 14.77930511191596
epoch 20 train loss: 0.014, val loss: 964.374, train acc: 1.000, val acc: 0.524
diff 6.542047328754393
epoch 21 train loss: 0.012, val loss: 971.542, train acc: 1.000, val acc: 0.524
diff 7.168349164585379
epoch 22 train loss: 0.011, val loss: 985.722, train acc: 1.000, val acc: 0.520
diff 14.17935431378271
epoch 23 train loss: 0.010, val loss: 992.260, train acc: 1.000, val acc: 0.524
diff 6.538532603242402
epoch 24 train loss: 0.009, val loss: 1004.073, train acc: 1.000, val acc: 0.524
diff 11.813189247039077
