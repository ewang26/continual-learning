Using CPU
Running experiment mnist:
Results are stored in: experiment_cpu/mnist
with hyperparameters {'p': 0.1, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 0, 'class_balanced': True, 'max_data_size': 500, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 821.071, val loss: 44.597, train acc: 0.849, val acc: 0.945
diff inf
epoch 2 train loss: 181.741, val loss: 67.523, train acc: 0.968, val acc: 0.915
diff 22.92568313413502
epoch 3 train loss: 87.270, val loss: 54.659, train acc: 0.982, val acc: 0.940
diff 12.863422493772198
epoch 4 train loss: 29.384, val loss: 24.121, train acc: 0.997, val acc: 0.965
diff 30.53806665805496
epoch 5 train loss: 16.249, val loss: 30.226, train acc: 0.997, val acc: 0.955
diff 6.10428861953762
epoch 6 train loss: 3.492, val loss: 31.518, train acc: 1.000, val acc: 0.960
diff 1.2922433099691304
epoch 7 train loss: 0.572, val loss: 30.886, train acc: 1.000, val acc: 0.960
diff 0.6321428986964328
epoch 8 train loss: 0.290, val loss: 31.023, train acc: 1.000, val acc: 0.960
diff 0.13734987357892692
epoch 9 train loss: 0.205, val loss: 32.133, train acc: 1.000, val acc: 0.960
diff 1.109700627127932
epoch 10 train loss: 0.153, val loss: 32.951, train acc: 1.000, val acc: 0.960
diff 0.8179017484399438
epoch 11 train loss: 0.122, val loss: 33.902, train acc: 1.000, val acc: 0.960
diff 0.9516544097840978
epoch 12 train loss: 0.099, val loss: 34.460, train acc: 1.000, val acc: 0.960
diff 0.5580517457065994
epoch 13 train loss: 0.083, val loss: 34.960, train acc: 1.000, val acc: 0.960
diff 0.4996694479239494
epoch 14 train loss: 0.069, val loss: 35.487, train acc: 1.000, val acc: 0.960
diff 0.5268342719079513
epoch 15 train loss: 0.058, val loss: 36.154, train acc: 1.000, val acc: 0.960
diff 0.6670585721714417
epoch 16 train loss: 0.050, val loss: 36.330, train acc: 1.000, val acc: 0.960
diff 0.1762460537937045
epoch 17 train loss: 0.043, val loss: 37.125, train acc: 1.000, val acc: 0.960
diff 0.794569013099462
epoch 18 train loss: 0.037, val loss: 37.239, train acc: 1.000, val acc: 0.960
diff 0.11438877289612037
epoch 19 train loss: 0.033, val loss: 38.003, train acc: 1.000, val acc: 0.960
diff 0.763662031185298
epoch 20 train loss: 0.029, val loss: 38.194, train acc: 1.000, val acc: 0.960
diff 0.1907559239909915
epoch 21 train loss: 0.025, val loss: 38.936, train acc: 1.000, val acc: 0.960
diff 0.7424030388565512
epoch 22 train loss: 0.022, val loss: 39.367, train acc: 1.000, val acc: 0.960
diff 0.4312719563726617
epoch 23 train loss: 0.019, val loss: 39.428, train acc: 1.000, val acc: 0.960
diff 0.06041286157457648
Training model M2
epoch 1 train loss: 1211.053, val loss: 83.002, train acc: 0.821, val acc: 0.892
diff inf
epoch 2 train loss: 282.802, val loss: 53.739, train acc: 0.964, val acc: 0.948
diff 29.263187214102523
epoch 3 train loss: 145.881, val loss: 89.543, train acc: 0.979, val acc: 0.900
diff 35.803971515494304
epoch 4 train loss: 55.095, val loss: 59.636, train acc: 0.992, val acc: 0.952
diff 29.906696988146564
epoch 5 train loss: 28.058, val loss: 84.889, train acc: 0.996, val acc: 0.944
diff 25.253249583299166
epoch 6 train loss: 81.533, val loss: 83.483, train acc: 0.987, val acc: 0.924
diff 1.405971154310933
epoch 7 train loss: 34.277, val loss: 84.691, train acc: 0.997, val acc: 0.932
diff 1.2078330510402253
epoch 8 train loss: 23.750, val loss: 70.980, train acc: 0.999, val acc: 0.948
diff 13.710855142478607
epoch 9 train loss: 9.869, val loss: 71.239, train acc: 0.999, val acc: 0.944
diff 0.2589955568885216
epoch 10 train loss: 0.501, val loss: 73.690, train acc: 1.000, val acc: 0.944
diff 2.451026726084109
epoch 11 train loss: 0.256, val loss: 73.865, train acc: 1.000, val acc: 0.944
diff 0.17476861586808923
epoch 12 train loss: 0.179, val loss: 75.687, train acc: 1.000, val acc: 0.944
diff 1.8217713603905992
epoch 13 train loss: 0.137, val loss: 77.238, train acc: 1.000, val acc: 0.944
diff 1.5513845956872387
epoch 14 train loss: 0.109, val loss: 78.342, train acc: 1.000, val acc: 0.944
diff 1.104001157913899
epoch 15 train loss: 0.089, val loss: 79.430, train acc: 1.000, val acc: 0.944
diff 1.0883021531048485
epoch 16 train loss: 0.073, val loss: 80.615, train acc: 1.000, val acc: 0.944
diff 1.1847408172221066
epoch 17 train loss: 0.061, val loss: 81.799, train acc: 1.000, val acc: 0.944
diff 1.1836556264889992
epoch 18 train loss: 0.052, val loss: 82.906, train acc: 1.000, val acc: 0.944
diff 1.1076183730515794
epoch 19 train loss: 0.044, val loss: 83.851, train acc: 1.000, val acc: 0.944
diff 0.9441321602239015
epoch 20 train loss: 0.038, val loss: 85.086, train acc: 1.000, val acc: 0.944
diff 1.2358047549731594
epoch 21 train loss: 0.032, val loss: 86.104, train acc: 1.000, val acc: 0.944
diff 1.0178511763357676
epoch 22 train loss: 0.028, val loss: 87.071, train acc: 1.000, val acc: 0.944
diff 0.9668567571899729
epoch 23 train loss: 0.024, val loss: 87.934, train acc: 1.000, val acc: 0.944
diff 0.8624097917494566
epoch 24 train loss: 0.021, val loss: 88.878, train acc: 1.000, val acc: 0.944
diff 0.9442852981769221
epoch 25 train loss: 0.018, val loss: 90.056, train acc: 1.000, val acc: 0.944
diff 1.178022280984095
epoch 26 train loss: 0.016, val loss: 91.022, train acc: 1.000, val acc: 0.944
diff 0.9664954449855969
epoch 27 train loss: 0.014, val loss: 91.763, train acc: 1.000, val acc: 0.944
diff 0.7401645678055502
epoch 28 train loss: 0.012, val loss: 92.787, train acc: 1.000, val acc: 0.944
diff 1.024526980766936
epoch 29 train loss: 0.011, val loss: 93.818, train acc: 1.000, val acc: 0.944
diff 1.0310914158242355
epoch 30 train loss: 0.009, val loss: 94.842, train acc: 1.000, val acc: 0.944
diff 1.0241045457956375
Training model M3
epoch 1 train loss: 629.303, val loss: 186.751, train acc: 0.708, val acc: 0.780
diff inf
epoch 2 train loss: 180.514, val loss: 183.175, train acc: 0.917, val acc: 0.784
diff 3.5756354604679927
epoch 3 train loss: 63.460, val loss: 190.615, train acc: 0.980, val acc: 0.808
diff 7.4395694201247125
epoch 4 train loss: 29.127, val loss: 169.903, train acc: 0.991, val acc: 0.848
diff 20.71144604017789
epoch 5 train loss: 4.991, val loss: 182.837, train acc: 1.000, val acc: 0.876
diff 12.933694741832653
epoch 6 train loss: 1.270, val loss: 184.355, train acc: 1.000, val acc: 0.864
diff 1.5180092240233307
epoch 7 train loss: 0.439, val loss: 192.121, train acc: 1.000, val acc: 0.868
diff 7.766408677497935
epoch 8 train loss: 0.319, val loss: 193.935, train acc: 1.000, val acc: 0.872
diff 1.8140824440444305
epoch 9 train loss: 0.239, val loss: 196.300, train acc: 1.000, val acc: 0.872
diff 2.3644986902633605
epoch 10 train loss: 0.193, val loss: 200.194, train acc: 1.000, val acc: 0.872
diff 3.8939150770203526
epoch 11 train loss: 0.155, val loss: 202.519, train acc: 1.000, val acc: 0.872
diff 2.3254867928520753
epoch 12 train loss: 0.131, val loss: 205.854, train acc: 1.000, val acc: 0.872
diff 3.334785721961282
epoch 13 train loss: 0.112, val loss: 207.055, train acc: 1.000, val acc: 0.872
diff 1.200542859178796
epoch 14 train loss: 0.095, val loss: 208.962, train acc: 1.000, val acc: 0.872
diff 1.9070863504658462
epoch 15 train loss: 0.083, val loss: 211.137, train acc: 1.000, val acc: 0.872
diff 2.1751622801557176
epoch 16 train loss: 0.073, val loss: 213.785, train acc: 1.000, val acc: 0.872
diff 2.648095652029042
epoch 17 train loss: 0.065, val loss: 213.755, train acc: 1.000, val acc: 0.872
diff 0.03032492848976176
Training model M3
epoch 1 train loss: 41.897, val loss: 197.230, train acc: 0.972, val acc: 0.832
diff inf
epoch 2 train loss: 2.541, val loss: 298.022, train acc: 0.998, val acc: 0.808
diff 100.79196404218524
epoch 3 train loss: 0.704, val loss: 239.361, train acc: 1.000, val acc: 0.820
diff 58.66031806802627
epoch 4 train loss: 0.153, val loss: 265.083, train acc: 1.000, val acc: 0.820
diff 25.721537224717082
epoch 5 train loss: 0.081, val loss: 272.671, train acc: 1.000, val acc: 0.824
diff 7.588702345518016
epoch 6 train loss: 0.057, val loss: 279.394, train acc: 1.000, val acc: 0.824
diff 6.722495857038268
epoch 7 train loss: 0.043, val loss: 285.468, train acc: 1.000, val acc: 0.828
diff 6.07383969539751
epoch 8 train loss: 0.035, val loss: 297.007, train acc: 1.000, val acc: 0.828
diff 11.539012031573634
epoch 9 train loss: 0.028, val loss: 290.171, train acc: 1.000, val acc: 0.824
diff 6.835556367203253
epoch 10 train loss: 0.023, val loss: 299.970, train acc: 1.000, val acc: 0.828
diff 9.798280142818044
epoch 11 train loss: 0.019, val loss: 307.570, train acc: 1.000, val acc: 0.820
diff 7.600791037036117
epoch 12 train loss: 0.017, val loss: 309.544, train acc: 1.000, val acc: 0.816
diff 1.9741911398754155
epoch 13 train loss: 0.014, val loss: 313.486, train acc: 1.000, val acc: 0.816
diff 3.9412357978639534
epoch 14 train loss: 0.013, val loss: 318.532, train acc: 1.000, val acc: 0.816
diff 5.046159840461087
epoch 15 train loss: 0.011, val loss: 320.483, train acc: 1.000, val acc: 0.816
diff 1.9508153589328572
epoch 16 train loss: 0.010, val loss: 326.288, train acc: 1.000, val acc: 0.820
diff 5.805269553877338
epoch 17 train loss: 0.008, val loss: 328.413, train acc: 1.000, val acc: 0.820
diff 2.1246054843895195
epoch 18 train loss: 0.007, val loss: 335.807, train acc: 1.000, val acc: 0.812
diff 7.394675096034746
epoch 19 train loss: 0.007, val loss: 333.658, train acc: 1.000, val acc: 0.820
diff 2.149187229280585
epoch 20 train loss: 0.006, val loss: 340.392, train acc: 1.000, val acc: 0.812
diff 6.733962881098421
epoch 21 train loss: 0.005, val loss: 338.603, train acc: 1.000, val acc: 0.816
diff 1.7891944547131402
epoch 22 train loss: 0.005, val loss: 343.052, train acc: 1.000, val acc: 0.816
diff 4.448943223010303
epoch 23 train loss: 0.004, val loss: 345.893, train acc: 1.000, val acc: 0.816
diff 2.840840378059795
epoch 24 train loss: 0.004, val loss: 345.371, train acc: 1.000, val acc: 0.820
diff 0.5219859523459718
epoch 25 train loss: 0.004, val loss: 349.500, train acc: 1.000, val acc: 0.812
diff 4.128999083808708
epoch 26 train loss: 0.004, val loss: 352.635, train acc: 1.000, val acc: 0.816
diff 3.1358102517354496
epoch 27 train loss: 0.003, val loss: 355.745, train acc: 1.000, val acc: 0.812
diff 3.1092932241172093
epoch 28 train loss: 0.003, val loss: 358.786, train acc: 1.000, val acc: 0.812
diff 3.041024323119643
epoch 29 train loss: 0.003, val loss: 360.843, train acc: 1.000, val acc: 0.812
diff 2.057268948496528
epoch 30 train loss: 0.003, val loss: 359.807, train acc: 1.000, val acc: 0.816
diff 1.035956869949814
Training model M3
epoch 1 train loss: 292.673, val loss: 59.650, train acc: 0.902, val acc: 0.928
diff inf
epoch 2 train loss: 39.086, val loss: 74.585, train acc: 0.983, val acc: 0.924
diff 14.934935467192034
epoch 3 train loss: 10.271, val loss: 70.650, train acc: 0.998, val acc: 0.928
diff 3.934236909938818
epoch 4 train loss: 3.386, val loss: 72.605, train acc: 1.000, val acc: 0.928
diff 1.9549681224876707
epoch 5 train loss: 0.951, val loss: 80.005, train acc: 1.000, val acc: 0.932
diff 7.399261820523122
epoch 6 train loss: 0.508, val loss: 82.858, train acc: 1.000, val acc: 0.932
diff 2.8537422191418926
epoch 7 train loss: 0.357, val loss: 85.359, train acc: 1.000, val acc: 0.928
diff 2.500665907495872
epoch 8 train loss: 0.274, val loss: 87.208, train acc: 1.000, val acc: 0.928
diff 1.8487376716692552
epoch 9 train loss: 0.215, val loss: 89.096, train acc: 1.000, val acc: 0.928
diff 1.8883652545218723
epoch 10 train loss: 0.176, val loss: 91.183, train acc: 1.000, val acc: 0.932
diff 2.0864567651173758
epoch 11 train loss: 0.148, val loss: 92.920, train acc: 1.000, val acc: 0.932
diff 1.7370473996750917
epoch 12 train loss: 0.125, val loss: 94.207, train acc: 1.000, val acc: 0.936
diff 1.287666079212812
epoch 13 train loss: 0.106, val loss: 95.246, train acc: 1.000, val acc: 0.936
diff 1.0384912752197408
epoch 14 train loss: 0.092, val loss: 96.861, train acc: 1.000, val acc: 0.932
diff 1.6147774404526274
epoch 15 train loss: 0.079, val loss: 98.529, train acc: 1.000, val acc: 0.932
diff 1.668406602048293
epoch 16 train loss: 0.071, val loss: 99.565, train acc: 1.000, val acc: 0.932
diff 1.035700348113977
epoch 17 train loss: 0.063, val loss: 100.500, train acc: 1.000, val acc: 0.932
diff 0.9349333450419692
epoch 18 train loss: 0.055, val loss: 101.322, train acc: 1.000, val acc: 0.932
diff 0.8223422084811602
epoch 19 train loss: 0.048, val loss: 101.838, train acc: 1.000, val acc: 0.932
diff 0.5156308000281911
epoch 20 train loss: 0.043, val loss: 102.839, train acc: 1.000, val acc: 0.928
diff 1.0010582903016711
epoch 21 train loss: 0.039, val loss: 103.772, train acc: 1.000, val acc: 0.928
diff 0.9330310183211168
epoch 22 train loss: 0.035, val loss: 105.174, train acc: 1.000, val acc: 0.928
diff 1.4018840169214997
epoch 23 train loss: 0.032, val loss: 105.632, train acc: 1.000, val acc: 0.928
diff 0.4588538278537726
epoch 24 train loss: 0.029, val loss: 106.145, train acc: 1.000, val acc: 0.928
diff 0.5120542637572214
epoch 25 train loss: 0.027, val loss: 106.885, train acc: 1.000, val acc: 0.924
diff 0.7405232637793233
epoch 26 train loss: 0.025, val loss: 107.476, train acc: 1.000, val acc: 0.928
diff 0.5909163839589411
epoch 27 train loss: 0.023, val loss: 108.731, train acc: 1.000, val acc: 0.924
diff 1.2546318031619563
epoch 28 train loss: 0.021, val loss: 108.676, train acc: 1.000, val acc: 0.928
diff 0.05486055312667304
