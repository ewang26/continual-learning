Using CPU
Running experiment mnist:
Results are stored in: experiment_cpu/mnist
with hyperparameters {'p': 0.05, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 0, 'class_balanced': True, 'max_data_size': 500, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 821.071, val loss: 44.597, train acc: 0.849, val acc: 0.945
diff inf
epoch 2 train loss: 181.741, val loss: 67.523, train acc: 0.968, val acc: 0.915
diff 22.92568313413502
epoch 3 train loss: 87.270, val loss: 54.659, train acc: 0.982, val acc: 0.940
diff 12.863422493772198
epoch 4 train loss: 29.384, val loss: 24.121, train acc: 0.997, val acc: 0.965
diff 30.53806665805496
epoch 5 train loss: 16.249, val loss: 30.226, train acc: 0.997, val acc: 0.955
diff 6.10428861953762
epoch 6 train loss: 3.492, val loss: 31.518, train acc: 1.000, val acc: 0.960
diff 1.2922433099691304
epoch 7 train loss: 0.572, val loss: 30.886, train acc: 1.000, val acc: 0.960
diff 0.6321428986964328
epoch 8 train loss: 0.290, val loss: 31.023, train acc: 1.000, val acc: 0.960
diff 0.13734987357892692
epoch 9 train loss: 0.205, val loss: 32.133, train acc: 1.000, val acc: 0.960
diff 1.109700627127932
epoch 10 train loss: 0.153, val loss: 32.951, train acc: 1.000, val acc: 0.960
diff 0.8179017484399438
epoch 11 train loss: 0.122, val loss: 33.902, train acc: 1.000, val acc: 0.960
diff 0.9516544097840978
epoch 12 train loss: 0.099, val loss: 34.460, train acc: 1.000, val acc: 0.960
diff 0.5580517457065994
epoch 13 train loss: 0.083, val loss: 34.960, train acc: 1.000, val acc: 0.960
diff 0.4996694479239494
epoch 14 train loss: 0.069, val loss: 35.487, train acc: 1.000, val acc: 0.960
diff 0.5268342719079513
epoch 15 train loss: 0.058, val loss: 36.154, train acc: 1.000, val acc: 0.960
diff 0.6670585721714417
epoch 16 train loss: 0.050, val loss: 36.330, train acc: 1.000, val acc: 0.960
diff 0.1762460537937045
epoch 17 train loss: 0.043, val loss: 37.125, train acc: 1.000, val acc: 0.960
diff 0.794569013099462
epoch 18 train loss: 0.037, val loss: 37.239, train acc: 1.000, val acc: 0.960
diff 0.11438877289612037
epoch 19 train loss: 0.033, val loss: 38.003, train acc: 1.000, val acc: 0.960
diff 0.763662031185298
epoch 20 train loss: 0.029, val loss: 38.194, train acc: 1.000, val acc: 0.960
diff 0.1907559239909915
epoch 21 train loss: 0.025, val loss: 38.936, train acc: 1.000, val acc: 0.960
diff 0.7424030388565512
epoch 22 train loss: 0.022, val loss: 39.367, train acc: 1.000, val acc: 0.960
diff 0.4312719563726617
epoch 23 train loss: 0.019, val loss: 39.428, train acc: 1.000, val acc: 0.960
diff 0.06041286157457648
Training model M2
epoch 1 train loss: 1211.053, val loss: 83.002, train acc: 0.821, val acc: 0.892
diff inf
epoch 2 train loss: 282.802, val loss: 53.739, train acc: 0.964, val acc: 0.948
diff 29.263187214102523
epoch 3 train loss: 145.881, val loss: 89.543, train acc: 0.979, val acc: 0.900
diff 35.803971515494304
epoch 4 train loss: 55.095, val loss: 59.636, train acc: 0.992, val acc: 0.952
diff 29.906696988146564
epoch 5 train loss: 28.058, val loss: 84.889, train acc: 0.996, val acc: 0.944
diff 25.253249583299166
epoch 6 train loss: 81.533, val loss: 83.483, train acc: 0.987, val acc: 0.924
diff 1.405971154310933
epoch 7 train loss: 34.277, val loss: 84.691, train acc: 0.997, val acc: 0.932
diff 1.2078330510402253
epoch 8 train loss: 23.750, val loss: 70.980, train acc: 0.999, val acc: 0.948
diff 13.710855142478607
epoch 9 train loss: 9.869, val loss: 71.239, train acc: 0.999, val acc: 0.944
diff 0.2589955568885216
epoch 10 train loss: 0.501, val loss: 73.690, train acc: 1.000, val acc: 0.944
diff 2.451026726084109
epoch 11 train loss: 0.256, val loss: 73.865, train acc: 1.000, val acc: 0.944
diff 0.17476861586808923
epoch 12 train loss: 0.179, val loss: 75.687, train acc: 1.000, val acc: 0.944
diff 1.8217713603905992
epoch 13 train loss: 0.137, val loss: 77.238, train acc: 1.000, val acc: 0.944
diff 1.5513845956872387
epoch 14 train loss: 0.109, val loss: 78.342, train acc: 1.000, val acc: 0.944
diff 1.104001157913899
epoch 15 train loss: 0.089, val loss: 79.430, train acc: 1.000, val acc: 0.944
diff 1.0883021531048485
epoch 16 train loss: 0.073, val loss: 80.615, train acc: 1.000, val acc: 0.944
diff 1.1847408172221066
epoch 17 train loss: 0.061, val loss: 81.799, train acc: 1.000, val acc: 0.944
diff 1.1836556264889992
epoch 18 train loss: 0.052, val loss: 82.906, train acc: 1.000, val acc: 0.944
diff 1.1076183730515794
epoch 19 train loss: 0.044, val loss: 83.851, train acc: 1.000, val acc: 0.944
diff 0.9441321602239015
epoch 20 train loss: 0.038, val loss: 85.086, train acc: 1.000, val acc: 0.944
diff 1.2358047549731594
epoch 21 train loss: 0.032, val loss: 86.104, train acc: 1.000, val acc: 0.944
diff 1.0178511763357676
epoch 22 train loss: 0.028, val loss: 87.071, train acc: 1.000, val acc: 0.944
diff 0.9668567571899729
epoch 23 train loss: 0.024, val loss: 87.934, train acc: 1.000, val acc: 0.944
diff 0.8624097917494566
epoch 24 train loss: 0.021, val loss: 88.878, train acc: 1.000, val acc: 0.944
diff 0.9442852981769221
epoch 25 train loss: 0.018, val loss: 90.056, train acc: 1.000, val acc: 0.944
diff 1.178022280984095
epoch 26 train loss: 0.016, val loss: 91.022, train acc: 1.000, val acc: 0.944
diff 0.9664954449855969
epoch 27 train loss: 0.014, val loss: 91.763, train acc: 1.000, val acc: 0.944
diff 0.7401645678055502
epoch 28 train loss: 0.012, val loss: 92.787, train acc: 1.000, val acc: 0.944
diff 1.024526980766936
epoch 29 train loss: 0.011, val loss: 93.818, train acc: 1.000, val acc: 0.944
diff 1.0310914158242355
epoch 30 train loss: 0.009, val loss: 94.842, train acc: 1.000, val acc: 0.944
diff 1.0241045457956375
Training model M3
epoch 1 train loss: 479.705, val loss: 354.421, train acc: 0.749, val acc: 0.576
diff inf
epoch 2 train loss: 161.104, val loss: 353.513, train acc: 0.910, val acc: 0.592
diff 0.9081936676220721
epoch 3 train loss: 65.413, val loss: 178.600, train acc: 0.967, val acc: 0.812
diff 174.9136990368464
epoch 4 train loss: 12.031, val loss: 250.328, train acc: 0.996, val acc: 0.772
diff 71.72830589846387
epoch 5 train loss: 3.118, val loss: 229.560, train acc: 1.000, val acc: 0.812
diff 20.76793900926745
epoch 6 train loss: 1.207, val loss: 271.665, train acc: 1.000, val acc: 0.784
diff 42.10538061182342
epoch 7 train loss: 0.564, val loss: 266.444, train acc: 1.000, val acc: 0.804
diff 5.221757266697921
epoch 8 train loss: 0.358, val loss: 282.384, train acc: 1.000, val acc: 0.792
diff 15.940372715711419
epoch 9 train loss: 0.276, val loss: 279.242, train acc: 1.000, val acc: 0.800
diff 3.1415388137167497
epoch 10 train loss: 0.226, val loss: 285.890, train acc: 1.000, val acc: 0.796
diff 6.647422179666705
epoch 11 train loss: 0.178, val loss: 291.142, train acc: 1.000, val acc: 0.800
diff 5.252239987506698
epoch 12 train loss: 0.152, val loss: 297.124, train acc: 1.000, val acc: 0.800
diff 5.9815713983556975
epoch 13 train loss: 0.127, val loss: 302.989, train acc: 1.000, val acc: 0.800
diff 5.865107400466286
epoch 14 train loss: 0.110, val loss: 304.766, train acc: 1.000, val acc: 0.800
diff 1.7771363751227796
epoch 15 train loss: 0.097, val loss: 311.565, train acc: 1.000, val acc: 0.796
diff 6.799601641750996
epoch 16 train loss: 0.086, val loss: 314.666, train acc: 1.000, val acc: 0.796
diff 3.1009783788773575
epoch 17 train loss: 0.075, val loss: 317.774, train acc: 1.000, val acc: 0.796
diff 3.1073067956662612
epoch 18 train loss: 0.067, val loss: 319.955, train acc: 1.000, val acc: 0.800
diff 2.1808968894107466
epoch 19 train loss: 0.060, val loss: 321.059, train acc: 1.000, val acc: 0.800
diff 1.1041834883779416
epoch 20 train loss: 0.054, val loss: 322.391, train acc: 1.000, val acc: 0.796
diff 1.3319141441918418
epoch 21 train loss: 0.049, val loss: 326.698, train acc: 1.000, val acc: 0.796
diff 4.306889658568707
epoch 22 train loss: 0.045, val loss: 328.855, train acc: 1.000, val acc: 0.796
diff 2.157224098336485
epoch 23 train loss: 0.041, val loss: 329.689, train acc: 1.000, val acc: 0.796
diff 0.8339302220573472
epoch 24 train loss: 0.037, val loss: 333.580, train acc: 1.000, val acc: 0.796
diff 3.8913709737884687
epoch 25 train loss: 0.034, val loss: 335.142, train acc: 1.000, val acc: 0.796
diff 1.5618318897632548
epoch 26 train loss: 0.032, val loss: 337.459, train acc: 1.000, val acc: 0.796
diff 2.3170562268256276
epoch 27 train loss: 0.029, val loss: 340.297, train acc: 1.000, val acc: 0.796
diff 2.8379140894224406
epoch 28 train loss: 0.027, val loss: 341.662, train acc: 1.000, val acc: 0.796
diff 1.3654484562920288
epoch 29 train loss: 0.025, val loss: 341.255, train acc: 1.000, val acc: 0.796
diff 0.4069966030477872
epoch 30 train loss: 0.024, val loss: 345.097, train acc: 1.000, val acc: 0.796
diff 3.842036013796985
Training model M3
epoch 1 train loss: 42.693, val loss: 274.699, train acc: 0.974, val acc: 0.808
diff inf
epoch 2 train loss: 12.396, val loss: 280.745, train acc: 0.993, val acc: 0.800
diff 6.046392617925903
epoch 3 train loss: 13.242, val loss: 266.434, train acc: 0.993, val acc: 0.820
diff 14.31180032980933
epoch 4 train loss: 3.084, val loss: 310.238, train acc: 0.998, val acc: 0.804
diff 43.803952742153
epoch 5 train loss: 0.771, val loss: 308.466, train acc: 1.000, val acc: 0.796
diff 1.771820151410168
epoch 6 train loss: 0.153, val loss: 315.159, train acc: 1.000, val acc: 0.804
diff 6.693059539814328
epoch 7 train loss: 0.094, val loss: 319.127, train acc: 1.000, val acc: 0.804
diff 3.9681693606552813
epoch 8 train loss: 0.073, val loss: 325.114, train acc: 1.000, val acc: 0.804
diff 5.9869119483176405
epoch 9 train loss: 0.059, val loss: 330.149, train acc: 1.000, val acc: 0.808
diff 5.035315561733398
epoch 10 train loss: 0.050, val loss: 335.292, train acc: 1.000, val acc: 0.808
diff 5.143154613998206
epoch 11 train loss: 0.042, val loss: 339.162, train acc: 1.000, val acc: 0.808
diff 3.8692460016195582
epoch 12 train loss: 0.036, val loss: 342.872, train acc: 1.000, val acc: 0.808
diff 3.7099099441011845
epoch 13 train loss: 0.031, val loss: 346.975, train acc: 1.000, val acc: 0.808
diff 4.102953232311847
epoch 14 train loss: 0.028, val loss: 350.842, train acc: 1.000, val acc: 0.804
diff 3.86762552792203
epoch 15 train loss: 0.025, val loss: 353.578, train acc: 1.000, val acc: 0.804
diff 2.7362558470336467
epoch 16 train loss: 0.022, val loss: 356.509, train acc: 1.000, val acc: 0.800
diff 2.930912738845734
epoch 17 train loss: 0.020, val loss: 359.722, train acc: 1.000, val acc: 0.800
diff 3.2126307241477434
epoch 18 train loss: 0.018, val loss: 363.006, train acc: 1.000, val acc: 0.800
diff 3.2843599381772606
epoch 19 train loss: 0.016, val loss: 365.546, train acc: 1.000, val acc: 0.800
diff 2.539840597348814
epoch 20 train loss: 0.015, val loss: 367.390, train acc: 1.000, val acc: 0.800
diff 1.8441688575452986
epoch 21 train loss: 0.014, val loss: 369.922, train acc: 1.000, val acc: 0.800
diff 2.5318889540531586
epoch 22 train loss: 0.013, val loss: 373.644, train acc: 1.000, val acc: 0.800
diff 3.721465414459601
epoch 23 train loss: 0.011, val loss: 377.830, train acc: 1.000, val acc: 0.800
diff 4.186573099643965
epoch 24 train loss: 0.010, val loss: 381.022, train acc: 1.000, val acc: 0.804
diff 3.1921892870497572
epoch 25 train loss: 0.009, val loss: 384.425, train acc: 1.000, val acc: 0.804
diff 3.4028100031600275
epoch 26 train loss: 0.008, val loss: 387.820, train acc: 1.000, val acc: 0.804
diff 3.3950625092727478
epoch 27 train loss: 0.008, val loss: 391.385, train acc: 1.000, val acc: 0.804
diff 3.564412090699591
epoch 28 train loss: 0.007, val loss: 396.943, train acc: 1.000, val acc: 0.804
diff 5.558192762794647
epoch 29 train loss: 0.006, val loss: 397.549, train acc: 1.000, val acc: 0.804
diff 0.6058882147199256
epoch 30 train loss: 0.006, val loss: 402.860, train acc: 1.000, val acc: 0.808
diff 5.310905541663374
Training model M3
epoch 1 train loss: 252.242, val loss: 93.219, train acc: 0.916, val acc: 0.892
diff inf
epoch 2 train loss: 55.710, val loss: 85.526, train acc: 0.980, val acc: 0.912
diff 7.692693140346705
epoch 3 train loss: 12.503, val loss: 86.939, train acc: 0.995, val acc: 0.916
diff 1.413136717129973
epoch 4 train loss: 3.269, val loss: 98.822, train acc: 1.000, val acc: 0.920
diff 11.882596484753023
epoch 5 train loss: 1.397, val loss: 102.734, train acc: 1.000, val acc: 0.928
diff 3.912555895085248
epoch 6 train loss: 0.521, val loss: 105.992, train acc: 1.000, val acc: 0.924
diff 3.2571159349945447
epoch 7 train loss: 0.354, val loss: 109.093, train acc: 1.000, val acc: 0.924
diff 3.10132441336296
epoch 8 train loss: 0.269, val loss: 112.288, train acc: 1.000, val acc: 0.920
diff 3.1948432002722313
epoch 9 train loss: 0.206, val loss: 113.589, train acc: 1.000, val acc: 0.924
diff 1.3017662134120798
epoch 10 train loss: 0.171, val loss: 115.887, train acc: 1.000, val acc: 0.924
diff 2.2974843228924016
epoch 11 train loss: 0.140, val loss: 118.421, train acc: 1.000, val acc: 0.924
diff 2.534038149072387
epoch 12 train loss: 0.118, val loss: 120.124, train acc: 1.000, val acc: 0.924
diff 1.7029210821210938
epoch 13 train loss: 0.101, val loss: 122.789, train acc: 1.000, val acc: 0.920
diff 2.664905280680955
epoch 14 train loss: 0.087, val loss: 124.155, train acc: 1.000, val acc: 0.924
diff 1.3662910908360715
epoch 15 train loss: 0.076, val loss: 125.771, train acc: 1.000, val acc: 0.920
diff 1.6154417635328286
epoch 16 train loss: 0.066, val loss: 128.028, train acc: 1.000, val acc: 0.920
diff 2.257450611625501
epoch 17 train loss: 0.058, val loss: 130.179, train acc: 1.000, val acc: 0.916
diff 2.150615070443962
epoch 18 train loss: 0.052, val loss: 131.415, train acc: 1.000, val acc: 0.916
diff 1.236762366947687
epoch 19 train loss: 0.046, val loss: 133.007, train acc: 1.000, val acc: 0.916
diff 1.5916632320902977
epoch 20 train loss: 0.042, val loss: 133.702, train acc: 1.000, val acc: 0.916
diff 0.6948236567845072
epoch 21 train loss: 0.038, val loss: 135.339, train acc: 1.000, val acc: 0.916
diff 1.6373852900203758
epoch 22 train loss: 0.034, val loss: 136.835, train acc: 1.000, val acc: 0.912
diff 1.4955237469085034
epoch 23 train loss: 0.031, val loss: 137.929, train acc: 1.000, val acc: 0.916
diff 1.0945685173903712
epoch 24 train loss: 0.028, val loss: 138.809, train acc: 1.000, val acc: 0.916
diff 0.8798061059425208
epoch 25 train loss: 0.026, val loss: 140.578, train acc: 1.000, val acc: 0.916
diff 1.7687500049029552
epoch 26 train loss: 0.024, val loss: 142.533, train acc: 1.000, val acc: 0.912
diff 1.9555390085570252
epoch 27 train loss: 0.022, val loss: 142.251, train acc: 1.000, val acc: 0.916
diff 0.28208591491204515
epoch 28 train loss: 0.020, val loss: 143.583, train acc: 1.000, val acc: 0.916
diff 1.3314534144287222
epoch 29 train loss: 0.019, val loss: 144.520, train acc: 1.000, val acc: 0.916
diff 0.9373900959889738
epoch 30 train loss: 0.017, val loss: 145.329, train acc: 1.000, val acc: 0.916
diff 0.8085458567985597
