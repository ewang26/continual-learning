Using CPU
Running experiment mnist:
Results are stored in: experiment_cpu/mnist
with hyperparameters {'p': 0.02, 'T': 5, 'learning_rate': 0.001, 'batch_size': 50, 'num_centroids': 4, 'model_training_epoch': 30, 'early_stopping_threshold': 0.1, 'random_seed': 0, 'class_balanced': True, 'max_data_size': 500, 'exp_name': 'mnist'}


task 0, classes 0, 1
task 1, classes 2, 3
task 2, classes 4, 5
task 3, classes 6, 7
task 4, classes 8, 9
Training models M1 and M2
Training model M1
epoch 1 train loss: 821.071, val loss: 44.597, train acc: 0.849, val acc: 0.945
diff inf
epoch 2 train loss: 181.741, val loss: 67.523, train acc: 0.968, val acc: 0.915
diff 22.92568313413502
epoch 3 train loss: 87.270, val loss: 54.659, train acc: 0.982, val acc: 0.940
diff 12.863422493772198
epoch 4 train loss: 29.384, val loss: 24.121, train acc: 0.997, val acc: 0.965
diff 30.53806665805496
epoch 5 train loss: 16.249, val loss: 30.226, train acc: 0.997, val acc: 0.955
diff 6.10428861953762
epoch 6 train loss: 3.492, val loss: 31.518, train acc: 1.000, val acc: 0.960
diff 1.2922433099691304
epoch 7 train loss: 0.572, val loss: 30.886, train acc: 1.000, val acc: 0.960
diff 0.6321428986964328
epoch 8 train loss: 0.290, val loss: 31.023, train acc: 1.000, val acc: 0.960
diff 0.13734987357892692
epoch 9 train loss: 0.205, val loss: 32.133, train acc: 1.000, val acc: 0.960
diff 1.109700627127932
epoch 10 train loss: 0.153, val loss: 32.951, train acc: 1.000, val acc: 0.960
diff 0.8179017484399438
epoch 11 train loss: 0.122, val loss: 33.902, train acc: 1.000, val acc: 0.960
diff 0.9516544097840978
epoch 12 train loss: 0.099, val loss: 34.460, train acc: 1.000, val acc: 0.960
diff 0.5580517457065994
epoch 13 train loss: 0.083, val loss: 34.960, train acc: 1.000, val acc: 0.960
diff 0.4996694479239494
epoch 14 train loss: 0.069, val loss: 35.487, train acc: 1.000, val acc: 0.960
diff 0.5268342719079513
epoch 15 train loss: 0.058, val loss: 36.154, train acc: 1.000, val acc: 0.960
diff 0.6670585721714417
epoch 16 train loss: 0.050, val loss: 36.330, train acc: 1.000, val acc: 0.960
diff 0.1762460537937045
epoch 17 train loss: 0.043, val loss: 37.125, train acc: 1.000, val acc: 0.960
diff 0.794569013099462
epoch 18 train loss: 0.037, val loss: 37.239, train acc: 1.000, val acc: 0.960
diff 0.11438877289612037
epoch 19 train loss: 0.033, val loss: 38.003, train acc: 1.000, val acc: 0.960
diff 0.763662031185298
epoch 20 train loss: 0.029, val loss: 38.194, train acc: 1.000, val acc: 0.960
diff 0.1907559239909915
epoch 21 train loss: 0.025, val loss: 38.936, train acc: 1.000, val acc: 0.960
diff 0.7424030388565512
epoch 22 train loss: 0.022, val loss: 39.367, train acc: 1.000, val acc: 0.960
diff 0.4312719563726617
epoch 23 train loss: 0.019, val loss: 39.428, train acc: 1.000, val acc: 0.960
diff 0.06041286157457648
Training model M2
epoch 1 train loss: 1211.053, val loss: 83.002, train acc: 0.821, val acc: 0.892
diff inf
epoch 2 train loss: 282.802, val loss: 53.739, train acc: 0.964, val acc: 0.948
diff 29.263187214102523
epoch 3 train loss: 145.881, val loss: 89.543, train acc: 0.979, val acc: 0.900
diff 35.803971515494304
epoch 4 train loss: 55.095, val loss: 59.636, train acc: 0.992, val acc: 0.952
diff 29.906696988146564
epoch 5 train loss: 28.058, val loss: 84.889, train acc: 0.996, val acc: 0.944
diff 25.253249583299166
epoch 6 train loss: 81.533, val loss: 83.483, train acc: 0.987, val acc: 0.924
diff 1.405971154310933
epoch 7 train loss: 34.277, val loss: 84.691, train acc: 0.997, val acc: 0.932
diff 1.2078330510402253
epoch 8 train loss: 23.750, val loss: 70.980, train acc: 0.999, val acc: 0.948
diff 13.710855142478607
epoch 9 train loss: 9.869, val loss: 71.239, train acc: 0.999, val acc: 0.944
diff 0.2589955568885216
epoch 10 train loss: 0.501, val loss: 73.690, train acc: 1.000, val acc: 0.944
diff 2.451026726084109
epoch 11 train loss: 0.256, val loss: 73.865, train acc: 1.000, val acc: 0.944
diff 0.17476861586808923
epoch 12 train loss: 0.179, val loss: 75.687, train acc: 1.000, val acc: 0.944
diff 1.8217713603905992
epoch 13 train loss: 0.137, val loss: 77.238, train acc: 1.000, val acc: 0.944
diff 1.5513845956872387
epoch 14 train loss: 0.109, val loss: 78.342, train acc: 1.000, val acc: 0.944
diff 1.104001157913899
epoch 15 train loss: 0.089, val loss: 79.430, train acc: 1.000, val acc: 0.944
diff 1.0883021531048485
epoch 16 train loss: 0.073, val loss: 80.615, train acc: 1.000, val acc: 0.944
diff 1.1847408172221066
epoch 17 train loss: 0.061, val loss: 81.799, train acc: 1.000, val acc: 0.944
diff 1.1836556264889992
epoch 18 train loss: 0.052, val loss: 82.906, train acc: 1.000, val acc: 0.944
diff 1.1076183730515794
epoch 19 train loss: 0.044, val loss: 83.851, train acc: 1.000, val acc: 0.944
diff 0.9441321602239015
epoch 20 train loss: 0.038, val loss: 85.086, train acc: 1.000, val acc: 0.944
diff 1.2358047549731594
epoch 21 train loss: 0.032, val loss: 86.104, train acc: 1.000, val acc: 0.944
diff 1.0178511763357676
epoch 22 train loss: 0.028, val loss: 87.071, train acc: 1.000, val acc: 0.944
diff 0.9668567571899729
epoch 23 train loss: 0.024, val loss: 87.934, train acc: 1.000, val acc: 0.944
diff 0.8624097917494566
epoch 24 train loss: 0.021, val loss: 88.878, train acc: 1.000, val acc: 0.944
diff 0.9442852981769221
epoch 25 train loss: 0.018, val loss: 90.056, train acc: 1.000, val acc: 0.944
diff 1.178022280984095
epoch 26 train loss: 0.016, val loss: 91.022, train acc: 1.000, val acc: 0.944
diff 0.9664954449855969
epoch 27 train loss: 0.014, val loss: 91.763, train acc: 1.000, val acc: 0.944
diff 0.7401645678055502
epoch 28 train loss: 0.012, val loss: 92.787, train acc: 1.000, val acc: 0.944
diff 1.024526980766936
epoch 29 train loss: 0.011, val loss: 93.818, train acc: 1.000, val acc: 0.944
diff 1.0310914158242355
epoch 30 train loss: 0.009, val loss: 94.842, train acc: 1.000, val acc: 0.944
diff 1.0241045457956375
Training model M3
epoch 1 train loss: 319.430, val loss: 646.788, train acc: 0.814, val acc: 0.300
diff inf
epoch 2 train loss: 102.901, val loss: 422.433, train acc: 0.935, val acc: 0.500
diff 224.35438386077487
epoch 3 train loss: 56.995, val loss: 563.242, train acc: 0.971, val acc: 0.492
diff 140.80840258117382
epoch 4 train loss: 18.000, val loss: 422.094, train acc: 0.992, val acc: 0.592
diff 141.14791368583303
epoch 5 train loss: 5.631, val loss: 533.422, train acc: 1.000, val acc: 0.584
diff 111.32856648861468
epoch 6 train loss: 2.240, val loss: 629.235, train acc: 1.000, val acc: 0.556
diff 95.81242339140738
epoch 7 train loss: 0.621, val loss: 669.271, train acc: 1.000, val acc: 0.548
diff 40.03668140413913
epoch 8 train loss: 0.325, val loss: 665.629, train acc: 1.000, val acc: 0.560
diff 3.642779068817049
epoch 9 train loss: 0.240, val loss: 675.018, train acc: 1.000, val acc: 0.556
diff 9.389849731765594
epoch 10 train loss: 0.180, val loss: 696.341, train acc: 1.000, val acc: 0.556
diff 21.322991536345057
epoch 11 train loss: 0.151, val loss: 706.287, train acc: 1.000, val acc: 0.556
diff 9.945768839088487
epoch 12 train loss: 0.132, val loss: 714.577, train acc: 1.000, val acc: 0.564
diff 8.289789035184867
epoch 13 train loss: 0.103, val loss: 731.614, train acc: 1.000, val acc: 0.556
diff 17.036945152755948
epoch 14 train loss: 0.088, val loss: 733.805, train acc: 1.000, val acc: 0.572
diff 2.1911949636712507
epoch 15 train loss: 0.077, val loss: 734.732, train acc: 1.000, val acc: 0.572
diff 0.9265052039855846
epoch 16 train loss: 0.067, val loss: 752.415, train acc: 1.000, val acc: 0.568
diff 17.68333454818128
epoch 17 train loss: 0.059, val loss: 758.130, train acc: 1.000, val acc: 0.572
diff 5.715027423844958
epoch 18 train loss: 0.053, val loss: 759.520, train acc: 1.000, val acc: 0.572
diff 1.3900204414520658
epoch 19 train loss: 0.047, val loss: 772.894, train acc: 1.000, val acc: 0.572
diff 13.374004177717438
epoch 20 train loss: 0.042, val loss: 776.611, train acc: 1.000, val acc: 0.572
diff 3.716880347426354
epoch 21 train loss: 0.038, val loss: 777.828, train acc: 1.000, val acc: 0.572
diff 1.2175687388474898
epoch 22 train loss: 0.035, val loss: 786.452, train acc: 1.000, val acc: 0.572
diff 8.62317146264786
epoch 23 train loss: 0.032, val loss: 791.746, train acc: 1.000, val acc: 0.572
diff 5.294519691277856
epoch 24 train loss: 0.029, val loss: 796.976, train acc: 1.000, val acc: 0.572
diff 5.229749779480358
epoch 25 train loss: 0.027, val loss: 801.065, train acc: 1.000, val acc: 0.572
diff 4.089132752624778
epoch 26 train loss: 0.025, val loss: 808.676, train acc: 1.000, val acc: 0.572
diff 7.610918356140473
epoch 27 train loss: 0.023, val loss: 813.752, train acc: 1.000, val acc: 0.572
diff 5.075859290162384
epoch 28 train loss: 0.021, val loss: 815.934, train acc: 1.000, val acc: 0.572
diff 2.181880210869167
epoch 29 train loss: 0.020, val loss: 818.432, train acc: 1.000, val acc: 0.572
diff 2.498593694824649
epoch 30 train loss: 0.018, val loss: 823.969, train acc: 1.000, val acc: 0.572
diff 5.536755550945031
Training model M3
epoch 1 train loss: 63.434, val loss: 386.781, train acc: 0.973, val acc: 0.648
diff inf
epoch 2 train loss: 6.167, val loss: 417.418, train acc: 0.996, val acc: 0.664
diff 30.637696871322646
epoch 3 train loss: 4.405, val loss: 492.590, train acc: 0.996, val acc: 0.656
diff 75.17136529117948
epoch 4 train loss: 0.417, val loss: 463.238, train acc: 1.000, val acc: 0.680
diff 29.35182639533616
epoch 5 train loss: 0.158, val loss: 470.861, train acc: 1.000, val acc: 0.684
diff 7.623079010262927
epoch 6 train loss: 0.097, val loss: 484.168, train acc: 1.000, val acc: 0.688
diff 13.30718967660664
epoch 7 train loss: 0.075, val loss: 497.835, train acc: 1.000, val acc: 0.688
diff 13.666997477935183
epoch 8 train loss: 0.060, val loss: 512.906, train acc: 1.000, val acc: 0.684
diff 15.070594127249592
epoch 9 train loss: 0.048, val loss: 513.075, train acc: 1.000, val acc: 0.684
diff 0.1694417816047462
epoch 10 train loss: 0.041, val loss: 522.990, train acc: 1.000, val acc: 0.684
diff 9.915061938778763
epoch 11 train loss: 0.035, val loss: 528.272, train acc: 1.000, val acc: 0.684
diff 5.281558924464321
epoch 12 train loss: 0.030, val loss: 536.590, train acc: 1.000, val acc: 0.684
diff 8.318360947404017
epoch 13 train loss: 0.026, val loss: 543.322, train acc: 1.000, val acc: 0.684
diff 6.7322010461844
epoch 14 train loss: 0.023, val loss: 548.033, train acc: 1.000, val acc: 0.684
diff 4.710996729237536
epoch 15 train loss: 0.020, val loss: 553.640, train acc: 1.000, val acc: 0.684
diff 5.606947551615235
epoch 16 train loss: 0.018, val loss: 560.395, train acc: 1.000, val acc: 0.684
diff 6.754553357750638
epoch 17 train loss: 0.016, val loss: 561.226, train acc: 1.000, val acc: 0.684
diff 0.8315890399917407
epoch 18 train loss: 0.015, val loss: 574.379, train acc: 1.000, val acc: 0.680
diff 13.152452635369627
epoch 19 train loss: 0.013, val loss: 567.916, train acc: 1.000, val acc: 0.684
diff 6.462694903413649
epoch 20 train loss: 0.012, val loss: 575.542, train acc: 1.000, val acc: 0.684
diff 7.626030648366395
epoch 21 train loss: 0.011, val loss: 577.315, train acc: 1.000, val acc: 0.684
diff 1.7724610588688847
epoch 22 train loss: 0.010, val loss: 584.736, train acc: 1.000, val acc: 0.684
diff 7.421286287233329
epoch 23 train loss: 0.009, val loss: 585.607, train acc: 1.000, val acc: 0.684
diff 0.871113428413878
epoch 24 train loss: 0.008, val loss: 588.702, train acc: 1.000, val acc: 0.684
diff 3.094805971260712
epoch 25 train loss: 0.008, val loss: 595.747, train acc: 1.000, val acc: 0.680
diff 7.045358020413573
epoch 26 train loss: 0.007, val loss: 597.841, train acc: 1.000, val acc: 0.680
diff 2.0939239269553127
epoch 27 train loss: 0.007, val loss: 598.276, train acc: 1.000, val acc: 0.680
diff 0.4343373683466325
epoch 28 train loss: 0.006, val loss: 604.601, train acc: 1.000, val acc: 0.680
diff 6.325937447710771
epoch 29 train loss: 0.006, val loss: 606.801, train acc: 1.000, val acc: 0.680
diff 2.1996704725602285
epoch 30 train loss: 0.005, val loss: 606.001, train acc: 1.000, val acc: 0.680
diff 0.8004187347856941
Training model M3
epoch 1 train loss: 173.583, val loss: 193.193, train acc: 0.943, val acc: 0.760
diff inf
epoch 2 train loss: 38.860, val loss: 204.366, train acc: 0.984, val acc: 0.784
diff 11.173267801730418
epoch 3 train loss: 14.387, val loss: 225.120, train acc: 0.994, val acc: 0.800
diff 20.754225696094153
epoch 4 train loss: 3.788, val loss: 294.579, train acc: 0.996, val acc: 0.732
diff 69.45839526117757
epoch 5 train loss: 0.625, val loss: 308.077, train acc: 1.000, val acc: 0.732
diff 13.497724202053917
epoch 6 train loss: 0.329, val loss: 312.926, train acc: 1.000, val acc: 0.744
diff 4.849061108695594
epoch 7 train loss: 0.225, val loss: 323.142, train acc: 1.000, val acc: 0.736
diff 10.21619518759752
epoch 8 train loss: 0.163, val loss: 334.620, train acc: 1.000, val acc: 0.736
diff 11.478022313184795
epoch 9 train loss: 0.127, val loss: 343.200, train acc: 1.000, val acc: 0.724
diff 8.580011139465284
epoch 10 train loss: 0.101, val loss: 346.102, train acc: 1.000, val acc: 0.732
diff 2.9017845999040333
epoch 11 train loss: 0.083, val loss: 355.953, train acc: 1.000, val acc: 0.728
diff 9.851633368353191
epoch 12 train loss: 0.071, val loss: 362.777, train acc: 1.000, val acc: 0.724
diff 6.8233008916844256
epoch 13 train loss: 0.061, val loss: 367.424, train acc: 1.000, val acc: 0.728
diff 4.647317982804509
epoch 14 train loss: 0.052, val loss: 371.209, train acc: 1.000, val acc: 0.720
diff 3.7847449978730765
epoch 15 train loss: 0.045, val loss: 377.909, train acc: 1.000, val acc: 0.720
diff 6.700383014431168
epoch 16 train loss: 0.040, val loss: 382.673, train acc: 1.000, val acc: 0.720
diff 4.763849503967322
epoch 17 train loss: 0.035, val loss: 386.442, train acc: 1.000, val acc: 0.720
diff 3.7692520565917675
epoch 18 train loss: 0.032, val loss: 391.429, train acc: 1.000, val acc: 0.716
diff 4.986894894784257
epoch 19 train loss: 0.029, val loss: 394.034, train acc: 1.000, val acc: 0.716
diff 2.605055305367557
epoch 20 train loss: 0.026, val loss: 399.638, train acc: 1.000, val acc: 0.716
diff 5.604384642969933
epoch 21 train loss: 0.023, val loss: 400.555, train acc: 1.000, val acc: 0.712
diff 0.9161245100175393
epoch 22 train loss: 0.021, val loss: 407.945, train acc: 1.000, val acc: 0.712
diff 7.390402275813813
epoch 23 train loss: 0.020, val loss: 411.816, train acc: 1.000, val acc: 0.712
diff 3.8713401631122792
epoch 24 train loss: 0.018, val loss: 416.712, train acc: 1.000, val acc: 0.712
diff 4.896065943493625
epoch 25 train loss: 0.016, val loss: 421.956, train acc: 1.000, val acc: 0.712
diff 5.243142556832595
epoch 26 train loss: 0.015, val loss: 423.906, train acc: 1.000, val acc: 0.712
diff 1.9506535048075193
epoch 27 train loss: 0.014, val loss: 426.353, train acc: 1.000, val acc: 0.708
diff 2.4470861655034923
epoch 28 train loss: 0.013, val loss: 430.521, train acc: 1.000, val acc: 0.708
diff 4.16779087320657
epoch 29 train loss: 0.012, val loss: 434.260, train acc: 1.000, val acc: 0.708
diff 3.7386618535996377
epoch 30 train loss: 0.011, val loss: 438.963, train acc: 1.000, val acc: 0.708
diff 4.703714148124504
